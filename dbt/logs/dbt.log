[0m12:58:20.914260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB64AD1F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB66D44B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB66D44910>]}


============================== 12:58:20.922858 | d91a21ac-01db-499c-a467-b350c81b1dc2 ==============================
[0m12:58:20.922858 [info ] [MainThread]: Running with dbt=1.10.9
[0m12:58:20.925502 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt deps --project-dir dbt', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'empty': 'None', 'log_path': 'dbt\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\likhi\\.dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m12:58:21.485506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd91a21ac-01db-499c-a467-b350c81b1dc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB66D44C10>]}
[0m12:58:21.590798 [debug] [MainThread]: Set downloads directory='C:\Users\likhi\AppData\Local\Temp\dbt-downloads-h6_j3zad'
[0m12:58:21.593819 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m12:58:22.047562 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m12:58:22.050328 [error] [MainThread]: Encountered an error:
Package dbt-labs/dbt_expectations was not found in the package index
[0m12:58:22.054485 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\.venv\lib\site-packages\dbt\cli\requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\.venv\lib\site-packages\dbt\cli\requires.py", line 128, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\.venv\lib\site-packages\dbt\cli\requires.py", line 254, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\.venv\lib\site-packages\dbt\cli\requires.py", line 303, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\.venv\lib\site-packages\dbt\cli\main.py", line 461, in deps
    results = task.run()
  File "C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\.venv\lib\site-packages\dbt\task\deps.py", line 215, in run
    self.lock()
  File "C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\.venv\lib\site-packages\dbt\task\deps.py", line 187, in lock
    resolved_deps = resolve_packages(packages, self.project, self.cli_vars)
  File "C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\.venv\lib\site-packages\dbt\deps\resolver.py", line 131, in resolve_packages
    target = final[package].resolved().fetch_metadata(project, renderer)
  File "C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\.venv\lib\site-packages\dbt\deps\registry.py", line 98, in resolved
    self._check_in_index()
  File "C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\.venv\lib\site-packages\dbt\deps\registry.py", line 77, in _check_in_index
    raise PackageNotFoundError(self.package)
dbt.exceptions.PackageNotFoundError: Package dbt-labs/dbt_expectations was not found in the package index

[0m12:58:22.056486 [debug] [MainThread]: Command `dbt deps` failed at 12:58:22.056486 after 1.47 seconds
[0m12:58:22.058500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB64AD1F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB66F2CEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB66F2D240>]}
[0m12:58:22.058500 [debug] [MainThread]: Flushing usage events
[0m12:58:22.426404 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:01:20.005696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C0EA56050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C10CC4C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C10CC4A30>]}


============================== 13:01:20.014366 | 9c6201d2-bc49-4095-af9d-d54ecb9885c1 ==============================
[0m13:01:20.014366 [info ] [MainThread]: Running with dbt=1.10.9
[0m13:01:20.015310 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\likhi\\.dbt', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt deps --project-dir dbt', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'dbt\\logs', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m13:01:20.238244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c6201d2-bc49-4095-af9d-d54ecb9885c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C10C8FDF0>]}
[0m13:01:20.305893 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:01:20.309271 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:01:20.311184 [debug] [MainThread]: Command `dbt deps` succeeded at 13:01:20.311184 after 0.46 seconds
[0m13:01:20.312698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C0EA56050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C10C8FDF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C10E1C700>]}
[0m13:01:20.313710 [debug] [MainThread]: Flushing usage events
[0m13:01:21.065478 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:03:28.431347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D574186020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5763F4B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5763F49A0>]}


============================== 13:03:28.441293 | 33a5248c-fb22-401a-b552-f300a40b9986 ==============================
[0m13:03:28.441293 [info ] [MainThread]: Running with dbt=1.10.9
[0m13:03:28.442880 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt deps --project-dir dbt', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'None', 'log_cache_events': 'False', 'log_path': 'dbt\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\likhi\\Downloads\\pipeline-guardian-v2-upload\\dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m13:03:28.679277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33a5248c-fb22-401a-b552-f300a40b9986', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5764EAFE0>]}
[0m13:03:28.727642 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:03:28.731298 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:03:28.734832 [debug] [MainThread]: Command `dbt deps` succeeded at 13:03:28.733821 after 0.46 seconds
[0m13:03:28.735844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D574186020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5764EAFE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5764EA2C0>]}
[0m13:03:28.736843 [debug] [MainThread]: Flushing usage events
[0m13:03:29.149948 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:03:33.155773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027002A06020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027004C78C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027004C789D0>]}


============================== 13:03:33.163280 | 76549d9c-b95f-45e9-9c4c-5341efe3780a ==============================
[0m13:03:33.163280 [info ] [MainThread]: Running with dbt=1.10.9
[0m13:03:33.165308 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt seed --project-dir dbt --full-refresh', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'empty': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'dbt\\logs', 'profiles_dir': 'C:\\Users\\likhi\\Downloads\\pipeline-guardian-v2-upload\\dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m13:03:33.523902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76549d9c-b95f-45e9-9c4c-5341efe3780a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027004D7C640>]}
[0m13:03:33.617346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '76549d9c-b95f-45e9-9c4c-5341efe3780a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002700444AD70>]}
[0m13:03:33.621706 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m13:03:34.140862 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m13:03:34.142865 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:03:34.145013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '76549d9c-b95f-45e9-9c4c-5341efe3780a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027004ED2410>]}
[0m13:03:39.029478 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_range`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m13:03:39.031585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '76549d9c-b95f-45e9-9c4c-5341efe3780a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027006654FA0>]}
[0m13:03:39.448972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76549d9c-b95f-45e9-9c4c-5341efe3780a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270064C40D0>]}
[0m13:03:39.619194 [debug] [MainThread]: Wrote artifact WritableManifest to dbt\target\manifest.json
[0m13:03:39.665481 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt\target\semantic_manifest.json
[0m13:03:39.726379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76549d9c-b95f-45e9-9c4c-5341efe3780a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270064ECCD0>]}
[0m13:03:39.727378 [info ] [MainThread]: Found 2 models, 1 seed, 4 data tests, 1 source, 429 macros
[0m13:03:39.729378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76549d9c-b95f-45e9-9c4c-5341efe3780a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027006500040>]}
[0m13:03:39.732997 [info ] [MainThread]: 
[0m13:03:39.734011 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:03:39.736010 [info ] [MainThread]: 
[0m13:03:39.738022 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:03:39.741223 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_demo'
[0m13:03:47.320196 [debug] [ThreadPool]: Using duckdb connection "list_demo"
[0m13:03:47.321200 [debug] [ThreadPool]: On list_demo: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "connection_name": "list_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"demo"'
    
  
  
[0m13:03:47.322713 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:03:47.403798 [debug] [ThreadPool]: SQL status: OK in 0.081 seconds
[0m13:03:47.405809 [debug] [ThreadPool]: On list_demo: Close
[0m13:03:47.408807 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_demo, now create_demo_main)
[0m13:03:47.409807 [debug] [ThreadPool]: Creating schema "database: "demo"
schema: "main"
"
[0m13:03:47.419334 [debug] [ThreadPool]: Using duckdb connection "create_demo_main"
[0m13:03:47.420335 [debug] [ThreadPool]: On create_demo_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "connection_name": "create_demo_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='demo'
        and type='sqlite'
    
  
[0m13:03:47.421338 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:03:47.422851 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m13:03:47.425863 [debug] [ThreadPool]: Using duckdb connection "create_demo_main"
[0m13:03:47.425863 [debug] [ThreadPool]: On create_demo_main: BEGIN
[0m13:03:47.427861 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:03:47.427861 [debug] [ThreadPool]: Using duckdb connection "create_demo_main"
[0m13:03:47.428870 [debug] [ThreadPool]: On create_demo_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "connection_name": "create_demo_main"} */

    
    
        create schema if not exists "demo"."main"
    
[0m13:03:47.429861 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:03:47.431863 [debug] [ThreadPool]: On create_demo_main: COMMIT
[0m13:03:47.431863 [debug] [ThreadPool]: Using duckdb connection "create_demo_main"
[0m13:03:47.433371 [debug] [ThreadPool]: On create_demo_main: COMMIT
[0m13:03:47.434380 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:03:47.435389 [debug] [ThreadPool]: On create_demo_main: Close
[0m13:03:47.444837 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_demo_main'
[0m13:03:47.452352 [debug] [ThreadPool]: Using duckdb connection "list_demo_main"
[0m13:03:47.452860 [debug] [ThreadPool]: On list_demo_main: BEGIN
[0m13:03:47.453870 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:03:47.454870 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:03:47.455871 [debug] [ThreadPool]: Using duckdb connection "list_demo_main"
[0m13:03:47.456869 [debug] [ThreadPool]: On list_demo_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "connection_name": "list_demo_main"} */
select
      'demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'demo'
  
[0m13:03:47.471393 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m13:03:47.474991 [debug] [ThreadPool]: On list_demo_main: ROLLBACK
[0m13:03:47.476011 [debug] [ThreadPool]: Failed to rollback 'list_demo_main'
[0m13:03:47.477017 [debug] [ThreadPool]: On list_demo_main: Close
[0m13:03:47.478017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76549d9c-b95f-45e9-9c4c-5341efe3780a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270064ED840>]}
[0m13:03:47.478915 [debug] [MainThread]: Using duckdb connection "master"
[0m13:03:47.479916 [debug] [MainThread]: On master: BEGIN
[0m13:03:47.480915 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:03:47.481921 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:03:47.482916 [debug] [MainThread]: On master: COMMIT
[0m13:03:47.483425 [debug] [MainThread]: Using duckdb connection "master"
[0m13:03:47.485448 [debug] [MainThread]: On master: COMMIT
[0m13:03:47.487447 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:03:47.488447 [debug] [MainThread]: On master: Close
[0m13:03:47.503040 [debug] [Thread-1 (]: Began running node seed.pipeline_guardian.orders
[0m13:03:47.505066 [info ] [Thread-1 (]: 1 of 1 START seed file main.orders ............................................. [RUN]
[0m13:03:47.506102 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.pipeline_guardian.orders'
[0m13:03:47.507179 [debug] [Thread-1 (]: Began compiling node seed.pipeline_guardian.orders
[0m13:03:47.507179 [debug] [Thread-1 (]: Began executing node seed.pipeline_guardian.orders
[0m13:03:47.547797 [debug] [Thread-1 (]: Using duckdb connection "seed.pipeline_guardian.orders"
[0m13:03:47.548756 [debug] [Thread-1 (]: On seed.pipeline_guardian.orders: BEGIN
[0m13:03:47.550065 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:03:47.551807 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:03:47.552868 [debug] [Thread-1 (]: Using duckdb connection "seed.pipeline_guardian.orders"
[0m13:03:47.552868 [debug] [Thread-1 (]: On seed.pipeline_guardian.orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "seed.pipeline_guardian.orders"} */

    create table "demo"."main"."orders" ("order_id" integer,"customer_id" text,"amount" float8,"order_date" date)
  
[0m13:03:47.555534 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:03:47.569845 [debug] [Thread-1 (]: Using duckdb connection "seed.pipeline_guardian.orders"
[0m13:03:47.571249 [debug] [Thread-1 (]: On seed.pipeline_guardian.orders: 
          COPY "demo"."main"."orders" FROM 'dbt\seeds\orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m13:03:47.581159 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m13:03:47.592984 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.pipeline_guardian.orders"
[0m13:03:47.617375 [debug] [Thread-1 (]: On seed.pipeline_guardian.orders: COMMIT
[0m13:03:47.618436 [debug] [Thread-1 (]: Using duckdb connection "seed.pipeline_guardian.orders"
[0m13:03:47.619436 [debug] [Thread-1 (]: On seed.pipeline_guardian.orders: COMMIT
[0m13:03:47.623984 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:03:47.628087 [debug] [Thread-1 (]: On seed.pipeline_guardian.orders: Close
[0m13:03:47.631986 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76549d9c-b95f-45e9-9c4c-5341efe3780a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270027D2FB0>]}
[0m13:03:47.633497 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file main.orders ......................................... [[32mCREATE 12[0m in 0.12s]
[0m13:03:47.635508 [debug] [Thread-1 (]: Finished running node seed.pipeline_guardian.orders
[0m13:03:47.639507 [debug] [MainThread]: Using duckdb connection "master"
[0m13:03:47.641510 [debug] [MainThread]: On master: BEGIN
[0m13:03:47.641510 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:03:47.644046 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:03:47.645057 [debug] [MainThread]: On master: COMMIT
[0m13:03:47.646055 [debug] [MainThread]: Using duckdb connection "master"
[0m13:03:47.647055 [debug] [MainThread]: On master: COMMIT
[0m13:03:47.648058 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:03:47.648058 [debug] [MainThread]: On master: Close
[0m13:03:47.649055 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:03:47.651055 [debug] [MainThread]: Connection 'create_demo_main' was properly closed.
[0m13:03:47.652061 [debug] [MainThread]: Connection 'list_demo_main' was properly closed.
[0m13:03:47.653229 [debug] [MainThread]: Connection 'seed.pipeline_guardian.orders' was properly closed.
[0m13:03:47.653761 [info ] [MainThread]: 
[0m13:03:47.654777 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 7.92 seconds (7.92s).
[0m13:03:47.656775 [debug] [MainThread]: Command end result
[0m13:03:47.691587 [debug] [MainThread]: Wrote artifact WritableManifest to dbt\target\manifest.json
[0m13:03:47.695226 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt\target\semantic_manifest.json
[0m13:03:47.707586 [debug] [MainThread]: Wrote artifact RunExecutionResult to dbt\target\run_results.json
[0m13:03:47.708700 [info ] [MainThread]: 
[0m13:03:47.709702 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:03:47.710826 [info ] [MainThread]: 
[0m13:03:47.711869 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:03:47.712895 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:03:47.716066 [debug] [MainThread]: Command `dbt seed` succeeded at 13:03:47.715026 after 14.72 seconds
[0m13:03:47.716066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027002A06020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270063A5ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002700533D240>]}
[0m13:03:47.717025 [debug] [MainThread]: Flushing usage events
[0m13:03:48.677084 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:03:53.301661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228F3BC9F60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228F5E2CC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228F5E2C9A0>]}


============================== 13:03:53.312244 | 6601b5fe-6871-4041-af73-fec0acf2744a ==============================
[0m13:03:53.312244 [info ] [MainThread]: Running with dbt=1.10.9
[0m13:03:53.313438 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run --project-dir dbt', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'dbt\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'C:\\Users\\likhi\\Downloads\\pipeline-guardian-v2-upload\\dbt'}
[0m13:03:53.666352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6601b5fe-6871-4041-af73-fec0acf2744a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228F5F3ECB0>]}
[0m13:03:53.753520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6601b5fe-6871-4041-af73-fec0acf2744a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228F5D823B0>]}
[0m13:03:53.758520 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m13:03:54.190678 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m13:03:54.592958 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:03:54.594590 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:03:54.705206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6601b5fe-6871-4041-af73-fec0acf2744a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228F7480310>]}
[0m13:03:54.908028 [debug] [MainThread]: Wrote artifact WritableManifest to dbt\target\manifest.json
[0m13:03:54.913561 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt\target\semantic_manifest.json
[0m13:03:54.980033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6601b5fe-6871-4041-af73-fec0acf2744a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228F7482C50>]}
[0m13:03:54.981023 [info ] [MainThread]: Found 2 models, 1 seed, 4 data tests, 1 source, 429 macros
[0m13:03:54.982547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6601b5fe-6871-4041-af73-fec0acf2744a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228F74813F0>]}
[0m13:03:54.986673 [info ] [MainThread]: 
[0m13:03:54.988562 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:03:54.990571 [info ] [MainThread]: 
[0m13:03:54.992560 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:03:55.005745 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_demo'
[0m13:03:55.215990 [debug] [ThreadPool]: Using duckdb connection "list_demo"
[0m13:03:55.216996 [debug] [ThreadPool]: On list_demo: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "connection_name": "list_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"demo"'
    
  
  
[0m13:03:55.218010 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:03:55.264419 [debug] [ThreadPool]: SQL status: OK in 0.047 seconds
[0m13:03:55.266413 [debug] [ThreadPool]: On list_demo: Close
[0m13:03:55.268423 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_demo, now create_demo_main)
[0m13:03:55.270432 [debug] [ThreadPool]: Creating schema "database: "demo"
schema: "main"
"
[0m13:03:55.279162 [debug] [ThreadPool]: Using duckdb connection "create_demo_main"
[0m13:03:55.280158 [debug] [ThreadPool]: On create_demo_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "connection_name": "create_demo_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='demo'
        and type='sqlite'
    
  
[0m13:03:55.281159 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:03:55.282774 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m13:03:55.285899 [debug] [ThreadPool]: Using duckdb connection "create_demo_main"
[0m13:03:55.286908 [debug] [ThreadPool]: On create_demo_main: BEGIN
[0m13:03:55.287893 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:03:55.287893 [debug] [ThreadPool]: Using duckdb connection "create_demo_main"
[0m13:03:55.289895 [debug] [ThreadPool]: On create_demo_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "connection_name": "create_demo_main"} */

    
    
        create schema if not exists "demo"."main"
    
[0m13:03:55.290895 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:03:55.291897 [debug] [ThreadPool]: On create_demo_main: COMMIT
[0m13:03:55.292892 [debug] [ThreadPool]: Using duckdb connection "create_demo_main"
[0m13:03:55.293508 [debug] [ThreadPool]: On create_demo_main: COMMIT
[0m13:03:55.294632 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:03:55.295629 [debug] [ThreadPool]: On create_demo_main: Close
[0m13:03:55.297622 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_demo_main'
[0m13:03:55.306357 [debug] [ThreadPool]: Using duckdb connection "list_demo_main"
[0m13:03:55.307367 [debug] [ThreadPool]: On list_demo_main: BEGIN
[0m13:03:55.308356 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:03:55.309364 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:03:55.310356 [debug] [ThreadPool]: Using duckdb connection "list_demo_main"
[0m13:03:55.311358 [debug] [ThreadPool]: On list_demo_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "connection_name": "list_demo_main"} */
select
      'demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'demo'
  
[0m13:03:55.327499 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m13:03:55.329560 [debug] [ThreadPool]: On list_demo_main: ROLLBACK
[0m13:03:55.331609 [debug] [ThreadPool]: Failed to rollback 'list_demo_main'
[0m13:03:55.332503 [debug] [ThreadPool]: On list_demo_main: Close
[0m13:03:55.335039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6601b5fe-6871-4041-af73-fec0acf2744a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228F5F65A80>]}
[0m13:03:55.336033 [debug] [MainThread]: Using duckdb connection "master"
[0m13:03:55.336033 [debug] [MainThread]: On master: BEGIN
[0m13:03:55.337136 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:03:55.338030 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:03:55.339125 [debug] [MainThread]: On master: COMMIT
[0m13:03:55.340030 [debug] [MainThread]: Using duckdb connection "master"
[0m13:03:55.340030 [debug] [MainThread]: On master: COMMIT
[0m13:03:55.342029 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:03:55.342029 [debug] [MainThread]: On master: Close
[0m13:03:55.349726 [debug] [Thread-1 (]: Began running node model.pipeline_guardian.stg_orders
[0m13:03:55.350648 [info ] [Thread-1 (]: 1 of 2 START sql table model main.stg_orders ................................... [RUN]
[0m13:03:55.351645 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.pipeline_guardian.stg_orders'
[0m13:03:55.353309 [debug] [Thread-1 (]: Began compiling node model.pipeline_guardian.stg_orders
[0m13:03:55.363030 [debug] [Thread-1 (]: Writing injected SQL for node "model.pipeline_guardian.stg_orders"
[0m13:03:55.366046 [debug] [Thread-1 (]: Began executing node model.pipeline_guardian.stg_orders
[0m13:03:55.422781 [debug] [Thread-1 (]: Writing runtime sql for node "model.pipeline_guardian.stg_orders"
[0m13:03:55.424797 [debug] [Thread-1 (]: Using duckdb connection "model.pipeline_guardian.stg_orders"
[0m13:03:55.425798 [debug] [Thread-1 (]: On model.pipeline_guardian.stg_orders: BEGIN
[0m13:03:55.426799 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:03:55.427799 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:03:55.428799 [debug] [Thread-1 (]: Using duckdb connection "model.pipeline_guardian.stg_orders"
[0m13:03:55.428799 [debug] [Thread-1 (]: On model.pipeline_guardian.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "model.pipeline_guardian.stg_orders"} */

  
    
    

    create  table
      "demo"."main"."stg_orders__dbt_tmp"
  
    as (
      with source as (
    select * from "demo"."main"."orders"
),

-- PATCH_AREA_START
-- naive logic (will fail tests)
patched as (
    select
        order_id,
        customer_id,
        cast(amount as double) as amount,
        cast(order_date as date) as order_date
    from source
)
-- PATCH_AREA_END

select * from patched
    );
  
  
[0m13:03:55.431845 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:03:55.440424 [debug] [Thread-1 (]: Using duckdb connection "model.pipeline_guardian.stg_orders"
[0m13:03:55.441424 [debug] [Thread-1 (]: On model.pipeline_guardian.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "model.pipeline_guardian.stg_orders"} */
alter table "demo"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m13:03:55.441424 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:03:55.458466 [debug] [Thread-1 (]: On model.pipeline_guardian.stg_orders: COMMIT
[0m13:03:55.459469 [debug] [Thread-1 (]: Using duckdb connection "model.pipeline_guardian.stg_orders"
[0m13:03:55.460469 [debug] [Thread-1 (]: On model.pipeline_guardian.stg_orders: COMMIT
[0m13:03:55.505926 [debug] [Thread-1 (]: SQL status: OK in 0.044 seconds
[0m13:03:55.520135 [debug] [Thread-1 (]: Using duckdb connection "model.pipeline_guardian.stg_orders"
[0m13:03:55.521134 [debug] [Thread-1 (]: On model.pipeline_guardian.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "model.pipeline_guardian.stg_orders"} */

      drop table if exists "demo"."main"."stg_orders__dbt_backup" cascade
    
[0m13:03:55.524662 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:03:55.530778 [debug] [Thread-1 (]: On model.pipeline_guardian.stg_orders: Close
[0m13:03:55.536427 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6601b5fe-6871-4041-af73-fec0acf2744a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228F34B5CF0>]}
[0m13:03:55.538429 [info ] [Thread-1 (]: 1 of 2 OK created sql table model main.stg_orders .............................. [[32mOK[0m in 0.18s]
[0m13:03:55.541432 [debug] [Thread-1 (]: Finished running node model.pipeline_guardian.stg_orders
[0m13:03:55.543991 [debug] [Thread-3 (]: Began running node model.pipeline_guardian.orders_summary
[0m13:03:55.544995 [info ] [Thread-3 (]: 2 of 2 START sql table model main.orders_summary ............................... [RUN]
[0m13:03:55.547587 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.pipeline_guardian.orders_summary'
[0m13:03:55.548592 [debug] [Thread-3 (]: Began compiling node model.pipeline_guardian.orders_summary
[0m13:03:55.556695 [debug] [Thread-3 (]: Writing injected SQL for node "model.pipeline_guardian.orders_summary"
[0m13:03:55.560693 [debug] [Thread-3 (]: Began executing node model.pipeline_guardian.orders_summary
[0m13:03:55.567728 [debug] [Thread-3 (]: Writing runtime sql for node "model.pipeline_guardian.orders_summary"
[0m13:03:55.570730 [debug] [Thread-3 (]: Using duckdb connection "model.pipeline_guardian.orders_summary"
[0m13:03:55.571732 [debug] [Thread-3 (]: On model.pipeline_guardian.orders_summary: BEGIN
[0m13:03:55.573794 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:03:55.574791 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m13:03:55.575793 [debug] [Thread-3 (]: Using duckdb connection "model.pipeline_guardian.orders_summary"
[0m13:03:55.576794 [debug] [Thread-3 (]: On model.pipeline_guardian.orders_summary: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "model.pipeline_guardian.orders_summary"} */

  
    
    

    create  table
      "demo"."main"."orders_summary__dbt_tmp"
  
    as (
      select count(*) total_orders, sum(amount) total_revenue
from "demo"."main"."stg_orders"
    );
  
  
[0m13:03:55.578792 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:03:55.584310 [debug] [Thread-3 (]: Using duckdb connection "model.pipeline_guardian.orders_summary"
[0m13:03:55.586322 [debug] [Thread-3 (]: On model.pipeline_guardian.orders_summary: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "model.pipeline_guardian.orders_summary"} */
alter table "demo"."main"."orders_summary__dbt_tmp" rename to "orders_summary"
[0m13:03:55.587321 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:03:55.590319 [debug] [Thread-3 (]: On model.pipeline_guardian.orders_summary: COMMIT
[0m13:03:55.591320 [debug] [Thread-3 (]: Using duckdb connection "model.pipeline_guardian.orders_summary"
[0m13:03:55.592837 [debug] [Thread-3 (]: On model.pipeline_guardian.orders_summary: COMMIT
[0m13:03:55.598389 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m13:03:55.606945 [debug] [Thread-3 (]: Using duckdb connection "model.pipeline_guardian.orders_summary"
[0m13:03:55.608947 [debug] [Thread-3 (]: On model.pipeline_guardian.orders_summary: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "model.pipeline_guardian.orders_summary"} */

      drop table if exists "demo"."main"."orders_summary__dbt_backup" cascade
    
[0m13:03:55.609947 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m13:03:55.613457 [debug] [Thread-3 (]: On model.pipeline_guardian.orders_summary: Close
[0m13:03:55.614471 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6601b5fe-6871-4041-af73-fec0acf2744a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228F34B5CF0>]}
[0m13:03:55.615484 [info ] [Thread-3 (]: 2 of 2 OK created sql table model main.orders_summary .......................... [[32mOK[0m in 0.07s]
[0m13:03:55.618488 [debug] [Thread-3 (]: Finished running node model.pipeline_guardian.orders_summary
[0m13:03:55.621530 [debug] [MainThread]: Using duckdb connection "master"
[0m13:03:55.623219 [debug] [MainThread]: On master: BEGIN
[0m13:03:55.624293 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:03:55.625220 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:03:55.626220 [debug] [MainThread]: On master: COMMIT
[0m13:03:55.627220 [debug] [MainThread]: Using duckdb connection "master"
[0m13:03:55.628231 [debug] [MainThread]: On master: COMMIT
[0m13:03:55.629228 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:03:55.629228 [debug] [MainThread]: On master: Close
[0m13:03:55.630231 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:03:55.631340 [debug] [MainThread]: Connection 'create_demo_main' was properly closed.
[0m13:03:55.632858 [debug] [MainThread]: Connection 'list_demo_main' was properly closed.
[0m13:03:55.634870 [debug] [MainThread]: Connection 'model.pipeline_guardian.stg_orders' was properly closed.
[0m13:03:55.635873 [debug] [MainThread]: Connection 'model.pipeline_guardian.orders_summary' was properly closed.
[0m13:03:55.636878 [info ] [MainThread]: 
[0m13:03:55.637873 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.65 seconds (0.65s).
[0m13:03:55.639871 [debug] [MainThread]: Command end result
[0m13:03:55.676479 [debug] [MainThread]: Wrote artifact WritableManifest to dbt\target\manifest.json
[0m13:03:55.680482 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt\target\semantic_manifest.json
[0m13:03:55.691414 [debug] [MainThread]: Wrote artifact RunExecutionResult to dbt\target\run_results.json
[0m13:03:55.691414 [info ] [MainThread]: 
[0m13:03:55.692955 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:03:55.694965 [info ] [MainThread]: 
[0m13:03:55.695964 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m13:03:55.697964 [debug] [MainThread]: Command `dbt run` succeeded at 13:03:55.696965 after 2.56 seconds
[0m13:03:55.697964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228F3BC9F60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228F63C12D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228F74824A0>]}
[0m13:03:55.698963 [debug] [MainThread]: Flushing usage events
[0m13:03:56.205726 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:04:00.439398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249637E6020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024965A63460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024965A631F0>]}


============================== 13:04:00.450938 | 48ee345b-c5f5-446e-8521-7721fb629790 ==============================
[0m13:04:00.450938 [info ] [MainThread]: Running with dbt=1.10.9
[0m13:04:00.453452 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt test --project-dir dbt', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'empty': 'None', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'dbt\\logs', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': 'C:\\Users\\likhi\\Downloads\\pipeline-guardian-v2-upload\\dbt'}
[0m13:04:00.954122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '48ee345b-c5f5-446e-8521-7721fb629790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024965B88A00>]}
[0m13:04:01.054859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '48ee345b-c5f5-446e-8521-7721fb629790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024965B17CD0>]}
[0m13:04:01.059506 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m13:04:01.638695 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m13:04:01.955855 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:04:01.956854 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:04:02.056373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '48ee345b-c5f5-446e-8521-7721fb629790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249670AC4F0>]}
[0m13:04:02.294289 [debug] [MainThread]: Wrote artifact WritableManifest to dbt\target\manifest.json
[0m13:04:02.301297 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt\target\semantic_manifest.json
[0m13:04:02.492680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '48ee345b-c5f5-446e-8521-7721fb629790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024965EB1F60>]}
[0m13:04:02.496720 [info ] [MainThread]: Found 2 models, 1 seed, 4 data tests, 1 source, 429 macros
[0m13:04:02.501719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48ee345b-c5f5-446e-8521-7721fb629790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024965EB0E80>]}
[0m13:04:02.509858 [info ] [MainThread]: 
[0m13:04:02.514976 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:04:02.520999 [info ] [MainThread]: 
[0m13:04:02.526592 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:04:02.573295 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_demo_main'
[0m13:04:02.923687 [debug] [ThreadPool]: Using duckdb connection "list_demo_main"
[0m13:04:02.925685 [debug] [ThreadPool]: On list_demo_main: BEGIN
[0m13:04:02.927683 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:04:03.011991 [debug] [ThreadPool]: SQL status: OK in 0.084 seconds
[0m13:04:03.014493 [debug] [ThreadPool]: Using duckdb connection "list_demo_main"
[0m13:04:03.016515 [debug] [ThreadPool]: On list_demo_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "connection_name": "list_demo_main"} */
select
      'demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'demo'
  
[0m13:04:03.046687 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m13:04:03.084032 [debug] [ThreadPool]: On list_demo_main: ROLLBACK
[0m13:04:03.087115 [debug] [ThreadPool]: Failed to rollback 'list_demo_main'
[0m13:04:03.089113 [debug] [ThreadPool]: On list_demo_main: Close
[0m13:04:03.091116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48ee345b-c5f5-446e-8521-7721fb629790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024965FDA1A0>]}
[0m13:04:03.092626 [debug] [MainThread]: Using duckdb connection "master"
[0m13:04:03.093634 [debug] [MainThread]: On master: BEGIN
[0m13:04:03.094636 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:04:03.095638 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:04:03.096640 [debug] [MainThread]: On master: COMMIT
[0m13:04:03.098638 [debug] [MainThread]: Using duckdb connection "master"
[0m13:04:03.099643 [debug] [MainThread]: On master: COMMIT
[0m13:04:03.102646 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:04:03.105193 [debug] [MainThread]: On master: Close
[0m13:04:03.117731 [debug] [Thread-1 (]: Began running node test.pipeline_guardian.accepted_range_stg_orders_order_date___date_trunc_day_current_date_.2cf9901bb0
[0m13:04:03.119745 [debug] [Thread-2 (]: Began running node test.pipeline_guardian.not_null_stg_orders_amount.2546645448
[0m13:04:03.120738 [debug] [Thread-3 (]: Began running node test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64
[0m13:04:03.122732 [debug] [Thread-4 (]: Began running node test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a
[0m13:04:03.123857 [info ] [Thread-1 (]: 1 of 4 START test accepted_range_stg_orders_order_date___date_trunc_day_current_date_  [RUN]
[0m13:04:03.125879 [info ] [Thread-2 (]: 2 of 4 START test not_null_stg_orders_amount ................................... [RUN]
[0m13:04:03.127863 [info ] [Thread-3 (]: 3 of 4 START test not_null_stg_orders_order_id ................................. [RUN]
[0m13:04:03.129862 [info ] [Thread-4 (]: 4 of 4 START test unique_stg_orders_order_id ................................... [RUN]
[0m13:04:03.132875 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.pipeline_guardian.accepted_range_stg_orders_order_date___date_trunc_day_current_date_.2cf9901bb0'
[0m13:04:03.136326 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.pipeline_guardian.not_null_stg_orders_amount.2546645448'
[0m13:04:03.139337 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64'
[0m13:04:03.141318 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a'
[0m13:04:03.144864 [debug] [Thread-1 (]: Began compiling node test.pipeline_guardian.accepted_range_stg_orders_order_date___date_trunc_day_current_date_.2cf9901bb0
[0m13:04:03.146892 [debug] [Thread-2 (]: Began compiling node test.pipeline_guardian.not_null_stg_orders_amount.2546645448
[0m13:04:03.149899 [debug] [Thread-3 (]: Began compiling node test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64
[0m13:04:03.152889 [debug] [Thread-4 (]: Began compiling node test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a
[0m13:04:03.210142 [debug] [Thread-2 (]: Writing injected SQL for node "test.pipeline_guardian.not_null_stg_orders_amount.2546645448"
[0m13:04:03.219663 [debug] [Thread-3 (]: Writing injected SQL for node "test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:04:03.230195 [debug] [Thread-4 (]: Writing injected SQL for node "test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a"
[0m13:04:03.233714 [debug] [Thread-2 (]: Began executing node test.pipeline_guardian.not_null_stg_orders_amount.2546645448
[0m13:04:03.243414 [debug] [Thread-3 (]: Began executing node test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64
[0m13:04:03.258901 [debug] [Thread-2 (]: Writing runtime sql for node "test.pipeline_guardian.not_null_stg_orders_amount.2546645448"
[0m13:04:03.263634 [debug] [Thread-3 (]: Writing runtime sql for node "test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:04:03.266716 [debug] [Thread-2 (]: Using duckdb connection "test.pipeline_guardian.not_null_stg_orders_amount.2546645448"
[0m13:04:03.268275 [debug] [Thread-3 (]: Using duckdb connection "test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:04:03.269826 [debug] [Thread-2 (]: On test.pipeline_guardian.not_null_stg_orders_amount.2546645448: BEGIN
[0m13:04:03.271386 [debug] [Thread-3 (]: On test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m13:04:03.272929 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:04:03.272929 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:04:03.274492 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m13:04:03.277104 [debug] [Thread-4 (]: Began executing node test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a
[0m13:04:03.279104 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m13:04:03.281102 [debug] [Thread-2 (]: Using duckdb connection "test.pipeline_guardian.not_null_stg_orders_amount.2546645448"
[0m13:04:03.287156 [debug] [Thread-4 (]: Writing runtime sql for node "test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a"
[0m13:04:03.289158 [debug] [Thread-3 (]: Using duckdb connection "test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:04:03.290157 [debug] [Thread-2 (]: On test.pipeline_guardian.not_null_stg_orders_amount.2546645448: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "test.pipeline_guardian.not_null_stg_orders_amount.2546645448"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select amount
from "demo"."main"."stg_orders"
where amount is null



  
  
      
    ) dbt_internal_test
[0m13:04:03.292674 [debug] [Thread-3 (]: On test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "demo"."main"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m13:04:03.294686 [debug] [Thread-4 (]: Using duckdb connection "test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a"
[0m13:04:03.297698 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m13:04:03.299714 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m13:04:03.300695 [debug] [Thread-4 (]: On test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m13:04:03.308234 [debug] [Thread-2 (]: On test.pipeline_guardian.not_null_stg_orders_amount.2546645448: ROLLBACK
[0m13:04:03.310229 [debug] [Thread-1 (]: Compilation Error in test accepted_range_stg_orders_order_date___date_trunc_day_current_date_ (models\schema.yml)
  'current_date' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:04:03.312745 [debug] [Thread-3 (]: On test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m13:04:03.313755 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:04:03.314756 [debug] [Thread-2 (]: Failed to rollback 'test.pipeline_guardian.not_null_stg_orders_amount.2546645448'
[0m13:04:03.315758 [error] [Thread-1 (]: 1 of 4 ERROR accepted_range_stg_orders_order_date___date_trunc_day_current_date_  [[31mERROR[0m in 0.18s]
[0m13:04:03.316758 [debug] [Thread-3 (]: Failed to rollback 'test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64'
[0m13:04:03.318766 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m13:04:03.320759 [debug] [Thread-2 (]: On test.pipeline_guardian.not_null_stg_orders_amount.2546645448: Close
[0m13:04:03.321761 [debug] [Thread-1 (]: Finished running node test.pipeline_guardian.accepted_range_stg_orders_order_date___date_trunc_day_current_date_.2cf9901bb0
[0m13:04:03.323915 [debug] [Thread-3 (]: On test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m13:04:03.325915 [debug] [Thread-4 (]: Using duckdb connection "test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a"
[0m13:04:03.327912 [error] [Thread-2 (]: 2 of 4 FAIL 1 not_null_stg_orders_amount ....................................... [[31mFAIL 1[0m in 0.19s]
[0m13:04:03.329919 [debug] [Thread-7 (]: Marking all children of 'test.pipeline_guardian.accepted_range_stg_orders_order_date___date_trunc_day_current_date_.2cf9901bb0' to be skipped because of status 'error'.  Reason: Compilation Error in test accepted_range_stg_orders_order_date___date_trunc_day_current_date_ (models\schema.yml)
  'current_date' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:04:03.333432 [info ] [Thread-3 (]: 3 of 4 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 0.19s]
[0m13:04:03.336464 [debug] [Thread-4 (]: On test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "demo"."main"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:04:03.341465 [debug] [Thread-2 (]: Finished running node test.pipeline_guardian.not_null_stg_orders_amount.2546645448
[0m13:04:03.347014 [debug] [Thread-3 (]: Finished running node test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64
[0m13:04:03.353011 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m13:04:03.359361 [debug] [Thread-4 (]: On test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m13:04:03.362880 [debug] [Thread-4 (]: Failed to rollback 'test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a'
[0m13:04:03.365940 [debug] [Thread-4 (]: On test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a: Close
[0m13:04:03.369921 [error] [Thread-4 (]: 4 of 4 FAIL 2 unique_stg_orders_order_id ....................................... [[31mFAIL 2[0m in 0.23s]
[0m13:04:03.376481 [debug] [Thread-4 (]: Finished running node test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a
[0m13:04:03.381481 [debug] [MainThread]: Using duckdb connection "master"
[0m13:04:03.385047 [debug] [MainThread]: On master: BEGIN
[0m13:04:03.387622 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:04:03.390605 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m13:04:03.392596 [debug] [MainThread]: On master: COMMIT
[0m13:04:03.393114 [debug] [MainThread]: Using duckdb connection "master"
[0m13:04:03.395131 [debug] [MainThread]: On master: COMMIT
[0m13:04:03.398141 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:04:03.401138 [debug] [MainThread]: On master: Close
[0m13:04:03.404679 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:04:03.406691 [debug] [MainThread]: Connection 'list_demo_main' was properly closed.
[0m13:04:03.407684 [debug] [MainThread]: Connection 'test.pipeline_guardian.accepted_range_stg_orders_order_date___date_trunc_day_current_date_.2cf9901bb0' was properly closed.
[0m13:04:03.409688 [debug] [MainThread]: Connection 'test.pipeline_guardian.not_null_stg_orders_amount.2546645448' was properly closed.
[0m13:04:03.410674 [debug] [MainThread]: Connection 'test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64' was properly closed.
[0m13:04:03.411687 [debug] [MainThread]: Connection 'test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m13:04:03.412671 [info ] [MainThread]: 
[0m13:04:03.413187 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 0.89 seconds (0.89s).
[0m13:04:03.418203 [debug] [MainThread]: Command end result
[0m13:04:03.476835 [debug] [MainThread]: Wrote artifact WritableManifest to dbt\target\manifest.json
[0m13:04:03.484391 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt\target\semantic_manifest.json
[0m13:04:03.501171 [debug] [MainThread]: Wrote artifact RunExecutionResult to dbt\target\run_results.json
[0m13:04:03.502689 [info ] [MainThread]: 
[0m13:04:03.503704 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m13:04:03.505713 [info ] [MainThread]: 
[0m13:04:03.508707 [error] [MainThread]: [31mFailure in test accepted_range_stg_orders_order_date___date_trunc_day_current_date_ (models\schema.yml)[0m
[0m13:04:03.511712 [error] [MainThread]:   Compilation Error in test accepted_range_stg_orders_order_date___date_trunc_day_current_date_ (models\schema.yml)
  'current_date' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:04:03.514792 [info ] [MainThread]: 
[0m13:04:03.517793 [error] [MainThread]: [31mFailure in test not_null_stg_orders_amount (models\schema.yml)[0m
[0m13:04:03.521786 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:04:03.525354 [info ] [MainThread]: 
[0m13:04:03.529351 [info ] [MainThread]:   compiled code at target\compiled\pipeline_guardian\models\schema.yml\not_null_stg_orders_amount.sql
[0m13:04:03.532863 [info ] [MainThread]: 
[0m13:04:03.536902 [error] [MainThread]: [31mFailure in test unique_stg_orders_order_id (models\schema.yml)[0m
[0m13:04:03.541907 [error] [MainThread]:   Got 2 results, configured to fail if != 0
[0m13:04:03.545480 [info ] [MainThread]: 
[0m13:04:03.548469 [info ] [MainThread]:   compiled code at target\compiled\pipeline_guardian\models\schema.yml\unique_stg_orders_order_id.sql
[0m13:04:03.551465 [info ] [MainThread]: 
[0m13:04:03.556036 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=4
[0m13:04:03.561031 [debug] [MainThread]: Command `dbt test` failed at 13:04:03.560043 after 3.28 seconds
[0m13:04:03.562550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249637E6020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024963AAD1E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002496764D000>]}
[0m13:04:03.565574 [debug] [MainThread]: Flushing usage events
[0m13:04:04.270743 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:12:07.935927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219296460B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002192B8B8CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002192B8B8AF0>]}


============================== 13:12:07.945487 | ac4f5cdf-d14b-4901-a6e7-7ec715a9959a ==============================
[0m13:12:07.945487 [info ] [MainThread]: Running with dbt=1.10.9
[0m13:12:07.946513 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\likhi\\Downloads\\pipeline-guardian-v2-upload\\dbt', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt seed --full-refresh', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'None', 'printer_width': '80', 'log_path': 'C:\\Users\\likhi\\Downloads\\pipeline-guardian-v2-upload\\dbt\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m13:12:08.683384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac4f5cdf-d14b-4901-a6e7-7ec715a9959a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002192B9B4250>]}
[0m13:12:08.867894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac4f5cdf-d14b-4901-a6e7-7ec715a9959a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002192B9B67D0>]}
[0m13:12:08.878768 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m13:12:09.971778 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m13:12:10.656918 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:12:10.658883 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:12:10.881893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac4f5cdf-d14b-4901-a6e7-7ec715a9959a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002192CF00400>]}
[0m13:12:11.245032 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\manifest.json
[0m13:12:11.253564 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\semantic_manifest.json
[0m13:12:11.373111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac4f5cdf-d14b-4901-a6e7-7ec715a9959a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002192CF01240>]}
[0m13:12:11.376144 [info ] [MainThread]: Found 2 models, 1 seed, 4 data tests, 1 source, 429 macros
[0m13:12:11.379486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac4f5cdf-d14b-4901-a6e7-7ec715a9959a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002192BD0AB90>]}
[0m13:12:11.387036 [info ] [MainThread]: 
[0m13:12:11.390029 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:12:11.393545 [info ] [MainThread]: 
[0m13:12:11.397591 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:12:11.404827 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_demo'
[0m13:12:11.851679 [debug] [ThreadPool]: Using duckdb connection "list_demo"
[0m13:12:11.853330 [debug] [ThreadPool]: On list_demo: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "connection_name": "list_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"demo"'
    
  
  
[0m13:12:11.855451 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:12:11.904536 [debug] [ThreadPool]: SQL status: OK in 0.049 seconds
[0m13:12:11.908798 [debug] [ThreadPool]: On list_demo: Close
[0m13:12:11.911857 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_demo, now create_demo_main)
[0m13:12:11.913467 [debug] [ThreadPool]: Creating schema "database: "demo"
schema: "main"
"
[0m13:12:11.931528 [debug] [ThreadPool]: Using duckdb connection "create_demo_main"
[0m13:12:11.934151 [debug] [ThreadPool]: On create_demo_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "connection_name": "create_demo_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='demo'
        and type='sqlite'
    
  
[0m13:12:11.936195 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:12:11.939249 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m13:12:11.943154 [debug] [ThreadPool]: Using duckdb connection "create_demo_main"
[0m13:12:11.944742 [debug] [ThreadPool]: On create_demo_main: BEGIN
[0m13:12:11.946787 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:12:11.948786 [debug] [ThreadPool]: Using duckdb connection "create_demo_main"
[0m13:12:11.950800 [debug] [ThreadPool]: On create_demo_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "connection_name": "create_demo_main"} */

    
    
        create schema if not exists "demo"."main"
    
[0m13:12:11.951807 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:12:11.955426 [debug] [ThreadPool]: On create_demo_main: COMMIT
[0m13:12:11.957442 [debug] [ThreadPool]: Using duckdb connection "create_demo_main"
[0m13:12:11.959450 [debug] [ThreadPool]: On create_demo_main: COMMIT
[0m13:12:11.961434 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:12:11.962427 [debug] [ThreadPool]: On create_demo_main: Close
[0m13:12:11.981418 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_demo_main'
[0m13:12:11.997327 [debug] [ThreadPool]: Using duckdb connection "list_demo_main"
[0m13:12:11.999329 [debug] [ThreadPool]: On list_demo_main: BEGIN
[0m13:12:12.002326 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:12:12.004591 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m13:12:12.006051 [debug] [ThreadPool]: Using duckdb connection "list_demo_main"
[0m13:12:12.008136 [debug] [ThreadPool]: On list_demo_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "connection_name": "list_demo_main"} */
select
      'demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'demo'
  
[0m13:12:12.043257 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m13:12:12.048763 [debug] [ThreadPool]: On list_demo_main: ROLLBACK
[0m13:12:12.051763 [debug] [ThreadPool]: Failed to rollback 'list_demo_main'
[0m13:12:12.053360 [debug] [ThreadPool]: On list_demo_main: Close
[0m13:12:12.055387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac4f5cdf-d14b-4901-a6e7-7ec715a9959a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002192CF017B0>]}
[0m13:12:12.057376 [debug] [MainThread]: Using duckdb connection "master"
[0m13:12:12.059392 [debug] [MainThread]: On master: BEGIN
[0m13:12:12.061379 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:12:12.063904 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m13:12:12.064924 [debug] [MainThread]: On master: COMMIT
[0m13:12:12.067055 [debug] [MainThread]: Using duckdb connection "master"
[0m13:12:12.068063 [debug] [MainThread]: On master: COMMIT
[0m13:12:12.071055 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:12:12.073053 [debug] [MainThread]: On master: Close
[0m13:12:12.091251 [debug] [Thread-1 (]: Began running node seed.pipeline_guardian.orders
[0m13:12:12.093208 [info ] [Thread-1 (]: 1 of 1 START seed file main.orders ............................................. [RUN]
[0m13:12:12.096428 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.pipeline_guardian.orders'
[0m13:12:12.098471 [debug] [Thread-1 (]: Began compiling node seed.pipeline_guardian.orders
[0m13:12:12.099470 [debug] [Thread-1 (]: Began executing node seed.pipeline_guardian.orders
[0m13:12:12.175124 [debug] [Thread-1 (]: Using duckdb connection "seed.pipeline_guardian.orders"
[0m13:12:12.177121 [debug] [Thread-1 (]: On seed.pipeline_guardian.orders: BEGIN
[0m13:12:12.179122 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:12:12.182117 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:12:12.185488 [debug] [Thread-1 (]: Using duckdb connection "seed.pipeline_guardian.orders"
[0m13:12:12.187470 [debug] [Thread-1 (]: On seed.pipeline_guardian.orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "seed.pipeline_guardian.orders"} */

    create table "demo"."main"."orders" ("order_id" integer,"customer_id" text,"amount" float8,"order_date" date)
  
[0m13:12:12.189952 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:12:12.222121 [debug] [Thread-1 (]: Using duckdb connection "seed.pipeline_guardian.orders"
[0m13:12:12.223118 [debug] [Thread-1 (]: On seed.pipeline_guardian.orders: 
          COPY "demo"."main"."orders" FROM 'dbt\seeds\orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m13:12:12.227645 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: 
          COPY "demo"."main"."orders" FROM 'dbt\seeds\orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        
[0m13:12:12.230618 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:12:12.231611 [debug] [Thread-1 (]: On seed.pipeline_guardian.orders: ROLLBACK
[0m13:12:12.246573 [debug] [Thread-1 (]: Failed to rollback 'seed.pipeline_guardian.orders'
[0m13:12:12.248579 [debug] [Thread-1 (]: On seed.pipeline_guardian.orders: Close
[0m13:12:12.255187 [debug] [Thread-1 (]: Runtime Error in seed orders (seeds\orders.csv)
  IO Error: No files found that match the pattern "dbt\seeds\orders.csv"
[0m13:12:12.263168 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac4f5cdf-d14b-4901-a6e7-7ec715a9959a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002192CF17340>]}
[0m13:12:12.265823 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file main.orders ..................................... [[31mERROR[0m in 0.16s]
[0m13:12:12.268759 [debug] [Thread-1 (]: Finished running node seed.pipeline_guardian.orders
[0m13:12:12.271759 [debug] [Thread-7 (]: Marking all children of 'seed.pipeline_guardian.orders' to be skipped because of status 'error'.  Reason: Runtime Error in seed orders (seeds\orders.csv)
  IO Error: No files found that match the pattern "dbt\seeds\orders.csv".
[0m13:12:12.277358 [debug] [MainThread]: Using duckdb connection "master"
[0m13:12:12.279300 [debug] [MainThread]: On master: BEGIN
[0m13:12:12.281298 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:12:12.284403 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m13:12:12.286419 [debug] [MainThread]: On master: COMMIT
[0m13:12:12.288462 [debug] [MainThread]: Using duckdb connection "master"
[0m13:12:12.290415 [debug] [MainThread]: On master: COMMIT
[0m13:12:12.291468 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:12:12.294112 [debug] [MainThread]: On master: Close
[0m13:12:12.297111 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:12:12.298107 [debug] [MainThread]: Connection 'create_demo_main' was properly closed.
[0m13:12:12.300061 [debug] [MainThread]: Connection 'list_demo_main' was properly closed.
[0m13:12:12.301061 [debug] [MainThread]: Connection 'seed.pipeline_guardian.orders' was properly closed.
[0m13:12:12.303574 [info ] [MainThread]: 
[0m13:12:12.305596 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.91 seconds (0.91s).
[0m13:12:12.308624 [debug] [MainThread]: Command end result
[0m13:12:12.377766 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\manifest.json
[0m13:12:12.386297 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\semantic_manifest.json
[0m13:12:12.409844 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\run_results.json
[0m13:12:12.411849 [info ] [MainThread]: 
[0m13:12:12.415393 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:12:12.417410 [info ] [MainThread]: 
[0m13:12:12.419410 [error] [MainThread]: [31mFailure in seed orders (seeds\orders.csv)[0m
[0m13:12:12.421412 [error] [MainThread]:   Runtime Error in seed orders (seeds\orders.csv)
  IO Error: No files found that match the pattern "dbt\seeds\orders.csv"
[0m13:12:12.463981 [info ] [MainThread]: 
[0m13:12:12.466010 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m13:12:12.472010 [debug] [MainThread]: Command `dbt seed` failed at 13:12:12.471008 after 4.78 seconds
[0m13:12:12.474091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219296460B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002192CF4E1A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002192CF4CAC0>]}
[0m13:12:12.476120 [debug] [MainThread]: Flushing usage events
[0m13:12:13.113923 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:12:34.255289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E45B36080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E47DA4B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E47DA49A0>]}


============================== 13:12:34.269627 | 3ff0c833-c2b6-4fd8-8d65-b8a1de1c78e8 ==============================
[0m13:12:34.269627 [info ] [MainThread]: Running with dbt=1.10.9
[0m13:12:34.271621 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt deps', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'use_experimental_parser': 'False', 'printer_width': '80', 'log_path': 'C:\\Users\\likhi\\Downloads\\pipeline-guardian-v2-upload\\dbt\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\likhi\\Downloads\\pipeline-guardian-v2-upload\\dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m13:12:34.746152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3ff0c833-c2b6-4fd8-8d65-b8a1de1c78e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E47DA5690>]}
[0m13:12:34.855424 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:12:34.865085 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:12:34.871048 [debug] [MainThread]: Command `dbt deps` succeeded at 13:12:34.870030 after 0.91 seconds
[0m13:12:34.873544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E45B36080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E47DA5690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E47F01C00>]}
[0m13:12:34.876576 [debug] [MainThread]: Flushing usage events
[0m13:12:35.355488 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:12:41.567286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002315F4960B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023161704CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023161704AF0>]}


============================== 13:12:41.574355 | b1c02a05-070b-415e-b7df-4ad537e2d3d8 ==============================
[0m13:12:41.574355 [info ] [MainThread]: Running with dbt=1.10.9
[0m13:12:41.576452 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\likhi\\Downloads\\pipeline-guardian-v2-upload\\dbt\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\likhi\\Downloads\\pipeline-guardian-v2-upload\\dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m13:12:42.284507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1c02a05-070b-415e-b7df-4ad537e2d3d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023161804250>]}
[0m13:12:42.468713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1c02a05-070b-415e-b7df-4ad537e2d3d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023160E612D0>]}
[0m13:12:42.478597 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m13:12:43.650165 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m13:12:44.337294 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:12:44.339332 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:12:44.563649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1c02a05-070b-415e-b7df-4ad537e2d3d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023161D80460>]}
[0m13:12:44.979022 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\manifest.json
[0m13:12:44.988490 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\semantic_manifest.json
[0m13:12:45.097532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1c02a05-070b-415e-b7df-4ad537e2d3d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023161999270>]}
[0m13:12:45.099542 [info ] [MainThread]: Found 2 models, 1 seed, 4 data tests, 1 source, 429 macros
[0m13:12:45.102124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1c02a05-070b-415e-b7df-4ad537e2d3d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002316199BBB0>]}
[0m13:12:45.107134 [info ] [MainThread]: 
[0m13:12:45.109142 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:12:45.111130 [info ] [MainThread]: 
[0m13:12:45.114343 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:12:45.134672 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_demo'
[0m13:12:45.652293 [debug] [ThreadPool]: Using duckdb connection "list_demo"
[0m13:12:45.654298 [debug] [ThreadPool]: On list_demo: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "connection_name": "list_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"demo"'
    
  
  
[0m13:12:45.656306 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:12:45.720088 [debug] [ThreadPool]: SQL status: OK in 0.063 seconds
[0m13:12:45.724811 [debug] [ThreadPool]: On list_demo: Close
[0m13:12:45.727817 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_demo, now create_demo_main)
[0m13:12:45.729806 [debug] [ThreadPool]: Creating schema "database: "demo"
schema: "main"
"
[0m13:12:45.748302 [debug] [ThreadPool]: Using duckdb connection "create_demo_main"
[0m13:12:45.750300 [debug] [ThreadPool]: On create_demo_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "connection_name": "create_demo_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='demo'
        and type='sqlite'
    
  
[0m13:12:45.753035 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:12:45.756051 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m13:12:45.760036 [debug] [ThreadPool]: Using duckdb connection "create_demo_main"
[0m13:12:45.761656 [debug] [ThreadPool]: On create_demo_main: BEGIN
[0m13:12:45.763787 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:12:45.765768 [debug] [ThreadPool]: Using duckdb connection "create_demo_main"
[0m13:12:45.766783 [debug] [ThreadPool]: On create_demo_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "connection_name": "create_demo_main"} */

    
    
        create schema if not exists "demo"."main"
    
[0m13:12:45.769783 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:12:45.772523 [debug] [ThreadPool]: On create_demo_main: COMMIT
[0m13:12:45.774530 [debug] [ThreadPool]: Using duckdb connection "create_demo_main"
[0m13:12:45.776537 [debug] [ThreadPool]: On create_demo_main: COMMIT
[0m13:12:45.778519 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:12:45.780525 [debug] [ThreadPool]: On create_demo_main: Close
[0m13:12:45.784280 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_demo_main'
[0m13:12:45.799736 [debug] [ThreadPool]: Using duckdb connection "list_demo_main"
[0m13:12:45.802487 [debug] [ThreadPool]: On list_demo_main: BEGIN
[0m13:12:45.804493 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:12:45.806483 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m13:12:45.808479 [debug] [ThreadPool]: Using duckdb connection "list_demo_main"
[0m13:12:45.809493 [debug] [ThreadPool]: On list_demo_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "connection_name": "list_demo_main"} */
select
      'demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'demo'
  
[0m13:12:45.845419 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m13:12:45.851456 [debug] [ThreadPool]: On list_demo_main: ROLLBACK
[0m13:12:45.854594 [debug] [ThreadPool]: Failed to rollback 'list_demo_main'
[0m13:12:45.855575 [debug] [ThreadPool]: On list_demo_main: Close
[0m13:12:45.858584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1c02a05-070b-415e-b7df-4ad537e2d3d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023161937400>]}
[0m13:12:45.861195 [debug] [MainThread]: Using duckdb connection "master"
[0m13:12:45.863319 [debug] [MainThread]: On master: BEGIN
[0m13:12:45.865263 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:12:45.867311 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m13:12:45.869326 [debug] [MainThread]: On master: COMMIT
[0m13:12:45.871316 [debug] [MainThread]: Using duckdb connection "master"
[0m13:12:45.873051 [debug] [MainThread]: On master: COMMIT
[0m13:12:45.875047 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:12:45.877046 [debug] [MainThread]: On master: Close
[0m13:12:45.892565 [debug] [Thread-1 (]: Began running node model.pipeline_guardian.stg_orders
[0m13:12:45.894588 [info ] [Thread-1 (]: 1 of 2 START sql table model main.stg_orders ................................... [RUN]
[0m13:12:45.897584 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.pipeline_guardian.stg_orders'
[0m13:12:45.899584 [debug] [Thread-1 (]: Began compiling node model.pipeline_guardian.stg_orders
[0m13:12:45.923519 [debug] [Thread-1 (]: Writing injected SQL for node "model.pipeline_guardian.stg_orders"
[0m13:12:45.927646 [debug] [Thread-1 (]: Began executing node model.pipeline_guardian.stg_orders
[0m13:12:46.030481 [debug] [Thread-1 (]: Writing runtime sql for node "model.pipeline_guardian.stg_orders"
[0m13:12:46.034910 [debug] [Thread-1 (]: Using duckdb connection "model.pipeline_guardian.stg_orders"
[0m13:12:46.036912 [debug] [Thread-1 (]: On model.pipeline_guardian.stg_orders: BEGIN
[0m13:12:46.039915 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:12:46.043465 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:12:46.045458 [debug] [Thread-1 (]: Using duckdb connection "model.pipeline_guardian.stg_orders"
[0m13:12:46.048462 [debug] [Thread-1 (]: On model.pipeline_guardian.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "model.pipeline_guardian.stg_orders"} */

  
    
    

    create  table
      "demo"."main"."stg_orders__dbt_tmp"
  
    as (
      with source as (
    select * from "demo"."main"."orders"
),

-- PATCH_AREA_START
-- naive logic (will fail tests)
patched as (
    select
        order_id,
        customer_id,
        cast(amount as double) as amount,
        cast(order_date as date) as order_date
    from source
)
-- PATCH_AREA_END

select * from patched
    );
  
  
[0m13:12:46.052894 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "model.pipeline_guardian.stg_orders"} */

  
    
    

    create  table
      "demo"."main"."stg_orders__dbt_tmp"
  
    as (
      with source as (
    select * from "demo"."main"."orders"
),

-- PATCH_AREA_START
-- naive logic (will fail tests)
patched as (
    select
        order_id,
        customer_id,
        cast(amount as double) as amount,
        cast(order_date as date) as order_date
    from source
)
-- PATCH_AREA_END

select * from patched
    );
  
  
[0m13:12:46.056275 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:12:46.058278 [debug] [Thread-1 (]: On model.pipeline_guardian.stg_orders: ROLLBACK
[0m13:12:46.073453 [debug] [Thread-1 (]: Failed to rollback 'model.pipeline_guardian.stg_orders'
[0m13:12:46.075741 [debug] [Thread-1 (]: On model.pipeline_guardian.stg_orders: Close
[0m13:12:46.083313 [debug] [Thread-1 (]: Runtime Error in model stg_orders (models\staging\stg_orders.sql)
  Catalog Error: Table with name orders does not exist!
  Did you mean "information_schema.character_sets"?
  
  LINE 12:     select * from "demo"."main"."orders"
                             ^
[0m13:12:46.094164 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1c02a05-070b-415e-b7df-4ad537e2d3d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002315E24F820>]}
[0m13:12:46.097163 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model main.stg_orders .......................... [[31mERROR[0m in 0.19s]
[0m13:12:46.099166 [debug] [Thread-1 (]: Finished running node model.pipeline_guardian.stg_orders
[0m13:12:46.102503 [debug] [Thread-7 (]: Marking all children of 'model.pipeline_guardian.stg_orders' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_orders (models\staging\stg_orders.sql)
  Catalog Error: Table with name orders does not exist!
  Did you mean "information_schema.character_sets"?
  
  LINE 12:     select * from "demo"."main"."orders"
                             ^.
[0m13:12:46.106493 [debug] [Thread-3 (]: Began running node model.pipeline_guardian.orders_summary
[0m13:12:46.108497 [info ] [Thread-3 (]: 2 of 2 SKIP relation main.orders_summary ....................................... [[33mSKIP[0m]
[0m13:12:46.111494 [debug] [Thread-3 (]: Finished running node model.pipeline_guardian.orders_summary
[0m13:12:46.114772 [debug] [MainThread]: Using duckdb connection "master"
[0m13:12:46.117790 [debug] [MainThread]: On master: BEGIN
[0m13:12:46.119770 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:12:46.122329 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m13:12:46.125480 [debug] [MainThread]: On master: COMMIT
[0m13:12:46.126583 [debug] [MainThread]: Using duckdb connection "master"
[0m13:12:46.128612 [debug] [MainThread]: On master: COMMIT
[0m13:12:46.132191 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:12:46.135216 [debug] [MainThread]: On master: Close
[0m13:12:46.137215 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:12:46.140218 [debug] [MainThread]: Connection 'create_demo_main' was properly closed.
[0m13:12:46.142761 [debug] [MainThread]: Connection 'list_demo_main' was properly closed.
[0m13:12:46.143780 [debug] [MainThread]: Connection 'model.pipeline_guardian.stg_orders' was properly closed.
[0m13:12:46.145777 [info ] [MainThread]: 
[0m13:12:46.148777 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 1.03 seconds (1.03s).
[0m13:12:46.153309 [debug] [MainThread]: Command end result
[0m13:12:46.214149 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\manifest.json
[0m13:12:46.222673 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\semantic_manifest.json
[0m13:12:46.247851 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\run_results.json
[0m13:12:46.249845 [info ] [MainThread]: 
[0m13:12:46.252474 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:12:46.253469 [info ] [MainThread]: 
[0m13:12:46.256426 [error] [MainThread]: [31mFailure in model stg_orders (models\staging\stg_orders.sql)[0m
[0m13:12:46.259424 [error] [MainThread]:   Runtime Error in model stg_orders (models\staging\stg_orders.sql)
  Catalog Error: Table with name orders does not exist!
  Did you mean "information_schema.character_sets"?
  
  LINE 12:     select * from "demo"."main"."orders"
                             ^
[0m13:12:46.261941 [info ] [MainThread]: 
[0m13:12:46.264011 [info ] [MainThread]:   compiled code at target\compiled\pipeline_guardian\models\staging\stg_orders.sql
[0m13:12:46.265980 [info ] [MainThread]: 
[0m13:12:46.268009 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=2
[0m13:12:46.272190 [debug] [MainThread]: Command `dbt run` failed at 13:12:46.272190 after 4.99 seconds
[0m13:12:46.273171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002315F4960B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023161D97370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023161DC5540>]}
[0m13:12:46.275182 [debug] [MainThread]: Flushing usage events
[0m13:12:46.677776 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:12:58.167438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240B8A2E110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240BAD18EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240BAD18CD0>]}


============================== 13:12:58.173963 | dbcea3a3-4d8b-4186-bc7e-c24936f3593c ==============================
[0m13:12:58.173963 [info ] [MainThread]: Running with dbt=1.10.9
[0m13:12:58.174961 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\likhi\\Downloads\\pipeline-guardian-v2-upload\\dbt', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt test', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'printer_width': '80', 'use_experimental_parser': 'False', 'empty': 'None', 'log_path': 'C:\\Users\\likhi\\Downloads\\pipeline-guardian-v2-upload\\dbt\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m13:12:58.823493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dbcea3a3-4d8b-4186-bc7e-c24936f3593c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240B9DF4AF0>]}
[0m13:12:58.996791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dbcea3a3-4d8b-4186-bc7e-c24936f3593c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240BA4E71F0>]}
[0m13:12:59.005321 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m13:13:00.102658 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m13:13:00.743266 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:13:00.745280 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:13:00.949038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dbcea3a3-4d8b-4186-bc7e-c24936f3593c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240BB3945E0>]}
[0m13:13:01.289618 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\manifest.json
[0m13:13:01.297264 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\semantic_manifest.json
[0m13:13:01.511554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dbcea3a3-4d8b-4186-bc7e-c24936f3593c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240BB28DC00>]}
[0m13:13:01.513605 [info ] [MainThread]: Found 2 models, 1 seed, 4 data tests, 1 source, 429 macros
[0m13:13:01.515606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbcea3a3-4d8b-4186-bc7e-c24936f3593c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240B8AE56F0>]}
[0m13:13:01.522233 [info ] [MainThread]: 
[0m13:13:01.524186 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:13:01.526183 [info ] [MainThread]: 
[0m13:13:01.529234 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:13:01.549416 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_demo_main'
[0m13:13:01.865377 [debug] [ThreadPool]: Using duckdb connection "list_demo_main"
[0m13:13:01.867046 [debug] [ThreadPool]: On list_demo_main: BEGIN
[0m13:13:01.868720 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:13:01.913877 [debug] [ThreadPool]: SQL status: OK in 0.044 seconds
[0m13:13:01.915836 [debug] [ThreadPool]: Using duckdb connection "list_demo_main"
[0m13:13:01.916882 [debug] [ThreadPool]: On list_demo_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "connection_name": "list_demo_main"} */
select
      'demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'demo'
  
[0m13:13:01.952237 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m13:13:01.955306 [debug] [ThreadPool]: On list_demo_main: ROLLBACK
[0m13:13:01.958309 [debug] [ThreadPool]: Failed to rollback 'list_demo_main'
[0m13:13:01.959228 [debug] [ThreadPool]: On list_demo_main: Close
[0m13:13:01.961799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbcea3a3-4d8b-4186-bc7e-c24936f3593c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240BB184430>]}
[0m13:13:01.963846 [debug] [MainThread]: Using duckdb connection "master"
[0m13:13:01.964847 [debug] [MainThread]: On master: BEGIN
[0m13:13:01.965844 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:13:01.967840 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m13:13:01.969845 [debug] [MainThread]: On master: COMMIT
[0m13:13:01.971419 [debug] [MainThread]: Using duckdb connection "master"
[0m13:13:01.972477 [debug] [MainThread]: On master: COMMIT
[0m13:13:01.975477 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:13:01.976547 [debug] [MainThread]: On master: Close
[0m13:13:01.989219 [debug] [Thread-1 (]: Began running node test.pipeline_guardian.accepted_range_stg_orders_order_date___date_trunc_day_current_date_.2cf9901bb0
[0m13:13:01.990192 [debug] [Thread-2 (]: Began running node test.pipeline_guardian.not_null_stg_orders_amount.2546645448
[0m13:13:01.991765 [debug] [Thread-3 (]: Began running node test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64
[0m13:13:01.992811 [debug] [Thread-4 (]: Began running node test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a
[0m13:13:01.994810 [info ] [Thread-1 (]: 1 of 4 START test accepted_range_stg_orders_order_date___date_trunc_day_current_date_  [RUN]
[0m13:13:01.996811 [info ] [Thread-2 (]: 2 of 4 START test not_null_stg_orders_amount ................................... [RUN]
[0m13:13:01.997812 [info ] [Thread-3 (]: 3 of 4 START test not_null_stg_orders_order_id ................................. [RUN]
[0m13:13:01.999812 [info ] [Thread-4 (]: 4 of 4 START test unique_stg_orders_order_id ................................... [RUN]
[0m13:13:02.002425 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.pipeline_guardian.accepted_range_stg_orders_order_date___date_trunc_day_current_date_.2cf9901bb0'
[0m13:13:02.004432 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.pipeline_guardian.not_null_stg_orders_amount.2546645448'
[0m13:13:02.006383 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64'
[0m13:13:02.008419 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a'
[0m13:13:02.009598 [debug] [Thread-1 (]: Began compiling node test.pipeline_guardian.accepted_range_stg_orders_order_date___date_trunc_day_current_date_.2cf9901bb0
[0m13:13:02.012205 [debug] [Thread-2 (]: Began compiling node test.pipeline_guardian.not_null_stg_orders_amount.2546645448
[0m13:13:02.014391 [debug] [Thread-3 (]: Began compiling node test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64
[0m13:13:02.016408 [debug] [Thread-4 (]: Began compiling node test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a
[0m13:13:02.071102 [debug] [Thread-2 (]: Writing injected SQL for node "test.pipeline_guardian.not_null_stg_orders_amount.2546645448"
[0m13:13:02.083768 [debug] [Thread-3 (]: Writing injected SQL for node "test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:13:02.101984 [debug] [Thread-4 (]: Writing injected SQL for node "test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a"
[0m13:13:02.107045 [debug] [Thread-2 (]: Began executing node test.pipeline_guardian.not_null_stg_orders_amount.2546645448
[0m13:13:02.130260 [debug] [Thread-3 (]: Began executing node test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64
[0m13:13:02.131825 [debug] [Thread-4 (]: Began executing node test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a
[0m13:13:02.165339 [debug] [Thread-2 (]: Writing runtime sql for node "test.pipeline_guardian.not_null_stg_orders_amount.2546645448"
[0m13:13:02.172940 [debug] [Thread-3 (]: Writing runtime sql for node "test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:13:02.182572 [debug] [Thread-4 (]: Writing runtime sql for node "test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a"
[0m13:13:02.188519 [debug] [Thread-2 (]: Using duckdb connection "test.pipeline_guardian.not_null_stg_orders_amount.2546645448"
[0m13:13:02.192065 [debug] [Thread-3 (]: Using duckdb connection "test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:13:02.194129 [debug] [Thread-1 (]: Compilation Error in test accepted_range_stg_orders_order_date___date_trunc_day_current_date_ (models\schema.yml)
  'current_date' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:13:02.196061 [debug] [Thread-2 (]: On test.pipeline_guardian.not_null_stg_orders_amount.2546645448: BEGIN
[0m13:13:02.198069 [debug] [Thread-4 (]: Using duckdb connection "test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a"
[0m13:13:02.200120 [debug] [Thread-3 (]: On test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m13:13:02.201674 [error] [Thread-1 (]: 1 of 4 ERROR accepted_range_stg_orders_order_date___date_trunc_day_current_date_  [[31mERROR[0m in 0.20s]
[0m13:13:02.203712 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:13:02.205680 [debug] [Thread-4 (]: On test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m13:13:02.207719 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:13:02.209721 [debug] [Thread-1 (]: Finished running node test.pipeline_guardian.accepted_range_stg_orders_order_date___date_trunc_day_current_date_.2cf9901bb0
[0m13:13:02.213341 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m13:13:02.214346 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:13:02.216299 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m13:13:02.218300 [debug] [Thread-7 (]: Marking all children of 'test.pipeline_guardian.accepted_range_stg_orders_order_date___date_trunc_day_current_date_.2cf9901bb0' to be skipped because of status 'error'.  Reason: Compilation Error in test accepted_range_stg_orders_order_date___date_trunc_day_current_date_ (models\schema.yml)
  'current_date' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:13:02.220336 [debug] [Thread-2 (]: Using duckdb connection "test.pipeline_guardian.not_null_stg_orders_amount.2546645448"
[0m13:13:02.222964 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m13:13:02.224943 [debug] [Thread-3 (]: Using duckdb connection "test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:13:02.228941 [debug] [Thread-2 (]: On test.pipeline_guardian.not_null_stg_orders_amount.2546645448: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "test.pipeline_guardian.not_null_stg_orders_amount.2546645448"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select amount
from "demo"."main"."stg_orders"
where amount is null



  
  
      
    ) dbt_internal_test
[0m13:13:02.231498 [debug] [Thread-4 (]: Using duckdb connection "test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a"
[0m13:13:02.232563 [debug] [Thread-3 (]: On test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "demo"."main"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m13:13:02.236519 [debug] [Thread-4 (]: On test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "demo"."main"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:13:02.238559 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "test.pipeline_guardian.not_null_stg_orders_amount.2546645448"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select amount
from "demo"."main"."stg_orders"
where amount is null



  
  
      
    ) dbt_internal_test
[0m13:13:02.241853 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "demo"."main"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m13:13:02.243917 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m13:13:02.244918 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "demo"."main"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:13:02.246920 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m13:13:02.248915 [debug] [Thread-2 (]: On test.pipeline_guardian.not_null_stg_orders_amount.2546645448: ROLLBACK
[0m13:13:02.249918 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m13:13:02.252482 [debug] [Thread-3 (]: On test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m13:13:02.255532 [debug] [Thread-4 (]: On test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m13:13:02.267179 [debug] [Thread-2 (]: Failed to rollback 'test.pipeline_guardian.not_null_stg_orders_amount.2546645448'
[0m13:13:02.270139 [debug] [Thread-3 (]: Failed to rollback 'test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64'
[0m13:13:02.272768 [debug] [Thread-4 (]: Failed to rollback 'test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a'
[0m13:13:02.275720 [debug] [Thread-2 (]: On test.pipeline_guardian.not_null_stg_orders_amount.2546645448: Close
[0m13:13:02.277701 [debug] [Thread-3 (]: On test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m13:13:02.279753 [debug] [Thread-4 (]: On test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a: Close
[0m13:13:02.288360 [debug] [Thread-2 (]: Runtime Error in test not_null_stg_orders_amount (models\schema.yml)
  Catalog Error: Table with name stg_orders does not exist!
  Did you mean "pg_catalog.pg_attrdef"?
  
  LINE 17: from "demo"."main"."stg_orders"
                ^
[0m13:13:02.292946 [debug] [Thread-4 (]: Runtime Error in test unique_stg_orders_order_id (models\schema.yml)
  Catalog Error: Table with name stg_orders does not exist!
  Did you mean "pg_catalog.pg_attrdef"?
  
  LINE 18: from "demo"."main"."stg_orders"
                ^
[0m13:13:02.290322 [error] [Thread-2 (]: 2 of 4 ERROR not_null_stg_orders_amount ........................................ [[31mERROR[0m in 0.29s]
[0m13:13:02.294956 [debug] [Thread-3 (]: Runtime Error in test not_null_stg_orders_order_id (models\schema.yml)
  Catalog Error: Table with name stg_orders does not exist!
  Did you mean "pg_catalog.pg_attrdef"?
  
  LINE 17: from "demo"."main"."stg_orders"
                ^
[0m13:13:02.296955 [error] [Thread-4 (]: 4 of 4 ERROR unique_stg_orders_order_id ........................................ [[31mERROR[0m in 0.29s]
[0m13:13:02.299959 [debug] [Thread-2 (]: Finished running node test.pipeline_guardian.not_null_stg_orders_amount.2546645448
[0m13:13:02.301517 [error] [Thread-3 (]: 3 of 4 ERROR not_null_stg_orders_order_id ...................................... [[31mERROR[0m in 0.30s]
[0m13:13:02.304533 [debug] [Thread-4 (]: Finished running node test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a
[0m13:13:02.307537 [debug] [Thread-7 (]: Marking all children of 'test.pipeline_guardian.not_null_stg_orders_amount.2546645448' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_orders_amount (models\schema.yml)
  Catalog Error: Table with name stg_orders does not exist!
  Did you mean "pg_catalog.pg_attrdef"?
  
  LINE 17: from "demo"."main"."stg_orders"
                ^.
[0m13:13:02.309580 [debug] [Thread-3 (]: Finished running node test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64
[0m13:13:02.313114 [debug] [Thread-7 (]: Marking all children of 'test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a' to be skipped because of status 'error'.  Reason: Runtime Error in test unique_stg_orders_order_id (models\schema.yml)
  Catalog Error: Table with name stg_orders does not exist!
  Did you mean "pg_catalog.pg_attrdef"?
  
  LINE 18: from "demo"."main"."stg_orders"
                ^.
[0m13:13:02.316489 [debug] [Thread-7 (]: Marking all children of 'test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_orders_order_id (models\schema.yml)
  Catalog Error: Table with name stg_orders does not exist!
  Did you mean "pg_catalog.pg_attrdef"?
  
  LINE 17: from "demo"."main"."stg_orders"
                ^.
[0m13:13:02.321500 [debug] [MainThread]: Using duckdb connection "master"
[0m13:13:02.323673 [debug] [MainThread]: On master: BEGIN
[0m13:13:02.324668 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:13:02.327624 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m13:13:02.329627 [debug] [MainThread]: On master: COMMIT
[0m13:13:02.331144 [debug] [MainThread]: Using duckdb connection "master"
[0m13:13:02.333250 [debug] [MainThread]: On master: COMMIT
[0m13:13:02.335165 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:13:02.337161 [debug] [MainThread]: On master: Close
[0m13:13:02.339166 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:13:02.340164 [debug] [MainThread]: Connection 'list_demo_main' was properly closed.
[0m13:13:02.341680 [debug] [MainThread]: Connection 'test.pipeline_guardian.accepted_range_stg_orders_order_date___date_trunc_day_current_date_.2cf9901bb0' was properly closed.
[0m13:13:02.342193 [debug] [MainThread]: Connection 'test.pipeline_guardian.not_null_stg_orders_amount.2546645448' was properly closed.
[0m13:13:02.344750 [debug] [MainThread]: Connection 'test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64' was properly closed.
[0m13:13:02.345845 [debug] [MainThread]: Connection 'test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m13:13:02.347900 [info ] [MainThread]: 
[0m13:13:02.349905 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 0.82 seconds (0.82s).
[0m13:13:02.353487 [debug] [MainThread]: Command end result
[0m13:13:02.419091 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\manifest.json
[0m13:13:02.428796 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\semantic_manifest.json
[0m13:13:02.456013 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\run_results.json
[0m13:13:02.458056 [info ] [MainThread]: 
[0m13:13:02.460013 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m13:13:02.461532 [info ] [MainThread]: 
[0m13:13:02.463579 [error] [MainThread]: [31mFailure in test accepted_range_stg_orders_order_date___date_trunc_day_current_date_ (models\schema.yml)[0m
[0m13:13:02.465550 [error] [MainThread]:   Compilation Error in test accepted_range_stg_orders_order_date___date_trunc_day_current_date_ (models\schema.yml)
  'current_date' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:13:02.467554 [info ] [MainThread]: 
[0m13:13:02.469592 [error] [MainThread]: [31mFailure in test not_null_stg_orders_amount (models\schema.yml)[0m
[0m13:13:02.472413 [error] [MainThread]:   Runtime Error in test not_null_stg_orders_amount (models\schema.yml)
  Catalog Error: Table with name stg_orders does not exist!
  Did you mean "pg_catalog.pg_attrdef"?
  
  LINE 17: from "demo"."main"."stg_orders"
                ^
[0m13:13:02.474430 [info ] [MainThread]: 
[0m13:13:02.476498 [info ] [MainThread]:   compiled code at target\compiled\pipeline_guardian\models\schema.yml\not_null_stg_orders_amount.sql
[0m13:13:02.478774 [info ] [MainThread]: 
[0m13:13:02.479792 [error] [MainThread]: [31mFailure in test unique_stg_orders_order_id (models\schema.yml)[0m
[0m13:13:02.483331 [error] [MainThread]:   Runtime Error in test unique_stg_orders_order_id (models\schema.yml)
  Catalog Error: Table with name stg_orders does not exist!
  Did you mean "pg_catalog.pg_attrdef"?
  
  LINE 18: from "demo"."main"."stg_orders"
                ^
[0m13:13:02.486357 [info ] [MainThread]: 
[0m13:13:02.489395 [info ] [MainThread]:   compiled code at target\compiled\pipeline_guardian\models\schema.yml\unique_stg_orders_order_id.sql
[0m13:13:02.490349 [info ] [MainThread]: 
[0m13:13:02.492612 [error] [MainThread]: [31mFailure in test not_null_stg_orders_order_id (models\schema.yml)[0m
[0m13:13:02.495609 [error] [MainThread]:   Runtime Error in test not_null_stg_orders_order_id (models\schema.yml)
  Catalog Error: Table with name stg_orders does not exist!
  Did you mean "pg_catalog.pg_attrdef"?
  
  LINE 17: from "demo"."main"."stg_orders"
                ^
[0m13:13:02.497610 [info ] [MainThread]: 
[0m13:13:02.499612 [info ] [MainThread]:   compiled code at target\compiled\pipeline_guardian\models\schema.yml\not_null_stg_orders_order_id.sql
[0m13:13:02.503153 [info ] [MainThread]: 
[0m13:13:02.505167 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 NO-OP=0 TOTAL=4
[0m13:13:02.509182 [debug] [MainThread]: Command `dbt test` failed at 13:13:02.508173 after 4.61 seconds
[0m13:13:02.511168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240B8A2E110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240B9D45E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240BC997760>]}
[0m13:13:02.512693 [debug] [MainThread]: Flushing usage events
[0m13:13:03.105265 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:13:20.648391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C6FCDE110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C71FC8D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C71FC8BB0>]}


============================== 13:13:20.657247 | 08bcdcd0-1723-4b78-b994-90bfe9ac1ea6 ==============================
[0m13:13:20.657247 [info ] [MainThread]: Running with dbt=1.10.9
[0m13:13:20.659106 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\likhi\\Downloads\\pipeline-guardian-v2-upload\\dbt', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt seed --full-refresh', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'log_cache_events': 'False', 'empty': 'None', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\likhi\\Downloads\\pipeline-guardian-v2-upload\\dbt\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m13:13:21.315231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08bcdcd0-1723-4b78-b994-90bfe9ac1ea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C710A4AF0>]}
[0m13:13:21.504797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08bcdcd0-1723-4b78-b994-90bfe9ac1ea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C71756500>]}
[0m13:13:21.515549 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m13:13:22.597993 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m13:13:23.248115 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:13:23.250127 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:13:23.461555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08bcdcd0-1723-4b78-b994-90bfe9ac1ea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C72644460>]}
[0m13:13:23.806916 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\manifest.json
[0m13:13:23.814848 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\semantic_manifest.json
[0m13:13:23.921426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08bcdcd0-1723-4b78-b994-90bfe9ac1ea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C725F2860>]}
[0m13:13:23.924078 [info ] [MainThread]: Found 2 models, 1 seed, 4 data tests, 1 source, 429 macros
[0m13:13:23.927059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08bcdcd0-1723-4b78-b994-90bfe9ac1ea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C72551180>]}
[0m13:13:23.932667 [info ] [MainThread]: 
[0m13:13:23.936658 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:13:23.938665 [info ] [MainThread]: 
[0m13:13:23.942280 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:13:23.947268 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_demo'
[0m13:13:24.397508 [debug] [ThreadPool]: Using duckdb connection "list_demo"
[0m13:13:24.400363 [debug] [ThreadPool]: On list_demo: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "connection_name": "list_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"demo"'
    
  
  
[0m13:13:24.401413 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:13:24.451555 [debug] [ThreadPool]: SQL status: OK in 0.049 seconds
[0m13:13:24.455626 [debug] [ThreadPool]: On list_demo: Close
[0m13:13:24.458571 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_demo, now create_demo_main)
[0m13:13:24.461213 [debug] [ThreadPool]: Creating schema "database: "demo"
schema: "main"
"
[0m13:13:24.480139 [debug] [ThreadPool]: Using duckdb connection "create_demo_main"
[0m13:13:24.481698 [debug] [ThreadPool]: On create_demo_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "connection_name": "create_demo_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='demo'
        and type='sqlite'
    
  
[0m13:13:24.483745 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:13:24.488305 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m13:13:24.494461 [debug] [ThreadPool]: Using duckdb connection "create_demo_main"
[0m13:13:24.496457 [debug] [ThreadPool]: On create_demo_main: BEGIN
[0m13:13:24.498417 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:13:24.499548 [debug] [ThreadPool]: Using duckdb connection "create_demo_main"
[0m13:13:24.501200 [debug] [ThreadPool]: On create_demo_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "connection_name": "create_demo_main"} */

    
    
        create schema if not exists "demo"."main"
    
[0m13:13:24.504694 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:13:24.508690 [debug] [ThreadPool]: On create_demo_main: COMMIT
[0m13:13:24.509691 [debug] [ThreadPool]: Using duckdb connection "create_demo_main"
[0m13:13:24.511269 [debug] [ThreadPool]: On create_demo_main: COMMIT
[0m13:13:24.513289 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:13:24.515333 [debug] [ThreadPool]: On create_demo_main: Close
[0m13:13:24.535732 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_demo_main'
[0m13:13:24.551191 [debug] [ThreadPool]: Using duckdb connection "list_demo_main"
[0m13:13:24.553271 [debug] [ThreadPool]: On list_demo_main: BEGIN
[0m13:13:24.554316 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:13:24.557243 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m13:13:24.558321 [debug] [ThreadPool]: Using duckdb connection "list_demo_main"
[0m13:13:24.560267 [debug] [ThreadPool]: On list_demo_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "connection_name": "list_demo_main"} */
select
      'demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'demo'
  
[0m13:13:24.596240 [debug] [ThreadPool]: SQL status: OK in 0.035 seconds
[0m13:13:24.601186 [debug] [ThreadPool]: On list_demo_main: ROLLBACK
[0m13:13:24.604588 [debug] [ThreadPool]: Failed to rollback 'list_demo_main'
[0m13:13:24.606271 [debug] [ThreadPool]: On list_demo_main: Close
[0m13:13:24.609535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08bcdcd0-1723-4b78-b994-90bfe9ac1ea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C725C2E30>]}
[0m13:13:24.611098 [debug] [MainThread]: Using duckdb connection "master"
[0m13:13:24.612841 [debug] [MainThread]: On master: BEGIN
[0m13:13:24.614567 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:13:24.618042 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m13:13:24.619830 [debug] [MainThread]: On master: COMMIT
[0m13:13:24.621386 [debug] [MainThread]: Using duckdb connection "master"
[0m13:13:24.623140 [debug] [MainThread]: On master: COMMIT
[0m13:13:24.625914 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:13:24.627922 [debug] [MainThread]: On master: Close
[0m13:13:24.644327 [debug] [Thread-1 (]: Began running node seed.pipeline_guardian.orders
[0m13:13:24.646287 [info ] [Thread-1 (]: 1 of 1 START seed file main.orders ............................................. [RUN]
[0m13:13:24.649334 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.pipeline_guardian.orders'
[0m13:13:24.651327 [debug] [Thread-1 (]: Began compiling node seed.pipeline_guardian.orders
[0m13:13:24.652941 [debug] [Thread-1 (]: Began executing node seed.pipeline_guardian.orders
[0m13:13:24.729860 [debug] [Thread-1 (]: Using duckdb connection "seed.pipeline_guardian.orders"
[0m13:13:24.732500 [debug] [Thread-1 (]: On seed.pipeline_guardian.orders: BEGIN
[0m13:13:24.735498 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:13:24.738454 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:13:24.740458 [debug] [Thread-1 (]: Using duckdb connection "seed.pipeline_guardian.orders"
[0m13:13:24.741968 [debug] [Thread-1 (]: On seed.pipeline_guardian.orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "seed.pipeline_guardian.orders"} */

    create table "demo"."main"."orders" ("order_id" integer,"customer_id" text,"amount" float8,"order_date" date)
  
[0m13:13:24.746029 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:13:24.777671 [debug] [Thread-1 (]: Using duckdb connection "seed.pipeline_guardian.orders"
[0m13:13:24.779675 [debug] [Thread-1 (]: On seed.pipeline_guardian.orders: 
          COPY "demo"."main"."orders" FROM 'dbt\seeds\orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m13:13:24.784342 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: 
          COPY "demo"."main"."orders" FROM 'dbt\seeds\orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        
[0m13:13:24.787379 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:13:24.789376 [debug] [Thread-1 (]: On seed.pipeline_guardian.orders: ROLLBACK
[0m13:13:24.804810 [debug] [Thread-1 (]: Failed to rollback 'seed.pipeline_guardian.orders'
[0m13:13:24.806809 [debug] [Thread-1 (]: On seed.pipeline_guardian.orders: Close
[0m13:13:24.812456 [debug] [Thread-1 (]: Runtime Error in seed orders (seeds\orders.csv)
  IO Error: No files found that match the pattern "dbt\seeds\orders.csv"
[0m13:13:24.821170 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08bcdcd0-1723-4b78-b994-90bfe9ac1ea6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C72679150>]}
[0m13:13:24.823724 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file main.orders ..................................... [[31mERROR[0m in 0.17s]
[0m13:13:24.826719 [debug] [Thread-1 (]: Finished running node seed.pipeline_guardian.orders
[0m13:13:24.828757 [debug] [Thread-7 (]: Marking all children of 'seed.pipeline_guardian.orders' to be skipped because of status 'error'.  Reason: Runtime Error in seed orders (seeds\orders.csv)
  IO Error: No files found that match the pattern "dbt\seeds\orders.csv".
[0m13:13:24.835646 [debug] [MainThread]: Using duckdb connection "master"
[0m13:13:24.838652 [debug] [MainThread]: On master: BEGIN
[0m13:13:24.839656 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:13:24.843262 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m13:13:24.845207 [debug] [MainThread]: On master: COMMIT
[0m13:13:24.846203 [debug] [MainThread]: Using duckdb connection "master"
[0m13:13:24.848204 [debug] [MainThread]: On master: COMMIT
[0m13:13:24.850213 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:13:24.851722 [debug] [MainThread]: On master: Close
[0m13:13:24.853761 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:13:24.854809 [debug] [MainThread]: Connection 'create_demo_main' was properly closed.
[0m13:13:24.856808 [debug] [MainThread]: Connection 'list_demo_main' was properly closed.
[0m13:13:24.858763 [debug] [MainThread]: Connection 'seed.pipeline_guardian.orders' was properly closed.
[0m13:13:24.861329 [info ] [MainThread]: 
[0m13:13:24.863349 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.92 seconds (0.92s).
[0m13:13:24.867364 [debug] [MainThread]: Command end result
[0m13:13:24.929792 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\manifest.json
[0m13:13:24.938746 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\semantic_manifest.json
[0m13:13:24.961556 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\run_results.json
[0m13:13:24.963311 [info ] [MainThread]: 
[0m13:13:24.966565 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:13:24.968179 [info ] [MainThread]: 
[0m13:13:24.970901 [error] [MainThread]: [31mFailure in seed orders (seeds\orders.csv)[0m
[0m13:13:24.972456 [error] [MainThread]:   Runtime Error in seed orders (seeds\orders.csv)
  IO Error: No files found that match the pattern "dbt\seeds\orders.csv"
[0m13:13:24.974741 [info ] [MainThread]: 
[0m13:13:24.976739 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m13:13:24.981263 [debug] [MainThread]: Command `dbt seed` failed at 13:13:24.979746 after 4.61 seconds
[0m13:13:24.984307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C6FCDE110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C6FAEA350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C71DEB730>]}
[0m13:13:24.986307 [debug] [MainThread]: Flushing usage events
[0m13:13:25.435556 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:19:25.235283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CA521A0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CA7508D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CA7508B20>]}


============================== 13:19:25.243941 | 072d4b4d-6189-4c27-b341-2b6eb403dd75 ==============================
[0m13:19:25.243941 [info ] [MainThread]: Running with dbt=1.10.9
[0m13:19:25.245950 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt seed --full-refresh', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\likhi\\Downloads\\pipeline-guardian-v2-upload\\dbt\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\likhi\\Downloads\\pipeline-guardian-v2-upload\\dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True'}
[0m13:19:25.925528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '072d4b4d-6189-4c27-b341-2b6eb403dd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CA37A80D0>]}
[0m13:19:26.137139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '072d4b4d-6189-4c27-b341-2b6eb403dd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CA758E1D0>]}
[0m13:19:26.149609 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m13:19:27.359217 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m13:19:28.028602 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:19:28.031358 [debug] [MainThread]: Partial parsing: updated file: pipeline_guardian://seeds\orders.csv
[0m13:19:28.909730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '072d4b4d-6189-4c27-b341-2b6eb403dd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CA7AA0D90>]}
[0m13:19:29.251646 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\manifest.json
[0m13:19:29.260386 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\semantic_manifest.json
[0m13:19:29.356983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '072d4b4d-6189-4c27-b341-2b6eb403dd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CA7B47AF0>]}
[0m13:19:29.359595 [info ] [MainThread]: Found 2 models, 4 data tests, 1 seed, 1 source, 429 macros
[0m13:19:29.361595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '072d4b4d-6189-4c27-b341-2b6eb403dd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CA775B310>]}
[0m13:19:29.366584 [info ] [MainThread]: 
[0m13:19:29.368584 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:19:29.371697 [info ] [MainThread]: 
[0m13:19:29.375709 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:19:29.381727 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_demo'
[0m13:19:29.701166 [debug] [ThreadPool]: Using duckdb connection "list_demo"
[0m13:19:29.703181 [debug] [ThreadPool]: On list_demo: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "connection_name": "list_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"demo"'
    
  
  
[0m13:19:29.705129 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:19:29.752934 [debug] [ThreadPool]: SQL status: OK in 0.048 seconds
[0m13:19:29.756913 [debug] [ThreadPool]: On list_demo: Close
[0m13:19:29.759934 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_demo, now create_demo_main)
[0m13:19:29.763330 [debug] [ThreadPool]: Creating schema "database: "demo"
schema: "main"
"
[0m13:19:29.785506 [debug] [ThreadPool]: Using duckdb connection "create_demo_main"
[0m13:19:29.788452 [debug] [ThreadPool]: On create_demo_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "connection_name": "create_demo_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='demo'
        and type='sqlite'
    
  
[0m13:19:29.791011 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:19:29.795015 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m13:19:29.799574 [debug] [ThreadPool]: Using duckdb connection "create_demo_main"
[0m13:19:29.801589 [debug] [ThreadPool]: On create_demo_main: BEGIN
[0m13:19:29.803596 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:19:29.805628 [debug] [ThreadPool]: Using duckdb connection "create_demo_main"
[0m13:19:29.807593 [debug] [ThreadPool]: On create_demo_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "connection_name": "create_demo_main"} */

    
    
        create schema if not exists "demo"."main"
    
[0m13:19:29.810193 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:19:29.813180 [debug] [ThreadPool]: On create_demo_main: COMMIT
[0m13:19:29.815187 [debug] [ThreadPool]: Using duckdb connection "create_demo_main"
[0m13:19:29.816189 [debug] [ThreadPool]: On create_demo_main: COMMIT
[0m13:19:29.818705 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:19:29.820887 [debug] [ThreadPool]: On create_demo_main: Close
[0m13:19:29.839716 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_demo_main'
[0m13:19:29.858302 [debug] [ThreadPool]: Using duckdb connection "list_demo_main"
[0m13:19:29.859845 [debug] [ThreadPool]: On list_demo_main: BEGIN
[0m13:19:29.861876 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:19:29.864873 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m13:19:29.867346 [debug] [ThreadPool]: Using duckdb connection "list_demo_main"
[0m13:19:29.869398 [debug] [ThreadPool]: On list_demo_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "connection_name": "list_demo_main"} */
select
      'demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'demo'
  
[0m13:19:29.907095 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m13:19:29.912069 [debug] [ThreadPool]: On list_demo_main: ROLLBACK
[0m13:19:29.917066 [debug] [ThreadPool]: Failed to rollback 'list_demo_main'
[0m13:19:29.918583 [debug] [ThreadPool]: On list_demo_main: Close
[0m13:19:29.921623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '072d4b4d-6189-4c27-b341-2b6eb403dd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CA75BB940>]}
[0m13:19:29.924621 [debug] [MainThread]: Using duckdb connection "master"
[0m13:19:29.926616 [debug] [MainThread]: On master: BEGIN
[0m13:19:29.927130 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:19:29.930694 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m13:19:29.932713 [debug] [MainThread]: On master: COMMIT
[0m13:19:29.934713 [debug] [MainThread]: Using duckdb connection "master"
[0m13:19:29.936713 [debug] [MainThread]: On master: COMMIT
[0m13:19:29.938718 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:19:29.941183 [debug] [MainThread]: On master: Close
[0m13:19:29.954855 [debug] [Thread-1 (]: Began running node seed.pipeline_guardian.orders
[0m13:19:29.956864 [info ] [Thread-1 (]: 1 of 1 START seed file main.orders ............................................. [RUN]
[0m13:19:29.959401 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.pipeline_guardian.orders'
[0m13:19:29.961411 [debug] [Thread-1 (]: Began compiling node seed.pipeline_guardian.orders
[0m13:19:29.963633 [debug] [Thread-1 (]: Began executing node seed.pipeline_guardian.orders
[0m13:19:30.038717 [debug] [Thread-1 (]: Using duckdb connection "seed.pipeline_guardian.orders"
[0m13:19:30.040806 [debug] [Thread-1 (]: On seed.pipeline_guardian.orders: BEGIN
[0m13:19:30.042794 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:19:30.044790 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:19:30.046871 [debug] [Thread-1 (]: Using duckdb connection "seed.pipeline_guardian.orders"
[0m13:19:30.048522 [debug] [Thread-1 (]: On seed.pipeline_guardian.orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "seed.pipeline_guardian.orders"} */

    create table "demo"."main"."orders" ("order_id" integer,"customer_id" text,"amount" float8,"order_date" date)
  
[0m13:19:30.051671 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:19:30.082077 [debug] [Thread-1 (]: Using duckdb connection "seed.pipeline_guardian.orders"
[0m13:19:30.085083 [debug] [Thread-1 (]: On seed.pipeline_guardian.orders: 
          COPY "demo"."main"."orders" FROM 'C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\seeds\orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m13:19:30.100678 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m13:19:30.118469 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.pipeline_guardian.orders"
[0m13:19:30.159042 [debug] [Thread-1 (]: On seed.pipeline_guardian.orders: COMMIT
[0m13:19:30.162143 [debug] [Thread-1 (]: Using duckdb connection "seed.pipeline_guardian.orders"
[0m13:19:30.164168 [debug] [Thread-1 (]: On seed.pipeline_guardian.orders: COMMIT
[0m13:19:30.212230 [debug] [Thread-1 (]: SQL status: OK in 0.046 seconds
[0m13:19:30.219749 [debug] [Thread-1 (]: On seed.pipeline_guardian.orders: Close
[0m13:19:30.226773 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '072d4b4d-6189-4c27-b341-2b6eb403dd75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CA7B615A0>]}
[0m13:19:30.229563 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file main.orders ......................................... [[32mCREATE 12[0m in 0.26s]
[0m13:19:30.232583 [debug] [Thread-1 (]: Finished running node seed.pipeline_guardian.orders
[0m13:19:30.236583 [debug] [MainThread]: Using duckdb connection "master"
[0m13:19:30.238582 [debug] [MainThread]: On master: BEGIN
[0m13:19:30.240382 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:19:30.244447 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m13:19:30.245458 [debug] [MainThread]: On master: COMMIT
[0m13:19:30.247425 [debug] [MainThread]: Using duckdb connection "master"
[0m13:19:30.249941 [debug] [MainThread]: On master: COMMIT
[0m13:19:30.251960 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:19:30.253958 [debug] [MainThread]: On master: Close
[0m13:19:30.256961 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:19:30.259503 [debug] [MainThread]: Connection 'create_demo_main' was properly closed.
[0m13:19:30.261502 [debug] [MainThread]: Connection 'list_demo_main' was properly closed.
[0m13:19:30.264027 [debug] [MainThread]: Connection 'seed.pipeline_guardian.orders' was properly closed.
[0m13:19:30.266029 [info ] [MainThread]: 
[0m13:19:30.267079 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 0.89 seconds (0.89s).
[0m13:19:30.270689 [debug] [MainThread]: Command end result
[0m13:19:30.332308 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\manifest.json
[0m13:19:30.341708 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\semantic_manifest.json
[0m13:19:30.362920 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\run_results.json
[0m13:19:30.364875 [info ] [MainThread]: 
[0m13:19:30.368338 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:19:30.369908 [info ] [MainThread]: 
[0m13:19:30.372917 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:19:30.375993 [debug] [MainThread]: Command `dbt seed` succeeded at 13:19:30.375993 after 5.39 seconds
[0m13:19:30.378562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CA521A0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CA75BB760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CA6535D20>]}
[0m13:19:30.379579 [debug] [MainThread]: Flushing usage events
[0m13:19:30.797211 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:19:49.392557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB67816080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB69A84C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB69A84A60>]}


============================== 13:19:49.401430 | 29bc278a-5fb4-49c2-91c7-af92fe91949d ==============================
[0m13:19:49.401430 [info ] [MainThread]: Running with dbt=1.10.9
[0m13:19:49.403585 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'quiet': 'False', 'empty': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\likhi\\Downloads\\pipeline-guardian-v2-upload\\dbt\\logs', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': 'C:\\Users\\likhi\\Downloads\\pipeline-guardian-v2-upload\\dbt'}
[0m13:19:50.105751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29bc278a-5fb4-49c2-91c7-af92fe91949d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB68AE3EB0>]}
[0m13:19:50.334639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29bc278a-5fb4-49c2-91c7-af92fe91949d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB699D25F0>]}
[0m13:19:50.342764 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m13:19:51.562033 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m13:19:52.250309 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:19:52.252313 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:19:52.464240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29bc278a-5fb4-49c2-91c7-af92fe91949d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB6A100430>]}
[0m13:19:52.858556 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\manifest.json
[0m13:19:52.867021 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\semantic_manifest.json
[0m13:19:52.973672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29bc278a-5fb4-49c2-91c7-af92fe91949d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB69CB99C0>]}
[0m13:19:52.975678 [info ] [MainThread]: Found 2 models, 4 data tests, 1 seed, 1 source, 429 macros
[0m13:19:52.977675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29bc278a-5fb4-49c2-91c7-af92fe91949d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB6A081840>]}
[0m13:19:52.983847 [info ] [MainThread]: 
[0m13:19:52.986844 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:19:52.989373 [info ] [MainThread]: 
[0m13:19:52.991378 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:19:53.018303 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_demo'
[0m13:19:53.439285 [debug] [ThreadPool]: Using duckdb connection "list_demo"
[0m13:19:53.441399 [debug] [ThreadPool]: On list_demo: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "connection_name": "list_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"demo"'
    
  
  
[0m13:19:53.442404 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:19:53.511599 [debug] [ThreadPool]: SQL status: OK in 0.069 seconds
[0m13:19:53.516614 [debug] [ThreadPool]: On list_demo: Close
[0m13:19:53.519280 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_demo, now create_demo_main)
[0m13:19:53.522391 [debug] [ThreadPool]: Creating schema "database: "demo"
schema: "main"
"
[0m13:19:53.541888 [debug] [ThreadPool]: Using duckdb connection "create_demo_main"
[0m13:19:53.542892 [debug] [ThreadPool]: On create_demo_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "connection_name": "create_demo_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='demo'
        and type='sqlite'
    
  
[0m13:19:53.544880 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:19:53.546879 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m13:19:53.551635 [debug] [ThreadPool]: Using duckdb connection "create_demo_main"
[0m13:19:53.553630 [debug] [ThreadPool]: On create_demo_main: BEGIN
[0m13:19:53.555639 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:19:53.557632 [debug] [ThreadPool]: Using duckdb connection "create_demo_main"
[0m13:19:53.559251 [debug] [ThreadPool]: On create_demo_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "connection_name": "create_demo_main"} */

    
    
        create schema if not exists "demo"."main"
    
[0m13:19:53.561362 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:19:53.564358 [debug] [ThreadPool]: On create_demo_main: COMMIT
[0m13:19:53.566365 [debug] [ThreadPool]: Using duckdb connection "create_demo_main"
[0m13:19:53.567360 [debug] [ThreadPool]: On create_demo_main: COMMIT
[0m13:19:53.570098 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:19:53.572105 [debug] [ThreadPool]: On create_demo_main: Close
[0m13:19:53.576091 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_demo_main'
[0m13:19:53.594584 [debug] [ThreadPool]: Using duckdb connection "list_demo_main"
[0m13:19:53.596579 [debug] [ThreadPool]: On list_demo_main: BEGIN
[0m13:19:53.599239 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:19:53.601355 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m13:19:53.603363 [debug] [ThreadPool]: Using duckdb connection "list_demo_main"
[0m13:19:53.605273 [debug] [ThreadPool]: On list_demo_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "connection_name": "list_demo_main"} */
select
      'demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'demo'
  
[0m13:19:53.639915 [debug] [ThreadPool]: SQL status: OK in 0.032 seconds
[0m13:19:53.643911 [debug] [ThreadPool]: On list_demo_main: ROLLBACK
[0m13:19:53.646913 [debug] [ThreadPool]: Failed to rollback 'list_demo_main'
[0m13:19:53.648433 [debug] [ThreadPool]: On list_demo_main: Close
[0m13:19:53.652448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29bc278a-5fb4-49c2-91c7-af92fe91949d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB6A008940>]}
[0m13:19:53.653451 [debug] [MainThread]: Using duckdb connection "master"
[0m13:19:53.655563 [debug] [MainThread]: On master: BEGIN
[0m13:19:53.657553 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:19:53.659810 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m13:19:53.661877 [debug] [MainThread]: On master: COMMIT
[0m13:19:53.662803 [debug] [MainThread]: Using duckdb connection "master"
[0m13:19:53.664912 [debug] [MainThread]: On master: COMMIT
[0m13:19:53.666856 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:19:53.668473 [debug] [MainThread]: On master: Close
[0m13:19:53.685139 [debug] [Thread-1 (]: Began running node model.pipeline_guardian.stg_orders
[0m13:19:53.687022 [info ] [Thread-1 (]: 1 of 2 START sql table model main.stg_orders ................................... [RUN]
[0m13:19:53.689653 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.pipeline_guardian.stg_orders'
[0m13:19:53.691654 [debug] [Thread-1 (]: Began compiling node model.pipeline_guardian.stg_orders
[0m13:19:53.715040 [debug] [Thread-1 (]: Writing injected SQL for node "model.pipeline_guardian.stg_orders"
[0m13:19:53.718664 [debug] [Thread-1 (]: Began executing node model.pipeline_guardian.stg_orders
[0m13:19:53.809103 [debug] [Thread-1 (]: Writing runtime sql for node "model.pipeline_guardian.stg_orders"
[0m13:19:53.814207 [debug] [Thread-1 (]: Using duckdb connection "model.pipeline_guardian.stg_orders"
[0m13:19:53.816220 [debug] [Thread-1 (]: On model.pipeline_guardian.stg_orders: BEGIN
[0m13:19:53.817217 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:19:53.820919 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:19:53.822918 [debug] [Thread-1 (]: Using duckdb connection "model.pipeline_guardian.stg_orders"
[0m13:19:53.824850 [debug] [Thread-1 (]: On model.pipeline_guardian.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "model.pipeline_guardian.stg_orders"} */

  
    
    

    create  table
      "demo"."main"."stg_orders__dbt_tmp"
  
    as (
      with source as (
    select * from "demo"."main"."orders"
),

-- PATCH_AREA_START
-- naive logic (will fail tests)
patched as (
    select
        order_id,
        customer_id,
        cast(amount as double) as amount,
        cast(order_date as date) as order_date
    from source
)
-- PATCH_AREA_END

select * from patched
    );
  
  
[0m13:19:53.829578 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:19:53.847310 [debug] [Thread-1 (]: Using duckdb connection "model.pipeline_guardian.stg_orders"
[0m13:19:53.852001 [debug] [Thread-1 (]: On model.pipeline_guardian.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "model.pipeline_guardian.stg_orders"} */
alter table "demo"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m13:19:53.855005 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:19:53.893897 [debug] [Thread-1 (]: On model.pipeline_guardian.stg_orders: COMMIT
[0m13:19:53.896907 [debug] [Thread-1 (]: Using duckdb connection "model.pipeline_guardian.stg_orders"
[0m13:19:53.898418 [debug] [Thread-1 (]: On model.pipeline_guardian.stg_orders: COMMIT
[0m13:19:53.947749 [debug] [Thread-1 (]: SQL status: OK in 0.046 seconds
[0m13:19:53.965147 [debug] [Thread-1 (]: Using duckdb connection "model.pipeline_guardian.stg_orders"
[0m13:19:53.967151 [debug] [Thread-1 (]: On model.pipeline_guardian.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "model.pipeline_guardian.stg_orders"} */

      drop table if exists "demo"."main"."stg_orders__dbt_backup" cascade
    
[0m13:19:53.970899 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:19:53.979540 [debug] [Thread-1 (]: On model.pipeline_guardian.stg_orders: Close
[0m13:19:53.989104 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29bc278a-5fb4-49c2-91c7-af92fe91949d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB69A44B20>]}
[0m13:19:53.992215 [info ] [Thread-1 (]: 1 of 2 OK created sql table model main.stg_orders .............................. [[32mOK[0m in 0.29s]
[0m13:19:53.995202 [debug] [Thread-1 (]: Finished running node model.pipeline_guardian.stg_orders
[0m13:19:53.998620 [debug] [Thread-3 (]: Began running node model.pipeline_guardian.orders_summary
[0m13:19:54.000637 [info ] [Thread-3 (]: 2 of 2 START sql table model main.orders_summary ............................... [RUN]
[0m13:19:54.003653 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.pipeline_guardian.orders_summary'
[0m13:19:54.005657 [debug] [Thread-3 (]: Began compiling node model.pipeline_guardian.orders_summary
[0m13:19:54.016196 [debug] [Thread-3 (]: Writing injected SQL for node "model.pipeline_guardian.orders_summary"
[0m13:19:54.020739 [debug] [Thread-3 (]: Began executing node model.pipeline_guardian.orders_summary
[0m13:19:54.031257 [debug] [Thread-3 (]: Writing runtime sql for node "model.pipeline_guardian.orders_summary"
[0m13:19:54.036364 [debug] [Thread-3 (]: Using duckdb connection "model.pipeline_guardian.orders_summary"
[0m13:19:54.038841 [debug] [Thread-3 (]: On model.pipeline_guardian.orders_summary: BEGIN
[0m13:19:54.041960 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:19:54.044858 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m13:19:54.046963 [debug] [Thread-3 (]: Using duckdb connection "model.pipeline_guardian.orders_summary"
[0m13:19:54.048573 [debug] [Thread-3 (]: On model.pipeline_guardian.orders_summary: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "model.pipeline_guardian.orders_summary"} */

  
    
    

    create  table
      "demo"."main"."orders_summary__dbt_tmp"
  
    as (
      select count(*) total_orders, sum(amount) total_revenue
from "demo"."main"."stg_orders"
    );
  
  
[0m13:19:54.053056 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m13:19:54.061920 [debug] [Thread-3 (]: Using duckdb connection "model.pipeline_guardian.orders_summary"
[0m13:19:54.064865 [debug] [Thread-3 (]: On model.pipeline_guardian.orders_summary: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "model.pipeline_guardian.orders_summary"} */
alter table "demo"."main"."orders_summary__dbt_tmp" rename to "orders_summary"
[0m13:19:54.066912 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:19:54.072515 [debug] [Thread-3 (]: On model.pipeline_guardian.orders_summary: COMMIT
[0m13:19:54.074505 [debug] [Thread-3 (]: Using duckdb connection "model.pipeline_guardian.orders_summary"
[0m13:19:54.076519 [debug] [Thread-3 (]: On model.pipeline_guardian.orders_summary: COMMIT
[0m13:19:54.120912 [debug] [Thread-3 (]: SQL status: OK in 0.043 seconds
[0m13:19:54.131763 [debug] [Thread-3 (]: Using duckdb connection "model.pipeline_guardian.orders_summary"
[0m13:19:54.134766 [debug] [Thread-3 (]: On model.pipeline_guardian.orders_summary: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "model.pipeline_guardian.orders_summary"} */

      drop table if exists "demo"."main"."orders_summary__dbt_backup" cascade
    
[0m13:19:54.137764 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:19:54.142415 [debug] [Thread-3 (]: On model.pipeline_guardian.orders_summary: Close
[0m13:19:54.144416 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29bc278a-5fb4-49c2-91c7-af92fe91949d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB6B5E9180>]}
[0m13:19:54.147418 [info ] [Thread-3 (]: 2 of 2 OK created sql table model main.orders_summary .......................... [[32mOK[0m in 0.14s]
[0m13:19:54.149024 [debug] [Thread-3 (]: Finished running node model.pipeline_guardian.orders_summary
[0m13:19:54.153124 [debug] [MainThread]: Using duckdb connection "master"
[0m13:19:54.155125 [debug] [MainThread]: On master: BEGIN
[0m13:19:54.156127 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:19:54.158741 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m13:19:54.160887 [debug] [MainThread]: On master: COMMIT
[0m13:19:54.162858 [debug] [MainThread]: Using duckdb connection "master"
[0m13:19:54.166880 [debug] [MainThread]: On master: COMMIT
[0m13:19:54.168489 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:19:54.170223 [debug] [MainThread]: On master: Close
[0m13:19:54.172341 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:19:54.174332 [debug] [MainThread]: Connection 'create_demo_main' was properly closed.
[0m13:19:54.176223 [debug] [MainThread]: Connection 'list_demo_main' was properly closed.
[0m13:19:54.177224 [debug] [MainThread]: Connection 'model.pipeline_guardian.stg_orders' was properly closed.
[0m13:19:54.179760 [debug] [MainThread]: Connection 'model.pipeline_guardian.orders_summary' was properly closed.
[0m13:19:54.181752 [info ] [MainThread]: 
[0m13:19:54.183751 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 1.19 seconds (1.19s).
[0m13:19:54.186750 [debug] [MainThread]: Command end result
[0m13:19:54.247726 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\manifest.json
[0m13:19:54.257447 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\semantic_manifest.json
[0m13:19:54.302566 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\run_results.json
[0m13:19:54.304635 [info ] [MainThread]: 
[0m13:19:54.307570 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:19:54.312118 [info ] [MainThread]: 
[0m13:19:54.314124 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m13:19:54.318639 [debug] [MainThread]: Command `dbt run` succeeded at 13:19:54.317125 after 5.18 seconds
[0m13:19:54.321656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB67816080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB65D24040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BB69D166E0>]}
[0m13:19:54.322657 [debug] [MainThread]: Flushing usage events
[0m13:19:54.871813 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:20:05.612837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024924AEE110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024926DD8EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024926DD8CD0>]}


============================== 13:20:05.625357 | 504e418e-6800-4386-8f17-c19ce6b5f907 ==============================
[0m13:20:05.625357 [info ] [MainThread]: Running with dbt=1.10.9
[0m13:20:05.627305 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'printer_width': '80', 'empty': 'None', 'quiet': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\likhi\\Downloads\\pipeline-guardian-v2-upload\\dbt\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': 'C:\\Users\\likhi\\Downloads\\pipeline-guardian-v2-upload\\dbt'}
[0m13:20:06.468751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '504e418e-6800-4386-8f17-c19ce6b5f907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024925EB4AF0>]}
[0m13:20:06.674250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '504e418e-6800-4386-8f17-c19ce6b5f907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249265A71F0>]}
[0m13:20:06.683527 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m13:20:07.900717 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m13:20:08.558993 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:20:08.561000 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:20:08.771035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '504e418e-6800-4386-8f17-c19ce6b5f907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249274545E0>]}
[0m13:20:09.198635 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\manifest.json
[0m13:20:09.208819 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\semantic_manifest.json
[0m13:20:09.445960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '504e418e-6800-4386-8f17-c19ce6b5f907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249272452A0>]}
[0m13:20:09.448495 [info ] [MainThread]: Found 2 models, 4 data tests, 1 seed, 1 source, 429 macros
[0m13:20:09.450514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '504e418e-6800-4386-8f17-c19ce6b5f907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249272458A0>]}
[0m13:20:09.459158 [info ] [MainThread]: 
[0m13:20:09.462161 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:20:09.463690 [info ] [MainThread]: 
[0m13:20:09.466688 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:20:09.493346 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_demo_main'
[0m13:20:09.822696 [debug] [ThreadPool]: Using duckdb connection "list_demo_main"
[0m13:20:09.823682 [debug] [ThreadPool]: On list_demo_main: BEGIN
[0m13:20:09.825681 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:20:09.895514 [debug] [ThreadPool]: SQL status: OK in 0.069 seconds
[0m13:20:09.897578 [debug] [ThreadPool]: Using duckdb connection "list_demo_main"
[0m13:20:09.898631 [debug] [ThreadPool]: On list_demo_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "connection_name": "list_demo_main"} */
select
      'demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'demo'
  
[0m13:20:09.936718 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m13:20:09.942309 [debug] [ThreadPool]: On list_demo_main: ROLLBACK
[0m13:20:09.946424 [debug] [ThreadPool]: Failed to rollback 'list_demo_main'
[0m13:20:09.948826 [debug] [ThreadPool]: On list_demo_main: Close
[0m13:20:09.952839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '504e418e-6800-4386-8f17-c19ce6b5f907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249272452A0>]}
[0m13:20:09.954840 [debug] [MainThread]: Using duckdb connection "master"
[0m13:20:09.956839 [debug] [MainThread]: On master: BEGIN
[0m13:20:09.958351 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:20:09.961476 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m13:20:09.963364 [debug] [MainThread]: On master: COMMIT
[0m13:20:09.965362 [debug] [MainThread]: Using duckdb connection "master"
[0m13:20:09.967471 [debug] [MainThread]: On master: COMMIT
[0m13:20:09.971769 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:20:09.973664 [debug] [MainThread]: On master: Close
[0m13:20:09.990466 [debug] [Thread-1 (]: Began running node test.pipeline_guardian.accepted_range_stg_orders_order_date___date_trunc_day_current_date_.2cf9901bb0
[0m13:20:09.992363 [debug] [Thread-2 (]: Began running node test.pipeline_guardian.not_null_stg_orders_amount.2546645448
[0m13:20:09.993344 [debug] [Thread-3 (]: Began running node test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64
[0m13:20:09.995413 [info ] [Thread-1 (]: 1 of 4 START test accepted_range_stg_orders_order_date___date_trunc_day_current_date_  [RUN]
[0m13:20:09.997344 [debug] [Thread-4 (]: Began running node test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a
[0m13:20:10.000156 [info ] [Thread-2 (]: 2 of 4 START test not_null_stg_orders_amount ................................... [RUN]
[0m13:20:10.002103 [info ] [Thread-3 (]: 3 of 4 START test not_null_stg_orders_order_id ................................. [RUN]
[0m13:20:10.005100 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.pipeline_guardian.accepted_range_stg_orders_order_date___date_trunc_day_current_date_.2cf9901bb0'
[0m13:20:10.007099 [info ] [Thread-4 (]: 4 of 4 START test unique_stg_orders_order_id ................................... [RUN]
[0m13:20:10.009634 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.pipeline_guardian.not_null_stg_orders_amount.2546645448'
[0m13:20:10.012639 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64'
[0m13:20:10.014618 [debug] [Thread-1 (]: Began compiling node test.pipeline_guardian.accepted_range_stg_orders_order_date___date_trunc_day_current_date_.2cf9901bb0
[0m13:20:10.017729 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a'
[0m13:20:10.019324 [debug] [Thread-2 (]: Began compiling node test.pipeline_guardian.not_null_stg_orders_amount.2546645448
[0m13:20:10.022527 [debug] [Thread-3 (]: Began compiling node test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64
[0m13:20:10.048713 [debug] [Thread-4 (]: Began compiling node test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a
[0m13:20:10.086934 [debug] [Thread-2 (]: Writing injected SQL for node "test.pipeline_guardian.not_null_stg_orders_amount.2546645448"
[0m13:20:10.100168 [debug] [Thread-3 (]: Writing injected SQL for node "test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:20:10.119511 [debug] [Thread-4 (]: Writing injected SQL for node "test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a"
[0m13:20:10.124575 [debug] [Thread-2 (]: Began executing node test.pipeline_guardian.not_null_stg_orders_amount.2546645448
[0m13:20:10.128509 [debug] [Thread-3 (]: Began executing node test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64
[0m13:20:10.180658 [debug] [Thread-2 (]: Writing runtime sql for node "test.pipeline_guardian.not_null_stg_orders_amount.2546645448"
[0m13:20:10.183265 [debug] [Thread-4 (]: Began executing node test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a
[0m13:20:10.191815 [debug] [Thread-3 (]: Writing runtime sql for node "test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:20:10.199442 [debug] [Thread-2 (]: Using duckdb connection "test.pipeline_guardian.not_null_stg_orders_amount.2546645448"
[0m13:20:10.207553 [debug] [Thread-4 (]: Writing runtime sql for node "test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a"
[0m13:20:10.210315 [debug] [Thread-1 (]: Compilation Error in test accepted_range_stg_orders_order_date___date_trunc_day_current_date_ (models\schema.yml)
  'current_date' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:20:10.214193 [debug] [Thread-2 (]: On test.pipeline_guardian.not_null_stg_orders_amount.2546645448: BEGIN
[0m13:20:10.216291 [debug] [Thread-3 (]: Using duckdb connection "test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:20:10.218695 [error] [Thread-1 (]: 1 of 4 ERROR accepted_range_stg_orders_order_date___date_trunc_day_current_date_  [[31mERROR[0m in 0.21s]
[0m13:20:10.221716 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:20:10.223713 [debug] [Thread-4 (]: Using duckdb connection "test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a"
[0m13:20:10.226784 [debug] [Thread-3 (]: On test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m13:20:10.230052 [debug] [Thread-1 (]: Finished running node test.pipeline_guardian.accepted_range_stg_orders_order_date___date_trunc_day_current_date_.2cf9901bb0
[0m13:20:10.234173 [debug] [Thread-2 (]: SQL status: OK in 0.012 seconds
[0m13:20:10.236064 [debug] [Thread-4 (]: On test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m13:20:10.238695 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:20:10.242722 [debug] [Thread-7 (]: Marking all children of 'test.pipeline_guardian.accepted_range_stg_orders_order_date___date_trunc_day_current_date_.2cf9901bb0' to be skipped because of status 'error'.  Reason: Compilation Error in test accepted_range_stg_orders_order_date___date_trunc_day_current_date_ (models\schema.yml)
  'current_date' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:20:10.245713 [debug] [Thread-2 (]: Using duckdb connection "test.pipeline_guardian.not_null_stg_orders_amount.2546645448"
[0m13:20:10.247706 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:20:10.251237 [debug] [Thread-3 (]: SQL status: OK in 0.012 seconds
[0m13:20:10.255232 [debug] [Thread-2 (]: On test.pipeline_guardian.not_null_stg_orders_amount.2546645448: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "test.pipeline_guardian.not_null_stg_orders_amount.2546645448"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select amount
from "demo"."main"."stg_orders"
where amount is null



  
  
      
    ) dbt_internal_test
[0m13:20:10.259766 [debug] [Thread-4 (]: SQL status: OK in 0.011 seconds
[0m13:20:10.263873 [debug] [Thread-3 (]: Using duckdb connection "test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:20:10.268872 [debug] [Thread-4 (]: Using duckdb connection "test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a"
[0m13:20:10.271122 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m13:20:10.273129 [debug] [Thread-3 (]: On test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "demo"."main"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m13:20:10.276234 [debug] [Thread-4 (]: On test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "demo"."main"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:20:10.292861 [debug] [Thread-2 (]: On test.pipeline_guardian.not_null_stg_orders_amount.2546645448: ROLLBACK
[0m13:20:10.296970 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m13:20:10.299611 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m13:20:10.301618 [debug] [Thread-2 (]: Failed to rollback 'test.pipeline_guardian.not_null_stg_orders_amount.2546645448'
[0m13:20:10.307607 [debug] [Thread-3 (]: On test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m13:20:10.313136 [debug] [Thread-4 (]: On test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m13:20:10.316233 [debug] [Thread-2 (]: On test.pipeline_guardian.not_null_stg_orders_amount.2546645448: Close
[0m13:20:10.319712 [debug] [Thread-3 (]: Failed to rollback 'test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64'
[0m13:20:10.322705 [debug] [Thread-4 (]: Failed to rollback 'test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a'
[0m13:20:10.325702 [error] [Thread-2 (]: 2 of 4 FAIL 1 not_null_stg_orders_amount ....................................... [[31mFAIL 1[0m in 0.32s]
[0m13:20:10.327702 [debug] [Thread-3 (]: On test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m13:20:10.330279 [debug] [Thread-4 (]: On test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a: Close
[0m13:20:10.333300 [debug] [Thread-2 (]: Finished running node test.pipeline_guardian.not_null_stg_orders_amount.2546645448
[0m13:20:10.337277 [info ] [Thread-3 (]: 3 of 4 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 0.32s]
[0m13:20:10.339814 [error] [Thread-4 (]: 4 of 4 FAIL 2 unique_stg_orders_order_id ....................................... [[31mFAIL 2[0m in 0.32s]
[0m13:20:10.344814 [debug] [Thread-3 (]: Finished running node test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64
[0m13:20:10.346811 [debug] [Thread-4 (]: Finished running node test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a
[0m13:20:10.354346 [debug] [MainThread]: Using duckdb connection "master"
[0m13:20:10.356342 [debug] [MainThread]: On master: BEGIN
[0m13:20:10.358355 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:20:10.362412 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m13:20:10.364424 [debug] [MainThread]: On master: COMMIT
[0m13:20:10.366482 [debug] [MainThread]: Using duckdb connection "master"
[0m13:20:10.368417 [debug] [MainThread]: On master: COMMIT
[0m13:20:10.371845 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:20:10.373832 [debug] [MainThread]: On master: Close
[0m13:20:10.376827 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:20:10.378436 [debug] [MainThread]: Connection 'list_demo_main' was properly closed.
[0m13:20:10.380561 [debug] [MainThread]: Connection 'test.pipeline_guardian.accepted_range_stg_orders_order_date___date_trunc_day_current_date_.2cf9901bb0' was properly closed.
[0m13:20:10.382563 [debug] [MainThread]: Connection 'test.pipeline_guardian.not_null_stg_orders_amount.2546645448' was properly closed.
[0m13:20:10.385078 [debug] [MainThread]: Connection 'test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64' was properly closed.
[0m13:20:10.386040 [debug] [MainThread]: Connection 'test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m13:20:10.386974 [info ] [MainThread]: 
[0m13:20:10.390613 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 0.92 seconds (0.92s).
[0m13:20:10.394717 [debug] [MainThread]: Command end result
[0m13:20:10.468617 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\manifest.json
[0m13:20:10.477629 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\semantic_manifest.json
[0m13:20:10.504862 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\run_results.json
[0m13:20:10.506521 [info ] [MainThread]: 
[0m13:20:10.509395 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m13:20:10.511112 [info ] [MainThread]: 
[0m13:20:10.514335 [error] [MainThread]: [31mFailure in test accepted_range_stg_orders_order_date___date_trunc_day_current_date_ (models\schema.yml)[0m
[0m13:20:10.516019 [error] [MainThread]:   Compilation Error in test accepted_range_stg_orders_order_date___date_trunc_day_current_date_ (models\schema.yml)
  'current_date' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:20:10.518549 [info ] [MainThread]: 
[0m13:20:10.521566 [error] [MainThread]: [31mFailure in test not_null_stg_orders_amount (models\schema.yml)[0m
[0m13:20:10.524581 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:20:10.527563 [info ] [MainThread]: 
[0m13:20:10.529735 [info ] [MainThread]:   compiled code at target\compiled\pipeline_guardian\models\schema.yml\not_null_stg_orders_amount.sql
[0m13:20:10.532737 [info ] [MainThread]: 
[0m13:20:10.535734 [error] [MainThread]: [31mFailure in test unique_stg_orders_order_id (models\schema.yml)[0m
[0m13:20:10.538733 [error] [MainThread]:   Got 2 results, configured to fail if != 0
[0m13:20:10.541273 [info ] [MainThread]: 
[0m13:20:10.543303 [info ] [MainThread]:   compiled code at target\compiled\pipeline_guardian\models\schema.yml\unique_stg_orders_order_id.sql
[0m13:20:10.546264 [info ] [MainThread]: 
[0m13:20:10.547265 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=4
[0m13:20:10.552800 [debug] [MainThread]: Command `dbt test` failed at 13:20:10.551801 after 5.21 seconds
[0m13:20:10.554802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024924AEE110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024925E05E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249289BF160>]}
[0m13:20:10.556895 [debug] [MainThread]: Flushing usage events
[0m13:20:11.034123 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:25:01.880207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E164686050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1668ECCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1668ECA60>]}


============================== 13:25:01.889952 | 51e97eaf-693e-4c51-8dc6-e4a18d3eeb8b ==============================
[0m13:25:01.889952 [info ] [MainThread]: Running with dbt=1.10.9
[0m13:25:01.891841 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run --project-dir dbt', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'dbt\\logs', 'profiles_dir': 'C:\\Users\\likhi\\Downloads\\pipeline-guardian-v2-upload\\dbt', 'static_parser': 'True', 'write_json': 'True'}
[0m13:25:02.302651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51e97eaf-693e-4c51-8dc6-e4a18d3eeb8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E166A02650>]}
[0m13:25:02.403156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51e97eaf-693e-4c51-8dc6-e4a18d3eeb8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1660520B0>]}
[0m13:25:02.407756 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m13:25:02.797134 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m13:25:03.111169 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:25:03.112125 [debug] [MainThread]: Partial parsing: updated file: pipeline_guardian://models\staging\stg_orders.sql
[0m13:25:03.665017 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_range`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m13:25:03.666017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '51e97eaf-693e-4c51-8dc6-e4a18d3eeb8b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1680BC550>]}
[0m13:25:03.847593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51e97eaf-693e-4c51-8dc6-e4a18d3eeb8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1681059F0>]}
[0m13:25:04.004428 [debug] [MainThread]: Wrote artifact WritableManifest to dbt\target\manifest.json
[0m13:25:04.008150 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt\target\semantic_manifest.json
[0m13:25:04.048967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51e97eaf-693e-4c51-8dc6-e4a18d3eeb8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E166F03850>]}
[0m13:25:04.049967 [info ] [MainThread]: Found 2 models, 1 seed, 4 data tests, 1 source, 429 macros
[0m13:25:04.050970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51e97eaf-693e-4c51-8dc6-e4a18d3eeb8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E166F03100>]}
[0m13:25:04.053968 [info ] [MainThread]: 
[0m13:25:04.054844 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:25:04.055764 [info ] [MainThread]: 
[0m13:25:04.056797 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:25:04.067324 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_demo'
[0m13:25:04.185775 [debug] [ThreadPool]: Using duckdb connection "list_demo"
[0m13:25:04.186776 [debug] [ThreadPool]: On list_demo: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "connection_name": "list_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"demo"'
    
  
  
[0m13:25:04.187804 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:25:04.217380 [debug] [ThreadPool]: SQL status: OK in 0.030 seconds
[0m13:25:04.219388 [debug] [ThreadPool]: On list_demo: Close
[0m13:25:04.221557 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_demo, now create_demo_main)
[0m13:25:04.222569 [debug] [ThreadPool]: Creating schema "database: "demo"
schema: "main"
"
[0m13:25:04.233091 [debug] [ThreadPool]: Using duckdb connection "create_demo_main"
[0m13:25:04.234103 [debug] [ThreadPool]: On create_demo_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "connection_name": "create_demo_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='demo'
        and type='sqlite'
    
  
[0m13:25:04.235100 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:25:04.236621 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m13:25:04.238648 [debug] [ThreadPool]: Using duckdb connection "create_demo_main"
[0m13:25:04.239643 [debug] [ThreadPool]: On create_demo_main: BEGIN
[0m13:25:04.241638 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:25:04.242164 [debug] [ThreadPool]: Using duckdb connection "create_demo_main"
[0m13:25:04.243177 [debug] [ThreadPool]: On create_demo_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "connection_name": "create_demo_main"} */

    
    
        create schema if not exists "demo"."main"
    
[0m13:25:04.244176 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:25:04.246695 [debug] [ThreadPool]: On create_demo_main: COMMIT
[0m13:25:04.247710 [debug] [ThreadPool]: Using duckdb connection "create_demo_main"
[0m13:25:04.248712 [debug] [ThreadPool]: On create_demo_main: COMMIT
[0m13:25:04.250712 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:25:04.251823 [debug] [ThreadPool]: On create_demo_main: Close
[0m13:25:04.255069 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_demo_main'
[0m13:25:04.265618 [debug] [ThreadPool]: Using duckdb connection "list_demo_main"
[0m13:25:04.267127 [debug] [ThreadPool]: On list_demo_main: BEGIN
[0m13:25:04.268138 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:25:04.269148 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:25:04.270158 [debug] [ThreadPool]: Using duckdb connection "list_demo_main"
[0m13:25:04.270158 [debug] [ThreadPool]: On list_demo_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "connection_name": "list_demo_main"} */
select
      'demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'demo'
  
[0m13:25:04.285825 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m13:25:04.288449 [debug] [ThreadPool]: On list_demo_main: ROLLBACK
[0m13:25:04.290361 [debug] [ThreadPool]: Failed to rollback 'list_demo_main'
[0m13:25:04.290361 [debug] [ThreadPool]: On list_demo_main: Close
[0m13:25:04.293346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51e97eaf-693e-4c51-8dc6-e4a18d3eeb8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E163F43CA0>]}
[0m13:25:04.293346 [debug] [MainThread]: Using duckdb connection "master"
[0m13:25:04.294351 [debug] [MainThread]: On master: BEGIN
[0m13:25:04.295349 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:25:04.295349 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:25:04.296861 [debug] [MainThread]: On master: COMMIT
[0m13:25:04.297873 [debug] [MainThread]: Using duckdb connection "master"
[0m13:25:04.297873 [debug] [MainThread]: On master: COMMIT
[0m13:25:04.298877 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:25:04.299879 [debug] [MainThread]: On master: Close
[0m13:25:04.307867 [debug] [Thread-1 (]: Began running node model.pipeline_guardian.stg_orders
[0m13:25:04.308868 [info ] [Thread-1 (]: 1 of 2 START sql table model main.stg_orders ................................... [RUN]
[0m13:25:04.310870 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.pipeline_guardian.stg_orders'
[0m13:25:04.311970 [debug] [Thread-1 (]: Began compiling node model.pipeline_guardian.stg_orders
[0m13:25:04.322688 [debug] [Thread-1 (]: Writing injected SQL for node "model.pipeline_guardian.stg_orders"
[0m13:25:04.324583 [debug] [Thread-1 (]: Began executing node model.pipeline_guardian.stg_orders
[0m13:25:04.372176 [debug] [Thread-1 (]: Writing runtime sql for node "model.pipeline_guardian.stg_orders"
[0m13:25:04.374451 [debug] [Thread-1 (]: Using duckdb connection "model.pipeline_guardian.stg_orders"
[0m13:25:04.375573 [debug] [Thread-1 (]: On model.pipeline_guardian.stg_orders: BEGIN
[0m13:25:04.376477 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:25:04.378078 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:25:04.378078 [debug] [Thread-1 (]: Using duckdb connection "model.pipeline_guardian.stg_orders"
[0m13:25:04.379086 [debug] [Thread-1 (]: On model.pipeline_guardian.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "model.pipeline_guardian.stg_orders"} */

  
    
    

    create  table
      "demo"."main"."stg_orders__dbt_tmp"
  
    as (
      with source as (
    select * from "demo"."main"."orders"
),

-- PATCH_AREA_START
patched as (
  with cleaned as (
    select *
    from source
    where amount is not null
      and cast(order_date as date) <= current_date
  ),
  ranked as (
    select
      order_id,
      customer_id,
      cast(amount as double) as amount,
      cast(order_date as date) as order_date,
      row_number() over (partition by order_id order by order_date desc) as rn
    from cleaned
  )
  select * from ranked where rn = 1
)
-- PATCH_AREA_END

select * from patched
    );
  
  
[0m13:25:04.388605 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m13:25:04.399126 [debug] [Thread-1 (]: Using duckdb connection "model.pipeline_guardian.stg_orders"
[0m13:25:04.400121 [debug] [Thread-1 (]: On model.pipeline_guardian.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "model.pipeline_guardian.stg_orders"} */
alter table "demo"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m13:25:04.402121 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:25:04.405375 [debug] [Thread-1 (]: Using duckdb connection "model.pipeline_guardian.stg_orders"
[0m13:25:04.406986 [debug] [Thread-1 (]: On model.pipeline_guardian.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "model.pipeline_guardian.stg_orders"} */
alter table "demo"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m13:25:04.407999 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:25:04.431058 [debug] [Thread-1 (]: On model.pipeline_guardian.stg_orders: COMMIT
[0m13:25:04.432059 [debug] [Thread-1 (]: Using duckdb connection "model.pipeline_guardian.stg_orders"
[0m13:25:04.433057 [debug] [Thread-1 (]: On model.pipeline_guardian.stg_orders: COMMIT
[0m13:25:04.442117 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m13:25:04.451660 [debug] [Thread-1 (]: Using duckdb connection "model.pipeline_guardian.stg_orders"
[0m13:25:04.452659 [debug] [Thread-1 (]: On model.pipeline_guardian.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "model.pipeline_guardian.stg_orders"} */

      drop table if exists "demo"."main"."stg_orders__dbt_backup" cascade
    
[0m13:25:04.455420 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:25:04.459088 [debug] [Thread-1 (]: On model.pipeline_guardian.stg_orders: Close
[0m13:25:04.462097 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51e97eaf-693e-4c51-8dc6-e4a18d3eeb8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E162B7B1C0>]}
[0m13:25:04.464106 [info ] [Thread-1 (]: 1 of 2 OK created sql table model main.stg_orders .............................. [[32mOK[0m in 0.15s]
[0m13:25:04.466619 [debug] [Thread-1 (]: Finished running node model.pipeline_guardian.stg_orders
[0m13:25:04.467630 [debug] [Thread-3 (]: Began running node model.pipeline_guardian.orders_summary
[0m13:25:04.469645 [info ] [Thread-3 (]: 2 of 2 START sql table model main.orders_summary ............................... [RUN]
[0m13:25:04.471644 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.pipeline_guardian.orders_summary'
[0m13:25:04.471644 [debug] [Thread-3 (]: Began compiling node model.pipeline_guardian.orders_summary
[0m13:25:04.475647 [debug] [Thread-3 (]: Writing injected SQL for node "model.pipeline_guardian.orders_summary"
[0m13:25:04.477171 [debug] [Thread-3 (]: Began executing node model.pipeline_guardian.orders_summary
[0m13:25:04.483335 [debug] [Thread-3 (]: Writing runtime sql for node "model.pipeline_guardian.orders_summary"
[0m13:25:04.485243 [debug] [Thread-3 (]: Using duckdb connection "model.pipeline_guardian.orders_summary"
[0m13:25:04.485243 [debug] [Thread-3 (]: On model.pipeline_guardian.orders_summary: BEGIN
[0m13:25:04.486857 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:25:04.487871 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:25:04.488970 [debug] [Thread-3 (]: Using duckdb connection "model.pipeline_guardian.orders_summary"
[0m13:25:04.489876 [debug] [Thread-3 (]: On model.pipeline_guardian.orders_summary: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "model.pipeline_guardian.orders_summary"} */

  
    
    

    create  table
      "demo"."main"."orders_summary__dbt_tmp"
  
    as (
      select count(*) total_orders, sum(amount) total_revenue
from "demo"."main"."stg_orders"
    );
  
  
[0m13:25:04.490978 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:25:04.497390 [debug] [Thread-3 (]: Using duckdb connection "model.pipeline_guardian.orders_summary"
[0m13:25:04.500392 [debug] [Thread-3 (]: On model.pipeline_guardian.orders_summary: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "model.pipeline_guardian.orders_summary"} */
alter table "demo"."main"."orders_summary" rename to "orders_summary__dbt_backup"
[0m13:25:04.502396 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:25:04.508922 [debug] [Thread-3 (]: Using duckdb connection "model.pipeline_guardian.orders_summary"
[0m13:25:04.510918 [debug] [Thread-3 (]: On model.pipeline_guardian.orders_summary: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "model.pipeline_guardian.orders_summary"} */
alter table "demo"."main"."orders_summary__dbt_tmp" rename to "orders_summary"
[0m13:25:04.512023 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:25:04.515923 [debug] [Thread-3 (]: On model.pipeline_guardian.orders_summary: COMMIT
[0m13:25:04.518448 [debug] [Thread-3 (]: Using duckdb connection "model.pipeline_guardian.orders_summary"
[0m13:25:04.519451 [debug] [Thread-3 (]: On model.pipeline_guardian.orders_summary: COMMIT
[0m13:25:04.522560 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m13:25:04.527866 [debug] [Thread-3 (]: Using duckdb connection "model.pipeline_guardian.orders_summary"
[0m13:25:04.528961 [debug] [Thread-3 (]: On model.pipeline_guardian.orders_summary: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "model.pipeline_guardian.orders_summary"} */

      drop table if exists "demo"."main"."orders_summary__dbt_backup" cascade
    
[0m13:25:04.532854 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m13:25:04.534957 [debug] [Thread-3 (]: On model.pipeline_guardian.orders_summary: Close
[0m13:25:04.535959 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51e97eaf-693e-4c51-8dc6-e4a18d3eeb8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1686BDBA0>]}
[0m13:25:04.537574 [info ] [Thread-3 (]: 2 of 2 OK created sql table model main.orders_summary .......................... [[32mOK[0m in 0.07s]
[0m13:25:04.538579 [debug] [Thread-3 (]: Finished running node model.pipeline_guardian.orders_summary
[0m13:25:04.541576 [debug] [MainThread]: Using duckdb connection "master"
[0m13:25:04.542191 [debug] [MainThread]: On master: BEGIN
[0m13:25:04.543203 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:25:04.544305 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:25:04.545293 [debug] [MainThread]: On master: COMMIT
[0m13:25:04.545293 [debug] [MainThread]: Using duckdb connection "master"
[0m13:25:04.546856 [debug] [MainThread]: On master: COMMIT
[0m13:25:04.546856 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:25:04.547869 [debug] [MainThread]: On master: Close
[0m13:25:04.549867 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:25:04.549867 [debug] [MainThread]: Connection 'create_demo_main' was properly closed.
[0m13:25:04.550984 [debug] [MainThread]: Connection 'list_demo_main' was properly closed.
[0m13:25:04.550984 [debug] [MainThread]: Connection 'model.pipeline_guardian.stg_orders' was properly closed.
[0m13:25:04.551974 [debug] [MainThread]: Connection 'model.pipeline_guardian.orders_summary' was properly closed.
[0m13:25:04.552971 [info ] [MainThread]: 
[0m13:25:04.553869 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m13:25:04.555921 [debug] [MainThread]: Command end result
[0m13:25:04.586691 [debug] [MainThread]: Wrote artifact WritableManifest to dbt\target\manifest.json
[0m13:25:04.591709 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt\target\semantic_manifest.json
[0m13:25:04.603235 [debug] [MainThread]: Wrote artifact RunExecutionResult to dbt\target\run_results.json
[0m13:25:04.604245 [info ] [MainThread]: 
[0m13:25:04.605234 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:25:04.606741 [info ] [MainThread]: 
[0m13:25:04.607760 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m13:25:04.608760 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:25:04.611863 [debug] [MainThread]: Command `dbt run` succeeded at 13:25:04.611863 after 2.88 seconds
[0m13:25:04.612753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E164686050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E1680CA5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E166A004C0>]}
[0m13:25:04.613858 [debug] [MainThread]: Flushing usage events
[0m13:25:05.167029 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:25:09.835593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A359C9F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A37C33280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A37C33010>]}


============================== 13:25:09.843690 | 8d552021-560c-43f5-871f-393d9231636d ==============================
[0m13:25:09.843690 [info ] [MainThread]: Running with dbt=1.10.9
[0m13:25:09.845693 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\likhi\\Downloads\\pipeline-guardian-v2-upload\\dbt', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt test --project-dir dbt', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': 'dbt\\logs', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m13:25:10.225616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d552021-560c-43f5-871f-393d9231636d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A33EC5900>]}
[0m13:25:10.353274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d552021-560c-43f5-871f-393d9231636d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A37CBAA40>]}
[0m13:25:10.358805 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m13:25:11.026364 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m13:25:11.486577 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:25:11.488197 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:25:11.787073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d552021-560c-43f5-871f-393d9231636d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A3927C400>]}
[0m13:25:12.082641 [debug] [MainThread]: Wrote artifact WritableManifest to dbt\target\manifest.json
[0m13:25:12.087033 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt\target\semantic_manifest.json
[0m13:25:12.233081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d552021-560c-43f5-871f-393d9231636d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A380889D0>]}
[0m13:25:12.234589 [info ] [MainThread]: Found 2 models, 1 seed, 4 data tests, 1 source, 429 macros
[0m13:25:12.235600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d552021-560c-43f5-871f-393d9231636d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A381EFCD0>]}
[0m13:25:12.241121 [info ] [MainThread]: 
[0m13:25:12.243127 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:25:12.245461 [info ] [MainThread]: 
[0m13:25:12.248969 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:25:12.265119 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_demo_main'
[0m13:25:12.384577 [debug] [ThreadPool]: Using duckdb connection "list_demo_main"
[0m13:25:12.385577 [debug] [ThreadPool]: On list_demo_main: BEGIN
[0m13:25:12.385577 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:25:12.428797 [debug] [ThreadPool]: SQL status: OK in 0.043 seconds
[0m13:25:12.429791 [debug] [ThreadPool]: Using duckdb connection "list_demo_main"
[0m13:25:12.430790 [debug] [ThreadPool]: On list_demo_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "connection_name": "list_demo_main"} */
select
      'demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'demo'
  
[0m13:25:12.447797 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m13:25:12.449783 [debug] [ThreadPool]: On list_demo_main: ROLLBACK
[0m13:25:12.450886 [debug] [ThreadPool]: Failed to rollback 'list_demo_main'
[0m13:25:12.451889 [debug] [ThreadPool]: On list_demo_main: Close
[0m13:25:12.453783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d552021-560c-43f5-871f-393d9231636d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A381BCCA0>]}
[0m13:25:12.455027 [debug] [MainThread]: Using duckdb connection "master"
[0m13:25:12.455027 [debug] [MainThread]: On master: BEGIN
[0m13:25:12.456029 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:25:12.457027 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:25:12.458029 [debug] [MainThread]: On master: COMMIT
[0m13:25:12.459038 [debug] [MainThread]: Using duckdb connection "master"
[0m13:25:12.459038 [debug] [MainThread]: On master: COMMIT
[0m13:25:12.460038 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:25:12.461039 [debug] [MainThread]: On master: Close
[0m13:25:12.469619 [debug] [Thread-1 (]: Began running node test.pipeline_guardian.accepted_range_stg_orders_order_date___date_trunc_day_current_date_.2cf9901bb0
[0m13:25:12.470680 [debug] [Thread-2 (]: Began running node test.pipeline_guardian.not_null_stg_orders_amount.2546645448
[0m13:25:12.471678 [debug] [Thread-3 (]: Began running node test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64
[0m13:25:12.472627 [debug] [Thread-4 (]: Began running node test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a
[0m13:25:12.473637 [info ] [Thread-1 (]: 1 of 4 START test accepted_range_stg_orders_order_date___date_trunc_day_current_date_  [RUN]
[0m13:25:12.474260 [info ] [Thread-2 (]: 2 of 4 START test not_null_stg_orders_amount ................................... [RUN]
[0m13:25:12.476262 [info ] [Thread-3 (]: 3 of 4 START test not_null_stg_orders_order_id ................................. [RUN]
[0m13:25:12.477275 [info ] [Thread-4 (]: 4 of 4 START test unique_stg_orders_order_id ................................... [RUN]
[0m13:25:12.479801 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.pipeline_guardian.accepted_range_stg_orders_order_date___date_trunc_day_current_date_.2cf9901bb0'
[0m13:25:12.481804 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.pipeline_guardian.not_null_stg_orders_amount.2546645448'
[0m13:25:12.482804 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64'
[0m13:25:12.485285 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a'
[0m13:25:12.486354 [debug] [Thread-1 (]: Began compiling node test.pipeline_guardian.accepted_range_stg_orders_order_date___date_trunc_day_current_date_.2cf9901bb0
[0m13:25:12.487281 [debug] [Thread-2 (]: Began compiling node test.pipeline_guardian.not_null_stg_orders_amount.2546645448
[0m13:25:12.488789 [debug] [Thread-3 (]: Began compiling node test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64
[0m13:25:12.490804 [debug] [Thread-4 (]: Began compiling node test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a
[0m13:25:12.527583 [debug] [Thread-2 (]: Writing injected SQL for node "test.pipeline_guardian.not_null_stg_orders_amount.2546645448"
[0m13:25:12.537019 [debug] [Thread-3 (]: Writing injected SQL for node "test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:25:12.550599 [debug] [Thread-4 (]: Writing injected SQL for node "test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a"
[0m13:25:12.553598 [debug] [Thread-2 (]: Began executing node test.pipeline_guardian.not_null_stg_orders_amount.2546645448
[0m13:25:12.556118 [debug] [Thread-3 (]: Began executing node test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64
[0m13:25:12.585132 [debug] [Thread-2 (]: Writing runtime sql for node "test.pipeline_guardian.not_null_stg_orders_amount.2546645448"
[0m13:25:12.586161 [debug] [Thread-4 (]: Began executing node test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a
[0m13:25:12.590897 [debug] [Thread-3 (]: Writing runtime sql for node "test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:25:12.599590 [debug] [Thread-4 (]: Writing runtime sql for node "test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a"
[0m13:25:12.600672 [debug] [Thread-2 (]: Using duckdb connection "test.pipeline_guardian.not_null_stg_orders_amount.2546645448"
[0m13:25:12.604936 [debug] [Thread-1 (]: Compilation Error in test accepted_range_stg_orders_order_date___date_trunc_day_current_date_ (models\schema.yml)
  'current_date' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:25:12.605888 [debug] [Thread-3 (]: Using duckdb connection "test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:25:12.606959 [debug] [Thread-2 (]: On test.pipeline_guardian.not_null_stg_orders_amount.2546645448: BEGIN
[0m13:25:12.608481 [debug] [Thread-4 (]: Using duckdb connection "test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a"
[0m13:25:12.610506 [error] [Thread-1 (]: 1 of 4 ERROR accepted_range_stg_orders_order_date___date_trunc_day_current_date_  [[31mERROR[0m in 0.13s]
[0m13:25:12.611504 [debug] [Thread-3 (]: On test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m13:25:12.612614 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:25:12.614035 [debug] [Thread-4 (]: On test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m13:25:12.616041 [debug] [Thread-1 (]: Finished running node test.pipeline_guardian.accepted_range_stg_orders_order_date___date_trunc_day_current_date_.2cf9901bb0
[0m13:25:12.617043 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:25:12.618564 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m13:25:12.619636 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:25:12.620577 [debug] [Thread-7 (]: Marking all children of 'test.pipeline_guardian.accepted_range_stg_orders_order_date___date_trunc_day_current_date_.2cf9901bb0' to be skipped because of status 'error'.  Reason: Compilation Error in test accepted_range_stg_orders_order_date___date_trunc_day_current_date_ (models\schema.yml)
  'current_date' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:25:12.622577 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m13:25:12.623680 [debug] [Thread-2 (]: Using duckdb connection "test.pipeline_guardian.not_null_stg_orders_amount.2546645448"
[0m13:25:12.625304 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m13:25:12.627382 [debug] [Thread-3 (]: Using duckdb connection "test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:25:12.627382 [debug] [Thread-2 (]: On test.pipeline_guardian.not_null_stg_orders_amount.2546645448: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "test.pipeline_guardian.not_null_stg_orders_amount.2546645448"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select amount
from "demo"."main"."stg_orders"
where amount is null



  
  
      
    ) dbt_internal_test
[0m13:25:12.629923 [debug] [Thread-4 (]: Using duckdb connection "test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a"
[0m13:25:12.630925 [debug] [Thread-3 (]: On test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "demo"."main"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m13:25:12.631926 [debug] [Thread-4 (]: On test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "demo"."main"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:25:12.633442 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:25:12.635455 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:25:12.641742 [debug] [Thread-2 (]: On test.pipeline_guardian.not_null_stg_orders_amount.2546645448: ROLLBACK
[0m13:25:12.642865 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m13:25:12.645423 [debug] [Thread-3 (]: On test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m13:25:12.646421 [debug] [Thread-2 (]: Failed to rollback 'test.pipeline_guardian.not_null_stg_orders_amount.2546645448'
[0m13:25:12.648834 [debug] [Thread-4 (]: On test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m13:25:12.649849 [debug] [Thread-3 (]: Failed to rollback 'test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64'
[0m13:25:12.650849 [debug] [Thread-2 (]: On test.pipeline_guardian.not_null_stg_orders_amount.2546645448: Close
[0m13:25:12.652844 [debug] [Thread-4 (]: Failed to rollback 'test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a'
[0m13:25:12.652844 [debug] [Thread-3 (]: On test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m13:25:12.654410 [info ] [Thread-2 (]: 2 of 4 PASS not_null_stg_orders_amount ......................................... [[32mPASS[0m in 0.17s]
[0m13:25:12.656415 [debug] [Thread-4 (]: On test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a: Close
[0m13:25:12.658926 [info ] [Thread-3 (]: 3 of 4 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 0.17s]
[0m13:25:12.659939 [debug] [Thread-2 (]: Finished running node test.pipeline_guardian.not_null_stg_orders_amount.2546645448
[0m13:25:12.661945 [info ] [Thread-4 (]: 4 of 4 PASS unique_stg_orders_order_id ......................................... [[32mPASS[0m in 0.18s]
[0m13:25:12.663458 [debug] [Thread-3 (]: Finished running node test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64
[0m13:25:12.665468 [debug] [Thread-4 (]: Finished running node test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a
[0m13:25:12.668473 [debug] [MainThread]: Using duckdb connection "master"
[0m13:25:12.669571 [debug] [MainThread]: On master: BEGIN
[0m13:25:12.669571 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:25:12.671470 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:25:12.672469 [debug] [MainThread]: On master: COMMIT
[0m13:25:12.673988 [debug] [MainThread]: Using duckdb connection "master"
[0m13:25:12.675014 [debug] [MainThread]: On master: COMMIT
[0m13:25:12.676113 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:25:12.677056 [debug] [MainThread]: On master: Close
[0m13:25:12.678567 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:25:12.678567 [debug] [MainThread]: Connection 'list_demo_main' was properly closed.
[0m13:25:12.679677 [debug] [MainThread]: Connection 'test.pipeline_guardian.accepted_range_stg_orders_order_date___date_trunc_day_current_date_.2cf9901bb0' was properly closed.
[0m13:25:12.679677 [debug] [MainThread]: Connection 'test.pipeline_guardian.not_null_stg_orders_amount.2546645448' was properly closed.
[0m13:25:12.680684 [debug] [MainThread]: Connection 'test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64' was properly closed.
[0m13:25:12.681578 [debug] [MainThread]: Connection 'test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m13:25:12.682576 [info ] [MainThread]: 
[0m13:25:12.683584 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m13:25:12.686041 [debug] [MainThread]: Command end result
[0m13:25:12.724488 [debug] [MainThread]: Wrote artifact WritableManifest to dbt\target\manifest.json
[0m13:25:12.730500 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt\target\semantic_manifest.json
[0m13:25:12.745562 [debug] [MainThread]: Wrote artifact RunExecutionResult to dbt\target\run_results.json
[0m13:25:12.745562 [info ] [MainThread]: 
[0m13:25:12.747204 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:25:12.748729 [info ] [MainThread]: 
[0m13:25:12.750339 [error] [MainThread]: [31mFailure in test accepted_range_stg_orders_order_date___date_trunc_day_current_date_ (models\schema.yml)[0m
[0m13:25:12.751953 [error] [MainThread]:   Compilation Error in test accepted_range_stg_orders_order_date___date_trunc_day_current_date_ (models\schema.yml)
  'current_date' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:25:12.753482 [info ] [MainThread]: 
[0m13:25:12.755043 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m13:25:12.756599 [debug] [MainThread]: Command `dbt test` failed at 13:25:12.756599 after 3.08 seconds
[0m13:25:12.758237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A359C9F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A36C5D270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A3980F730>]}
[0m13:25:12.758237 [debug] [MainThread]: Flushing usage events
[0m13:25:13.365804 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:25:31.448060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204A818E110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204AA478D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204AA478BB0>]}


============================== 13:25:31.457572 | 5785a03b-6a4b-4fb4-b847-fe9dd5603d47 ==============================
[0m13:25:31.457572 [info ] [MainThread]: Running with dbt=1.10.9
[0m13:25:31.459582 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': 'C:\\Users\\likhi\\Downloads\\pipeline-guardian-v2-upload\\dbt', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt seed --full-refresh', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'None', 'log_cache_events': 'False', 'log_path': 'C:\\Users\\likhi\\Downloads\\pipeline-guardian-v2-upload\\dbt\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m13:25:32.206956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5785a03b-6a4b-4fb4-b847-fe9dd5603d47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204A9554AF0>]}
[0m13:25:32.401950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5785a03b-6a4b-4fb4-b847-fe9dd5603d47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204A9C06500>]}
[0m13:25:32.411671 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m13:25:33.742325 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m13:25:34.428427 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:25:34.430418 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:25:34.660943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5785a03b-6a4b-4fb4-b847-fe9dd5603d47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204ABAC0460>]}
[0m13:25:35.050734 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\manifest.json
[0m13:25:35.059459 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\semantic_manifest.json
[0m13:25:35.167003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5785a03b-6a4b-4fb4-b847-fe9dd5603d47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204AAA70A90>]}
[0m13:25:35.169026 [info ] [MainThread]: Found 2 models, 1 seed, 4 data tests, 1 source, 429 macros
[0m13:25:35.171038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5785a03b-6a4b-4fb4-b847-fe9dd5603d47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204ABAD6E90>]}
[0m13:25:35.176556 [info ] [MainThread]: 
[0m13:25:35.179097 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:25:35.181189 [info ] [MainThread]: 
[0m13:25:35.185568 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:25:35.190599 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_demo'
[0m13:25:35.647276 [debug] [ThreadPool]: Using duckdb connection "list_demo"
[0m13:25:35.648948 [debug] [ThreadPool]: On list_demo: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "connection_name": "list_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"demo"'
    
  
  
[0m13:25:35.650609 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:25:35.699706 [debug] [ThreadPool]: SQL status: OK in 0.049 seconds
[0m13:25:35.703720 [debug] [ThreadPool]: On list_demo: Close
[0m13:25:35.705694 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_demo, now create_demo_main)
[0m13:25:35.708361 [debug] [ThreadPool]: Creating schema "database: "demo"
schema: "main"
"
[0m13:25:35.727667 [debug] [ThreadPool]: Using duckdb connection "create_demo_main"
[0m13:25:35.730783 [debug] [ThreadPool]: On create_demo_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "connection_name": "create_demo_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='demo'
        and type='sqlite'
    
  
[0m13:25:35.732757 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:25:35.735760 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m13:25:35.739476 [debug] [ThreadPool]: Using duckdb connection "create_demo_main"
[0m13:25:35.741474 [debug] [ThreadPool]: On create_demo_main: BEGIN
[0m13:25:35.743462 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:25:35.745467 [debug] [ThreadPool]: Using duckdb connection "create_demo_main"
[0m13:25:35.747082 [debug] [ThreadPool]: On create_demo_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "connection_name": "create_demo_main"} */

    
    
        create schema if not exists "demo"."main"
    
[0m13:25:35.749189 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:25:35.752182 [debug] [ThreadPool]: On create_demo_main: COMMIT
[0m13:25:35.754185 [debug] [ThreadPool]: Using duckdb connection "create_demo_main"
[0m13:25:35.755201 [debug] [ThreadPool]: On create_demo_main: COMMIT
[0m13:25:35.757917 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:25:35.759913 [debug] [ThreadPool]: On create_demo_main: Close
[0m13:25:35.777284 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_demo_main'
[0m13:25:35.793147 [debug] [ThreadPool]: Using duckdb connection "list_demo_main"
[0m13:25:35.795143 [debug] [ThreadPool]: On list_demo_main: BEGIN
[0m13:25:35.796761 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:25:35.798882 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m13:25:35.800873 [debug] [ThreadPool]: Using duckdb connection "list_demo_main"
[0m13:25:35.801873 [debug] [ThreadPool]: On list_demo_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "connection_name": "list_demo_main"} */
select
      'demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'demo'
  
[0m13:25:35.835077 [debug] [ThreadPool]: SQL status: OK in 0.031 seconds
[0m13:25:35.838816 [debug] [ThreadPool]: On list_demo_main: ROLLBACK
[0m13:25:35.841819 [debug] [ThreadPool]: Failed to rollback 'list_demo_main'
[0m13:25:35.843805 [debug] [ThreadPool]: On list_demo_main: Close
[0m13:25:35.847423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5785a03b-6a4b-4fb4-b847-fe9dd5603d47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204AAA70BE0>]}
[0m13:25:35.849515 [debug] [MainThread]: Using duckdb connection "master"
[0m13:25:35.851522 [debug] [MainThread]: On master: BEGIN
[0m13:25:35.853514 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:25:35.855520 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m13:25:35.858242 [debug] [MainThread]: On master: COMMIT
[0m13:25:35.859232 [debug] [MainThread]: Using duckdb connection "master"
[0m13:25:35.861235 [debug] [MainThread]: On master: COMMIT
[0m13:25:35.863237 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:25:35.865232 [debug] [MainThread]: On master: Close
[0m13:25:35.880522 [debug] [Thread-1 (]: Began running node seed.pipeline_guardian.orders
[0m13:25:35.883482 [info ] [Thread-1 (]: 1 of 1 START seed file main.orders ............................................. [RUN]
[0m13:25:35.885526 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.pipeline_guardian.orders'
[0m13:25:35.888141 [debug] [Thread-1 (]: Began compiling node seed.pipeline_guardian.orders
[0m13:25:35.890105 [debug] [Thread-1 (]: Began executing node seed.pipeline_guardian.orders
[0m13:25:35.975911 [debug] [Thread-1 (]: Using duckdb connection "seed.pipeline_guardian.orders"
[0m13:25:35.978249 [debug] [Thread-1 (]: On seed.pipeline_guardian.orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "seed.pipeline_guardian.orders"} */

      drop table if exists "demo"."main"."orders" cascade
    
[0m13:25:35.981274 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:25:36.031132 [debug] [Thread-1 (]: SQL status: OK in 0.049 seconds
[0m13:25:36.052620 [debug] [Thread-1 (]: Using duckdb connection "seed.pipeline_guardian.orders"
[0m13:25:36.054619 [debug] [Thread-1 (]: On seed.pipeline_guardian.orders: BEGIN
[0m13:25:36.057128 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:25:36.059261 [debug] [Thread-1 (]: Using duckdb connection "seed.pipeline_guardian.orders"
[0m13:25:36.060254 [debug] [Thread-1 (]: On seed.pipeline_guardian.orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "seed.pipeline_guardian.orders"} */

    create table "demo"."main"."orders" ("order_id" integer,"customer_id" text,"amount" float8,"order_date" date)
  
[0m13:25:36.063244 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:25:36.096854 [debug] [Thread-1 (]: Using duckdb connection "seed.pipeline_guardian.orders"
[0m13:25:36.098869 [debug] [Thread-1 (]: On seed.pipeline_guardian.orders: 
          COPY "demo"."main"."orders" FROM 'C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\seeds\orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m13:25:36.115613 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m13:25:36.130963 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.pipeline_guardian.orders"
[0m13:25:36.175240 [debug] [Thread-1 (]: On seed.pipeline_guardian.orders: COMMIT
[0m13:25:36.177827 [debug] [Thread-1 (]: Using duckdb connection "seed.pipeline_guardian.orders"
[0m13:25:36.179875 [debug] [Thread-1 (]: On seed.pipeline_guardian.orders: COMMIT
[0m13:25:36.225317 [debug] [Thread-1 (]: SQL status: OK in 0.044 seconds
[0m13:25:36.231898 [debug] [Thread-1 (]: On seed.pipeline_guardian.orders: Close
[0m13:25:36.240448 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5785a03b-6a4b-4fb4-b847-fe9dd5603d47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204A66EB1C0>]}
[0m13:25:36.243500 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file main.orders ......................................... [[32mCREATE 12[0m in 0.35s]
[0m13:25:36.245450 [debug] [Thread-1 (]: Finished running node seed.pipeline_guardian.orders
[0m13:25:36.250084 [debug] [MainThread]: Using duckdb connection "master"
[0m13:25:36.252081 [debug] [MainThread]: On master: BEGIN
[0m13:25:36.254079 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:25:36.257079 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m13:25:36.259547 [debug] [MainThread]: On master: COMMIT
[0m13:25:36.261544 [debug] [MainThread]: Using duckdb connection "master"
[0m13:25:36.263594 [debug] [MainThread]: On master: COMMIT
[0m13:25:36.265552 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:25:36.268761 [debug] [MainThread]: On master: Close
[0m13:25:36.271779 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:25:36.272897 [debug] [MainThread]: Connection 'create_demo_main' was properly closed.
[0m13:25:36.274774 [debug] [MainThread]: Connection 'list_demo_main' was properly closed.
[0m13:25:36.275845 [debug] [MainThread]: Connection 'seed.pipeline_guardian.orders' was properly closed.
[0m13:25:36.277430 [info ] [MainThread]: 
[0m13:25:36.278526 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 1.09 seconds (1.09s).
[0m13:25:36.281436 [debug] [MainThread]: Command end result
[0m13:25:36.345358 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\manifest.json
[0m13:25:36.354406 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\semantic_manifest.json
[0m13:25:36.375155 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\run_results.json
[0m13:25:36.378493 [info ] [MainThread]: 
[0m13:25:36.381509 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:25:36.383636 [info ] [MainThread]: 
[0m13:25:36.385510 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:25:36.389043 [debug] [MainThread]: Command `dbt seed` succeeded at 13:25:36.389043 after 5.18 seconds
[0m13:25:36.391061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204A818E110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204A84D5E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204AA1D7D00>]}
[0m13:25:36.392060 [debug] [MainThread]: Flushing usage events
[0m13:25:37.043680 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:26:02.790754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001388626E110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013888554D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013888554BB0>]}


============================== 13:26:02.799003 | 947f4ed9-adc2-45ea-a410-89285248b54d ==============================
[0m13:26:02.799003 [info ] [MainThread]: Running with dbt=1.10.9
[0m13:26:02.800622 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'printer_width': '80', 'log_path': 'C:\\Users\\likhi\\Downloads\\pipeline-guardian-v2-upload\\dbt\\logs', 'indirect_selection': 'eager', 'write_json': 'True', 'static_parser': 'True', 'profiles_dir': 'C:\\Users\\likhi\\Downloads\\pipeline-guardian-v2-upload\\dbt'}
[0m13:26:03.494840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '947f4ed9-adc2-45ea-a410-89285248b54d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013887634AF0>]}
[0m13:26:03.707273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '947f4ed9-adc2-45ea-a410-89285248b54d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013887CB3F10>]}
[0m13:26:03.716654 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m13:26:04.851818 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m13:26:05.545667 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:26:05.546667 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:26:05.768960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '947f4ed9-adc2-45ea-a410-89285248b54d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013888BD44C0>]}
[0m13:26:06.158180 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\manifest.json
[0m13:26:06.167986 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\semantic_manifest.json
[0m13:26:06.277158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '947f4ed9-adc2-45ea-a410-89285248b54d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000138887E7910>]}
[0m13:26:06.280212 [info ] [MainThread]: Found 2 models, 1 seed, 4 data tests, 1 source, 429 macros
[0m13:26:06.282208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '947f4ed9-adc2-45ea-a410-89285248b54d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013888B511E0>]}
[0m13:26:06.287739 [info ] [MainThread]: 
[0m13:26:06.289742 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:26:06.291741 [info ] [MainThread]: 
[0m13:26:06.293743 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:26:06.316872 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_demo'
[0m13:26:06.751338 [debug] [ThreadPool]: Using duckdb connection "list_demo"
[0m13:26:06.752340 [debug] [ThreadPool]: On list_demo: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "connection_name": "list_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"demo"'
    
  
  
[0m13:26:06.754310 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:26:06.822652 [debug] [ThreadPool]: SQL status: OK in 0.068 seconds
[0m13:26:06.827395 [debug] [ThreadPool]: On list_demo: Close
[0m13:26:06.830451 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_demo, now create_demo_main)
[0m13:26:06.832398 [debug] [ThreadPool]: Creating schema "database: "demo"
schema: "main"
"
[0m13:26:06.851678 [debug] [ThreadPool]: Using duckdb connection "create_demo_main"
[0m13:26:06.854679 [debug] [ThreadPool]: On create_demo_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "connection_name": "create_demo_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='demo'
        and type='sqlite'
    
  
[0m13:26:06.856678 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:26:06.860231 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m13:26:06.865114 [debug] [ThreadPool]: Using duckdb connection "create_demo_main"
[0m13:26:06.866627 [debug] [ThreadPool]: On create_demo_main: BEGIN
[0m13:26:06.869748 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:26:06.871647 [debug] [ThreadPool]: Using duckdb connection "create_demo_main"
[0m13:26:06.874749 [debug] [ThreadPool]: On create_demo_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "connection_name": "create_demo_main"} */

    
    
        create schema if not exists "demo"."main"
    
[0m13:26:06.877335 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:26:06.881336 [debug] [ThreadPool]: On create_demo_main: COMMIT
[0m13:26:06.884341 [debug] [ThreadPool]: Using duckdb connection "create_demo_main"
[0m13:26:06.886956 [debug] [ThreadPool]: On create_demo_main: COMMIT
[0m13:26:06.890051 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:26:06.891975 [debug] [ThreadPool]: On create_demo_main: Close
[0m13:26:06.897255 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_demo_main'
[0m13:26:06.919547 [debug] [ThreadPool]: Using duckdb connection "list_demo_main"
[0m13:26:06.922628 [debug] [ThreadPool]: On list_demo_main: BEGIN
[0m13:26:06.924628 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:26:06.927279 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m13:26:06.929361 [debug] [ThreadPool]: Using duckdb connection "list_demo_main"
[0m13:26:06.931279 [debug] [ThreadPool]: On list_demo_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "connection_name": "list_demo_main"} */
select
      'demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'demo'
  
[0m13:26:06.966745 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m13:26:06.971861 [debug] [ThreadPool]: On list_demo_main: ROLLBACK
[0m13:26:06.974874 [debug] [ThreadPool]: Failed to rollback 'list_demo_main'
[0m13:26:06.976818 [debug] [ThreadPool]: On list_demo_main: Close
[0m13:26:06.981221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '947f4ed9-adc2-45ea-a410-89285248b54d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001388509FAF0>]}
[0m13:26:06.983224 [debug] [MainThread]: Using duckdb connection "master"
[0m13:26:06.985327 [debug] [MainThread]: On master: BEGIN
[0m13:26:06.986839 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:26:06.989962 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m13:26:06.991909 [debug] [MainThread]: On master: COMMIT
[0m13:26:06.993961 [debug] [MainThread]: Using duckdb connection "master"
[0m13:26:06.995425 [debug] [MainThread]: On master: COMMIT
[0m13:26:06.996995 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:26:06.999012 [debug] [MainThread]: On master: Close
[0m13:26:07.013108 [debug] [Thread-1 (]: Began running node model.pipeline_guardian.stg_orders
[0m13:26:07.015094 [info ] [Thread-1 (]: 1 of 2 START sql table model main.stg_orders ................................... [RUN]
[0m13:26:07.017613 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.pipeline_guardian.stg_orders'
[0m13:26:07.019615 [debug] [Thread-1 (]: Began compiling node model.pipeline_guardian.stg_orders
[0m13:26:07.042632 [debug] [Thread-1 (]: Writing injected SQL for node "model.pipeline_guardian.stg_orders"
[0m13:26:07.046749 [debug] [Thread-1 (]: Began executing node model.pipeline_guardian.stg_orders
[0m13:26:07.140976 [debug] [Thread-1 (]: Writing runtime sql for node "model.pipeline_guardian.stg_orders"
[0m13:26:07.145930 [debug] [Thread-1 (]: Using duckdb connection "model.pipeline_guardian.stg_orders"
[0m13:26:07.148502 [debug] [Thread-1 (]: On model.pipeline_guardian.stg_orders: BEGIN
[0m13:26:07.150564 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:26:07.154502 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:26:07.155586 [debug] [Thread-1 (]: Using duckdb connection "model.pipeline_guardian.stg_orders"
[0m13:26:07.158044 [debug] [Thread-1 (]: On model.pipeline_guardian.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "model.pipeline_guardian.stg_orders"} */

  
    
    

    create  table
      "demo"."main"."stg_orders__dbt_tmp"
  
    as (
      with source as (
    select * from "demo"."main"."orders"
),

-- PATCH_AREA_START
patched as (
  with cleaned as (
    select *
    from source
    where amount is not null
      and cast(order_date as date) <= current_date
  ),
  ranked as (
    select
      order_id,
      customer_id,
      cast(amount as double) as amount,
      cast(order_date as date) as order_date,
      row_number() over (partition by order_id order by order_date desc) as rn
    from cleaned
  )
  select * from ranked where rn = 1
)
-- PATCH_AREA_END

select * from patched
    );
  
  
[0m13:26:07.175876 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m13:26:07.197035 [debug] [Thread-1 (]: Using duckdb connection "model.pipeline_guardian.stg_orders"
[0m13:26:07.200459 [debug] [Thread-1 (]: On model.pipeline_guardian.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "model.pipeline_guardian.stg_orders"} */
alter table "demo"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m13:26:07.203572 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:26:07.214107 [debug] [Thread-1 (]: Using duckdb connection "model.pipeline_guardian.stg_orders"
[0m13:26:07.216671 [debug] [Thread-1 (]: On model.pipeline_guardian.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "model.pipeline_guardian.stg_orders"} */
alter table "demo"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m13:26:07.219816 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:26:07.265294 [debug] [Thread-1 (]: On model.pipeline_guardian.stg_orders: COMMIT
[0m13:26:07.268825 [debug] [Thread-1 (]: Using duckdb connection "model.pipeline_guardian.stg_orders"
[0m13:26:07.270827 [debug] [Thread-1 (]: On model.pipeline_guardian.stg_orders: COMMIT
[0m13:26:07.319100 [debug] [Thread-1 (]: SQL status: OK in 0.046 seconds
[0m13:26:07.335842 [debug] [Thread-1 (]: Using duckdb connection "model.pipeline_guardian.stg_orders"
[0m13:26:07.338589 [debug] [Thread-1 (]: On model.pipeline_guardian.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "model.pipeline_guardian.stg_orders"} */

      drop table if exists "demo"."main"."stg_orders__dbt_backup" cascade
    
[0m13:26:07.343706 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:26:07.352411 [debug] [Thread-1 (]: On model.pipeline_guardian.stg_orders: Close
[0m13:26:07.359978 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '947f4ed9-adc2-45ea-a410-89285248b54d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000138885D8EB0>]}
[0m13:26:07.363022 [info ] [Thread-1 (]: 1 of 2 OK created sql table model main.stg_orders .............................. [[32mOK[0m in 0.34s]
[0m13:26:07.365974 [debug] [Thread-1 (]: Finished running node model.pipeline_guardian.stg_orders
[0m13:26:07.369530 [debug] [Thread-3 (]: Began running node model.pipeline_guardian.orders_summary
[0m13:26:07.371533 [info ] [Thread-3 (]: 2 of 2 START sql table model main.orders_summary ............................... [RUN]
[0m13:26:07.373533 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.pipeline_guardian.orders_summary'
[0m13:26:07.375533 [debug] [Thread-3 (]: Began compiling node model.pipeline_guardian.orders_summary
[0m13:26:07.384086 [debug] [Thread-3 (]: Writing injected SQL for node "model.pipeline_guardian.orders_summary"
[0m13:26:07.388619 [debug] [Thread-3 (]: Began executing node model.pipeline_guardian.orders_summary
[0m13:26:07.400939 [debug] [Thread-3 (]: Writing runtime sql for node "model.pipeline_guardian.orders_summary"
[0m13:26:07.403933 [debug] [Thread-3 (]: Using duckdb connection "model.pipeline_guardian.orders_summary"
[0m13:26:07.406896 [debug] [Thread-3 (]: On model.pipeline_guardian.orders_summary: BEGIN
[0m13:26:07.408554 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:26:07.411492 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m13:26:07.413544 [debug] [Thread-3 (]: Using duckdb connection "model.pipeline_guardian.orders_summary"
[0m13:26:07.415492 [debug] [Thread-3 (]: On model.pipeline_guardian.orders_summary: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "model.pipeline_guardian.orders_summary"} */

  
    
    

    create  table
      "demo"."main"."orders_summary__dbt_tmp"
  
    as (
      select count(*) total_orders, sum(amount) total_revenue
from "demo"."main"."stg_orders"
    );
  
  
[0m13:26:07.419076 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m13:26:07.431759 [debug] [Thread-3 (]: Using duckdb connection "model.pipeline_guardian.orders_summary"
[0m13:26:07.433760 [debug] [Thread-3 (]: On model.pipeline_guardian.orders_summary: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "model.pipeline_guardian.orders_summary"} */
alter table "demo"."main"."orders_summary" rename to "orders_summary__dbt_backup"
[0m13:26:07.437549 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:26:07.448151 [debug] [Thread-3 (]: Using duckdb connection "model.pipeline_guardian.orders_summary"
[0m13:26:07.450092 [debug] [Thread-3 (]: On model.pipeline_guardian.orders_summary: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "model.pipeline_guardian.orders_summary"} */
alter table "demo"."main"."orders_summary__dbt_tmp" rename to "orders_summary"
[0m13:26:07.454134 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:26:07.459716 [debug] [Thread-3 (]: On model.pipeline_guardian.orders_summary: COMMIT
[0m13:26:07.462725 [debug] [Thread-3 (]: Using duckdb connection "model.pipeline_guardian.orders_summary"
[0m13:26:07.464677 [debug] [Thread-3 (]: On model.pipeline_guardian.orders_summary: COMMIT
[0m13:26:07.510446 [debug] [Thread-3 (]: SQL status: OK in 0.043 seconds
[0m13:26:07.520043 [debug] [Thread-3 (]: Using duckdb connection "model.pipeline_guardian.orders_summary"
[0m13:26:07.523041 [debug] [Thread-3 (]: On model.pipeline_guardian.orders_summary: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "model.pipeline_guardian.orders_summary"} */

      drop table if exists "demo"."main"."orders_summary__dbt_backup" cascade
    
[0m13:26:07.529682 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m13:26:07.534708 [debug] [Thread-3 (]: On model.pipeline_guardian.orders_summary: Close
[0m13:26:07.538214 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '947f4ed9-adc2-45ea-a410-89285248b54d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000138860AEEF0>]}
[0m13:26:07.541140 [info ] [Thread-3 (]: 2 of 2 OK created sql table model main.orders_summary .......................... [[32mOK[0m in 0.16s]
[0m13:26:07.545242 [debug] [Thread-3 (]: Finished running node model.pipeline_guardian.orders_summary
[0m13:26:07.551815 [debug] [MainThread]: Using duckdb connection "master"
[0m13:26:07.555809 [debug] [MainThread]: On master: BEGIN
[0m13:26:07.558380 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:26:07.562364 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m13:26:07.575926 [debug] [MainThread]: On master: COMMIT
[0m13:26:07.589031 [debug] [MainThread]: Using duckdb connection "master"
[0m13:26:07.594051 [debug] [MainThread]: On master: COMMIT
[0m13:26:07.599103 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m13:26:07.604124 [debug] [MainThread]: On master: Close
[0m13:26:07.608744 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:26:07.611663 [debug] [MainThread]: Connection 'create_demo_main' was properly closed.
[0m13:26:07.613665 [debug] [MainThread]: Connection 'list_demo_main' was properly closed.
[0m13:26:07.617185 [debug] [MainThread]: Connection 'model.pipeline_guardian.stg_orders' was properly closed.
[0m13:26:07.621204 [debug] [MainThread]: Connection 'model.pipeline_guardian.orders_summary' was properly closed.
[0m13:26:07.625311 [info ] [MainThread]: 
[0m13:26:07.629069 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 1.33 seconds (1.33s).
[0m13:26:07.633957 [debug] [MainThread]: Command end result
[0m13:26:07.713226 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\manifest.json
[0m13:26:07.722817 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\semantic_manifest.json
[0m13:26:07.745189 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\run_results.json
[0m13:26:07.747742 [info ] [MainThread]: 
[0m13:26:07.749737 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:26:07.751741 [info ] [MainThread]: 
[0m13:26:07.753743 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m13:26:07.758036 [debug] [MainThread]: Command `dbt run` succeeded at 13:26:07.756739 after 5.20 seconds
[0m13:26:07.760056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001388626E110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013888BEB280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013887585E70>]}
[0m13:26:07.761056 [debug] [MainThread]: Flushing usage events
[0m13:26:08.303364 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:26:16.093406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264716EE0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264739D8E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264739D8CA0>]}


============================== 13:26:16.102969 | 3a1426f9-f3f9-404d-b003-9b3a090c16bd ==============================
[0m13:26:16.102969 [info ] [MainThread]: Running with dbt=1.10.9
[0m13:26:16.104979 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'warn_error': 'None', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\likhi\\Downloads\\pipeline-guardian-v2-upload\\dbt\\logs', 'profiles_dir': 'C:\\Users\\likhi\\Downloads\\pipeline-guardian-v2-upload\\dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m13:26:16.825532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a1426f9-f3f9-404d-b003-9b3a090c16bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026473AF9690>]}
[0m13:26:17.023833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a1426f9-f3f9-404d-b003-9b3a090c16bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264731A7CA0>]}
[0m13:26:17.033987 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m13:26:18.362174 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m13:26:19.019565 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:26:19.022544 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:26:19.241940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a1426f9-f3f9-404d-b003-9b3a090c16bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264740505B0>]}
[0m13:26:19.615954 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\manifest.json
[0m13:26:19.624949 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\semantic_manifest.json
[0m13:26:19.862775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a1426f9-f3f9-404d-b003-9b3a090c16bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026473E43610>]}
[0m13:26:19.865774 [info ] [MainThread]: Found 2 models, 1 seed, 4 data tests, 1 source, 429 macros
[0m13:26:19.867298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a1426f9-f3f9-404d-b003-9b3a090c16bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026473E403D0>]}
[0m13:26:19.873323 [info ] [MainThread]: 
[0m13:26:19.875322 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:26:19.877870 [info ] [MainThread]: 
[0m13:26:19.881862 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:26:19.904981 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_demo_main'
[0m13:26:20.228984 [debug] [ThreadPool]: Using duckdb connection "list_demo_main"
[0m13:26:20.231977 [debug] [ThreadPool]: On list_demo_main: BEGIN
[0m13:26:20.233975 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:26:20.304177 [debug] [ThreadPool]: SQL status: OK in 0.070 seconds
[0m13:26:20.306775 [debug] [ThreadPool]: Using duckdb connection "list_demo_main"
[0m13:26:20.308900 [debug] [ThreadPool]: On list_demo_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "connection_name": "list_demo_main"} */
select
      'demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'demo'
  
[0m13:26:20.345873 [debug] [ThreadPool]: SQL status: OK in 0.035 seconds
[0m13:26:20.350624 [debug] [ThreadPool]: On list_demo_main: ROLLBACK
[0m13:26:20.354612 [debug] [ThreadPool]: Failed to rollback 'list_demo_main'
[0m13:26:20.355617 [debug] [ThreadPool]: On list_demo_main: Close
[0m13:26:20.360311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a1426f9-f3f9-404d-b003-9b3a090c16bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026473E43610>]}
[0m13:26:20.361360 [debug] [MainThread]: Using duckdb connection "master"
[0m13:26:20.363358 [debug] [MainThread]: On master: BEGIN
[0m13:26:20.365347 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:26:20.368091 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m13:26:20.370089 [debug] [MainThread]: On master: COMMIT
[0m13:26:20.371104 [debug] [MainThread]: Using duckdb connection "master"
[0m13:26:20.373096 [debug] [MainThread]: On master: COMMIT
[0m13:26:20.375096 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:26:20.377094 [debug] [MainThread]: On master: Close
[0m13:26:20.392703 [debug] [Thread-1 (]: Began running node test.pipeline_guardian.accepted_range_stg_orders_order_date___date_trunc_day_current_date_.2cf9901bb0
[0m13:26:20.394686 [debug] [Thread-2 (]: Began running node test.pipeline_guardian.not_null_stg_orders_amount.2546645448
[0m13:26:20.395732 [debug] [Thread-3 (]: Began running node test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64
[0m13:26:20.396739 [debug] [Thread-4 (]: Began running node test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a
[0m13:26:20.398008 [info ] [Thread-1 (]: 1 of 4 START test accepted_range_stg_orders_order_date___date_trunc_day_current_date_  [RUN]
[0m13:26:20.401010 [info ] [Thread-2 (]: 2 of 4 START test not_null_stg_orders_amount ................................... [RUN]
[0m13:26:20.404007 [info ] [Thread-3 (]: 3 of 4 START test not_null_stg_orders_order_id ................................. [RUN]
[0m13:26:20.406007 [info ] [Thread-4 (]: 4 of 4 START test unique_stg_orders_order_id ................................... [RUN]
[0m13:26:20.408544 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.pipeline_guardian.accepted_range_stg_orders_order_date___date_trunc_day_current_date_.2cf9901bb0'
[0m13:26:20.410540 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.pipeline_guardian.not_null_stg_orders_amount.2546645448'
[0m13:26:20.413073 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64'
[0m13:26:20.417082 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a'
[0m13:26:20.419645 [debug] [Thread-1 (]: Began compiling node test.pipeline_guardian.accepted_range_stg_orders_order_date___date_trunc_day_current_date_.2cf9901bb0
[0m13:26:20.421654 [debug] [Thread-2 (]: Began compiling node test.pipeline_guardian.not_null_stg_orders_amount.2546645448
[0m13:26:20.423647 [debug] [Thread-3 (]: Began compiling node test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64
[0m13:26:20.425780 [debug] [Thread-4 (]: Began compiling node test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a
[0m13:26:20.485455 [debug] [Thread-2 (]: Writing injected SQL for node "test.pipeline_guardian.not_null_stg_orders_amount.2546645448"
[0m13:26:20.497984 [debug] [Thread-3 (]: Writing injected SQL for node "test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:26:20.519214 [debug] [Thread-4 (]: Writing injected SQL for node "test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a"
[0m13:26:20.525197 [debug] [Thread-2 (]: Began executing node test.pipeline_guardian.not_null_stg_orders_amount.2546645448
[0m13:26:20.527888 [debug] [Thread-3 (]: Began executing node test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64
[0m13:26:20.538641 [debug] [Thread-4 (]: Began executing node test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a
[0m13:26:20.602525 [debug] [Thread-3 (]: Writing runtime sql for node "test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:26:20.612700 [debug] [Thread-2 (]: Writing runtime sql for node "test.pipeline_guardian.not_null_stg_orders_amount.2546645448"
[0m13:26:20.619371 [debug] [Thread-4 (]: Writing runtime sql for node "test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a"
[0m13:26:20.625381 [debug] [Thread-3 (]: Using duckdb connection "test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:26:20.628011 [debug] [Thread-2 (]: Using duckdb connection "test.pipeline_guardian.not_null_stg_orders_amount.2546645448"
[0m13:26:20.630021 [debug] [Thread-3 (]: On test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m13:26:20.633622 [debug] [Thread-4 (]: Using duckdb connection "test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a"
[0m13:26:20.636865 [debug] [Thread-2 (]: On test.pipeline_guardian.not_null_stg_orders_amount.2546645448: BEGIN
[0m13:26:20.638631 [debug] [Thread-1 (]: Compilation Error in test accepted_range_stg_orders_order_date___date_trunc_day_current_date_ (models\schema.yml)
  'current_date' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:26:20.640249 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:26:20.641987 [debug] [Thread-4 (]: On test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m13:26:20.643708 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:26:20.647093 [error] [Thread-1 (]: 1 of 4 ERROR accepted_range_stg_orders_order_date___date_trunc_day_current_date_  [[31mERROR[0m in 0.24s]
[0m13:26:20.651462 [debug] [Thread-3 (]: SQL status: OK in 0.011 seconds
[0m13:26:20.653149 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:26:20.671002 [debug] [Thread-2 (]: SQL status: OK in 0.026 seconds
[0m13:26:20.673008 [debug] [Thread-1 (]: Finished running node test.pipeline_guardian.accepted_range_stg_orders_order_date___date_trunc_day_current_date_.2cf9901bb0
[0m13:26:20.674903 [debug] [Thread-3 (]: Using duckdb connection "test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:26:20.678444 [debug] [Thread-4 (]: SQL status: OK in 0.025 seconds
[0m13:26:20.679442 [debug] [Thread-2 (]: Using duckdb connection "test.pipeline_guardian.not_null_stg_orders_amount.2546645448"
[0m13:26:20.682440 [debug] [Thread-7 (]: Marking all children of 'test.pipeline_guardian.accepted_range_stg_orders_order_date___date_trunc_day_current_date_.2cf9901bb0' to be skipped because of status 'error'.  Reason: Compilation Error in test accepted_range_stg_orders_order_date___date_trunc_day_current_date_ (models\schema.yml)
  'current_date' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:26:20.685442 [debug] [Thread-3 (]: On test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "demo"."main"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m13:26:20.686971 [debug] [Thread-4 (]: Using duckdb connection "test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a"
[0m13:26:20.689079 [debug] [Thread-2 (]: On test.pipeline_guardian.not_null_stg_orders_amount.2546645448: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "test.pipeline_guardian.not_null_stg_orders_amount.2546645448"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select amount
from "demo"."main"."stg_orders"
where amount is null



  
  
      
    ) dbt_internal_test
[0m13:26:20.696095 [debug] [Thread-4 (]: On test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "demo"."main"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:26:20.698179 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m13:26:20.702278 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m13:26:20.715647 [debug] [Thread-3 (]: On test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m13:26:20.717286 [debug] [Thread-4 (]: SQL status: OK in 0.016 seconds
[0m13:26:20.721416 [debug] [Thread-2 (]: On test.pipeline_guardian.not_null_stg_orders_amount.2546645448: ROLLBACK
[0m13:26:20.723426 [debug] [Thread-3 (]: Failed to rollback 'test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64'
[0m13:26:20.728021 [debug] [Thread-4 (]: On test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m13:26:20.730116 [debug] [Thread-2 (]: Failed to rollback 'test.pipeline_guardian.not_null_stg_orders_amount.2546645448'
[0m13:26:20.732006 [debug] [Thread-3 (]: On test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m13:26:20.734114 [debug] [Thread-4 (]: Failed to rollback 'test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a'
[0m13:26:20.736119 [debug] [Thread-2 (]: On test.pipeline_guardian.not_null_stg_orders_amount.2546645448: Close
[0m13:26:20.738470 [info ] [Thread-3 (]: 3 of 4 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 0.33s]
[0m13:26:20.740472 [debug] [Thread-4 (]: On test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a: Close
[0m13:26:20.742471 [info ] [Thread-2 (]: 2 of 4 PASS not_null_stg_orders_amount ......................................... [[32mPASS[0m in 0.33s]
[0m13:26:20.745471 [debug] [Thread-3 (]: Finished running node test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64
[0m13:26:20.748005 [info ] [Thread-4 (]: 4 of 4 PASS unique_stg_orders_order_id ......................................... [[32mPASS[0m in 0.33s]
[0m13:26:20.750030 [debug] [Thread-2 (]: Finished running node test.pipeline_guardian.not_null_stg_orders_amount.2546645448
[0m13:26:20.754035 [debug] [Thread-4 (]: Finished running node test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a
[0m13:26:20.760564 [debug] [MainThread]: Using duckdb connection "master"
[0m13:26:20.762568 [debug] [MainThread]: On master: BEGIN
[0m13:26:20.764566 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:26:20.768110 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m13:26:20.770105 [debug] [MainThread]: On master: COMMIT
[0m13:26:20.772102 [debug] [MainThread]: Using duckdb connection "master"
[0m13:26:20.774106 [debug] [MainThread]: On master: COMMIT
[0m13:26:20.775167 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:26:20.777895 [debug] [MainThread]: On master: Close
[0m13:26:20.780797 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:26:20.781800 [debug] [MainThread]: Connection 'list_demo_main' was properly closed.
[0m13:26:20.783850 [debug] [MainThread]: Connection 'test.pipeline_guardian.accepted_range_stg_orders_order_date___date_trunc_day_current_date_.2cf9901bb0' was properly closed.
[0m13:26:20.784913 [debug] [MainThread]: Connection 'test.pipeline_guardian.not_null_stg_orders_amount.2546645448' was properly closed.
[0m13:26:20.787228 [debug] [MainThread]: Connection 'test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64' was properly closed.
[0m13:26:20.789399 [debug] [MainThread]: Connection 'test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m13:26:20.790397 [info ] [MainThread]: 
[0m13:26:20.792399 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 0.91 seconds (0.91s).
[0m13:26:20.797935 [debug] [MainThread]: Command end result
[0m13:26:20.881019 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\manifest.json
[0m13:26:20.889680 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\semantic_manifest.json
[0m13:26:20.917289 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\run_results.json
[0m13:26:20.920368 [info ] [MainThread]: 
[0m13:26:20.921350 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:26:20.924354 [info ] [MainThread]: 
[0m13:26:20.925350 [error] [MainThread]: [31mFailure in test accepted_range_stg_orders_order_date___date_trunc_day_current_date_ (models\schema.yml)[0m
[0m13:26:20.928927 [error] [MainThread]:   Compilation Error in test accepted_range_stg_orders_order_date___date_trunc_day_current_date_ (models\schema.yml)
  'current_date' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:26:20.930945 [info ] [MainThread]: 
[0m13:26:20.933947 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m13:26:20.938521 [debug] [MainThread]: Command `dbt test` failed at 13:26:20.937519 after 5.09 seconds
[0m13:26:20.939524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264716EE0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264755F81F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264755F81C0>]}
[0m13:26:20.941568 [debug] [MainThread]: Flushing usage events
[0m13:26:21.584702 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:28:15.709033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228940EA110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228963D8D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228963D8BB0>]}


============================== 13:28:15.717508 | e8391825-6b37-4272-8054-2aa61e32a582 ==============================
[0m13:28:15.717508 [info ] [MainThread]: Running with dbt=1.10.9
[0m13:28:15.719187 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt seed --full-refresh', 'log_format': 'default', 'use_colors': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_path': 'C:\\Users\\likhi\\Downloads\\pipeline-guardian-v2-upload\\dbt\\logs', 'profiles_dir': 'C:\\Users\\likhi\\Downloads\\pipeline-guardian-v2-upload\\dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m13:28:16.397022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8391825-6b37-4272-8054-2aa61e32a582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228954B4AF0>]}
[0m13:28:16.589783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8391825-6b37-4272-8054-2aa61e32a582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022895B66500>]}
[0m13:28:16.598183 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m13:28:17.816359 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m13:28:18.520207 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m13:28:18.522121 [debug] [MainThread]: Partial parsing: added file: pipeline_guardian://seeds\orders_with_errors.csv
[0m13:28:19.421587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8391825-6b37-4272-8054-2aa61e32a582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022896A1DB10>]}
[0m13:28:19.768150 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\manifest.json
[0m13:28:19.777795 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\semantic_manifest.json
[0m13:28:19.884024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8391825-6b37-4272-8054-2aa61e32a582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022897ACA500>]}
[0m13:28:19.887133 [info ] [MainThread]: Found 2 models, 2 seeds, 4 data tests, 1 source, 429 macros
[0m13:28:19.889126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8391825-6b37-4272-8054-2aa61e32a582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022897A00B20>]}
[0m13:28:19.894127 [info ] [MainThread]: 
[0m13:28:19.896641 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:28:19.899672 [info ] [MainThread]: 
[0m13:28:19.903674 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:28:19.924300 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_demo'
[0m13:28:20.226828 [debug] [ThreadPool]: Using duckdb connection "list_demo"
[0m13:28:20.228854 [debug] [ThreadPool]: On list_demo: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "connection_name": "list_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"demo"'
    
  
  
[0m13:28:20.229838 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:28:20.280210 [debug] [ThreadPool]: SQL status: OK in 0.051 seconds
[0m13:28:20.288880 [debug] [ThreadPool]: On list_demo: Close
[0m13:28:20.291960 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_demo, now create_demo_main)
[0m13:28:20.293957 [debug] [ThreadPool]: Creating schema "database: "demo"
schema: "main"
"
[0m13:28:20.313133 [debug] [ThreadPool]: Using duckdb connection "create_demo_main"
[0m13:28:20.314702 [debug] [ThreadPool]: On create_demo_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "connection_name": "create_demo_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='demo'
        and type='sqlite'
    
  
[0m13:28:20.317523 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:28:20.320568 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m13:28:20.326084 [debug] [ThreadPool]: Using duckdb connection "create_demo_main"
[0m13:28:20.328203 [debug] [ThreadPool]: On create_demo_main: BEGIN
[0m13:28:20.331102 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:28:20.332202 [debug] [ThreadPool]: Using duckdb connection "create_demo_main"
[0m13:28:20.334199 [debug] [ThreadPool]: On create_demo_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "connection_name": "create_demo_main"} */

    
    
        create schema if not exists "demo"."main"
    
[0m13:28:20.337642 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:28:20.341730 [debug] [ThreadPool]: On create_demo_main: COMMIT
[0m13:28:20.343735 [debug] [ThreadPool]: Using duckdb connection "create_demo_main"
[0m13:28:20.344726 [debug] [ThreadPool]: On create_demo_main: COMMIT
[0m13:28:20.348323 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:28:20.350364 [debug] [ThreadPool]: On create_demo_main: Close
[0m13:28:20.355863 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_demo_main'
[0m13:28:20.373716 [debug] [ThreadPool]: Using duckdb connection "list_demo_main"
[0m13:28:20.376283 [debug] [ThreadPool]: On list_demo_main: BEGIN
[0m13:28:20.378424 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:28:20.380299 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m13:28:20.382301 [debug] [ThreadPool]: Using duckdb connection "list_demo_main"
[0m13:28:20.384401 [debug] [ThreadPool]: On list_demo_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "connection_name": "list_demo_main"} */
select
      'demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'demo'
  
[0m13:28:20.420588 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m13:28:20.424578 [debug] [ThreadPool]: On list_demo_main: ROLLBACK
[0m13:28:20.427237 [debug] [ThreadPool]: Failed to rollback 'list_demo_main'
[0m13:28:20.429235 [debug] [ThreadPool]: On list_demo_main: Close
[0m13:28:20.433288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8391825-6b37-4272-8054-2aa61e32a582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022897A9A380>]}
[0m13:28:20.434328 [debug] [MainThread]: Using duckdb connection "master"
[0m13:28:20.436987 [debug] [MainThread]: On master: BEGIN
[0m13:28:20.438964 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:28:20.441078 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m13:28:20.442070 [debug] [MainThread]: On master: COMMIT
[0m13:28:20.444030 [debug] [MainThread]: Using duckdb connection "master"
[0m13:28:20.445980 [debug] [MainThread]: On master: COMMIT
[0m13:28:20.447506 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:28:20.450506 [debug] [MainThread]: On master: Close
[0m13:28:20.464191 [debug] [Thread-1 (]: Began running node seed.pipeline_guardian.orders
[0m13:28:20.465191 [debug] [Thread-2 (]: Began running node seed.pipeline_guardian.orders_with_errors
[0m13:28:20.467748 [info ] [Thread-1 (]: 1 of 2 START seed file main.orders ............................................. [RUN]
[0m13:28:20.469743 [info ] [Thread-2 (]: 2 of 2 START seed file main.orders_with_errors ................................. [RUN]
[0m13:28:20.472742 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.pipeline_guardian.orders'
[0m13:28:20.474745 [debug] [Thread-2 (]: Acquiring new duckdb connection 'seed.pipeline_guardian.orders_with_errors'
[0m13:28:20.475787 [debug] [Thread-1 (]: Began compiling node seed.pipeline_guardian.orders
[0m13:28:20.478307 [debug] [Thread-2 (]: Began compiling node seed.pipeline_guardian.orders_with_errors
[0m13:28:20.480620 [debug] [Thread-1 (]: Began executing node seed.pipeline_guardian.orders
[0m13:28:20.484648 [debug] [Thread-2 (]: Began executing node seed.pipeline_guardian.orders_with_errors
[0m13:28:20.591966 [debug] [Thread-2 (]: Using duckdb connection "seed.pipeline_guardian.orders_with_errors"
[0m13:28:20.603077 [debug] [Thread-1 (]: Using duckdb connection "seed.pipeline_guardian.orders"
[0m13:28:20.605078 [debug] [Thread-2 (]: On seed.pipeline_guardian.orders_with_errors: BEGIN
[0m13:28:20.607754 [debug] [Thread-1 (]: On seed.pipeline_guardian.orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "seed.pipeline_guardian.orders"} */

      drop table if exists "demo"."main"."orders" cascade
    
[0m13:28:20.609734 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:28:20.611746 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:28:20.615295 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m13:28:20.618980 [debug] [Thread-2 (]: Using duckdb connection "seed.pipeline_guardian.orders_with_errors"
[0m13:28:20.621332 [debug] [Thread-2 (]: On seed.pipeline_guardian.orders_with_errors: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "seed.pipeline_guardian.orders_with_errors"} */

    create table "demo"."main"."orders_with_errors" ("order_id" integer,"customer_id" text,"amount" text,"order_date" text)
  
[0m13:28:20.663832 [debug] [Thread-1 (]: SQL status: OK in 0.052 seconds
[0m13:28:20.666117 [debug] [Thread-2 (]: SQL status: OK in 0.043 seconds
[0m13:28:20.671592 [debug] [Thread-1 (]: Using duckdb connection "seed.pipeline_guardian.orders"
[0m13:28:20.706514 [debug] [Thread-2 (]: Using duckdb connection "seed.pipeline_guardian.orders_with_errors"
[0m13:28:20.707554 [debug] [Thread-1 (]: On seed.pipeline_guardian.orders: BEGIN
[0m13:28:20.710560 [debug] [Thread-2 (]: On seed.pipeline_guardian.orders_with_errors: 
          COPY "demo"."main"."orders_with_errors" FROM 'C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\seeds\orders_with_errors.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m13:28:20.713515 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:28:20.715536 [debug] [Thread-1 (]: Using duckdb connection "seed.pipeline_guardian.orders"
[0m13:28:20.717157 [debug] [Thread-1 (]: On seed.pipeline_guardian.orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "seed.pipeline_guardian.orders"} */

    create table "demo"."main"."orders" ("order_id" integer,"customer_id" text,"amount" float8,"order_date" date)
  
[0m13:28:20.720153 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:28:20.725145 [debug] [Thread-1 (]: Using duckdb connection "seed.pipeline_guardian.orders"
[0m13:28:20.726659 [debug] [Thread-1 (]: On seed.pipeline_guardian.orders: 
          COPY "demo"."main"."orders" FROM 'C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\seeds\orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m13:28:20.728697 [debug] [Thread-2 (]: SQL status: OK in 0.014 seconds
[0m13:28:20.747961 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.pipeline_guardian.orders_with_errors"
[0m13:28:20.749908 [debug] [Thread-1 (]: SQL status: OK in 0.019 seconds
[0m13:28:20.752928 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.pipeline_guardian.orders"
[0m13:28:20.791843 [debug] [Thread-2 (]: On seed.pipeline_guardian.orders_with_errors: COMMIT
[0m13:28:20.793710 [debug] [Thread-2 (]: Using duckdb connection "seed.pipeline_guardian.orders_with_errors"
[0m13:28:20.796735 [debug] [Thread-2 (]: On seed.pipeline_guardian.orders_with_errors: COMMIT
[0m13:28:20.807280 [debug] [Thread-1 (]: On seed.pipeline_guardian.orders: COMMIT
[0m13:28:20.810511 [debug] [Thread-1 (]: Using duckdb connection "seed.pipeline_guardian.orders"
[0m13:28:20.852667 [debug] [Thread-1 (]: On seed.pipeline_guardian.orders: COMMIT
[0m13:28:20.854673 [debug] [Thread-2 (]: SQL status: OK in 0.046 seconds
[0m13:28:20.862330 [debug] [Thread-2 (]: On seed.pipeline_guardian.orders_with_errors: Close
[0m13:28:20.864331 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m13:28:20.871979 [debug] [Thread-1 (]: On seed.pipeline_guardian.orders: Close
[0m13:28:20.875870 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8391825-6b37-4272-8054-2aa61e32a582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002289265B1C0>]}
[0m13:28:20.876492 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8391825-6b37-4272-8054-2aa61e32a582', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022897FC0130>]}
[0m13:28:20.878564 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file main.orders_with_errors ............................. [[32mCREATE 5[0m in 0.39s]
[0m13:28:20.881492 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file main.orders ......................................... [[32mCREATE 12[0m in 0.40s]
[0m13:28:20.884497 [debug] [Thread-2 (]: Finished running node seed.pipeline_guardian.orders_with_errors
[0m13:28:20.887027 [debug] [Thread-1 (]: Finished running node seed.pipeline_guardian.orders
[0m13:28:20.892047 [debug] [MainThread]: Using duckdb connection "master"
[0m13:28:20.894047 [debug] [MainThread]: On master: BEGIN
[0m13:28:20.895048 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:28:20.897579 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m13:28:20.899594 [debug] [MainThread]: On master: COMMIT
[0m13:28:20.901590 [debug] [MainThread]: Using duckdb connection "master"
[0m13:28:20.903596 [debug] [MainThread]: On master: COMMIT
[0m13:28:20.906105 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:28:20.908119 [debug] [MainThread]: On master: Close
[0m13:28:20.910130 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:28:20.911130 [debug] [MainThread]: Connection 'create_demo_main' was properly closed.
[0m13:28:20.913131 [debug] [MainThread]: Connection 'list_demo_main' was properly closed.
[0m13:28:20.914128 [debug] [MainThread]: Connection 'seed.pipeline_guardian.orders' was properly closed.
[0m13:28:20.915731 [debug] [MainThread]: Connection 'seed.pipeline_guardian.orders_with_errors' was properly closed.
[0m13:28:20.917808 [info ] [MainThread]: 
[0m13:28:20.918872 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 1.02 seconds (1.02s).
[0m13:28:20.922748 [debug] [MainThread]: Command end result
[0m13:28:20.994847 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\manifest.json
[0m13:28:21.003580 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\semantic_manifest.json
[0m13:28:21.025044 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\run_results.json
[0m13:28:21.027689 [info ] [MainThread]: 
[0m13:28:21.029676 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:28:21.031671 [info ] [MainThread]: 
[0m13:28:21.032676 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m13:28:21.036183 [debug] [MainThread]: Command `dbt seed` succeeded at 13:28:21.034669 after 5.57 seconds
[0m13:28:21.038197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228940EA110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022897FCA410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022897FCA3E0>]}
[0m13:28:21.039193 [debug] [MainThread]: Flushing usage events
[0m13:28:21.684998 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:28:32.843200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002522D2860B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002522F4F4CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002522F4F4AF0>]}


============================== 13:28:32.852698 | 5d5ead4f-0c68-457f-8b82-545a73758739 ==============================
[0m13:28:32.852698 [info ] [MainThread]: Running with dbt=1.10.9
[0m13:28:32.854297 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'printer_width': '80', 'log_path': 'C:\\Users\\likhi\\Downloads\\pipeline-guardian-v2-upload\\dbt\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\likhi\\Downloads\\pipeline-guardian-v2-upload\\dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True'}
[0m13:28:33.540744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d5ead4f-0c68-457f-8b82-545a73758739', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002522F5F4250>]}
[0m13:28:33.737529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d5ead4f-0c68-457f-8b82-545a73758739', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002522EC512D0>]}
[0m13:28:33.747725 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m13:28:34.872839 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m13:28:35.554338 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:28:35.555846 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:28:35.763189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d5ead4f-0c68-457f-8b82-545a73758739', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002522FB7FF70>]}
[0m13:28:36.125924 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\manifest.json
[0m13:28:36.135055 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\semantic_manifest.json
[0m13:28:36.238277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d5ead4f-0c68-457f-8b82-545a73758739', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002522FB11840>]}
[0m13:28:36.240276 [info ] [MainThread]: Found 2 models, 2 seeds, 4 data tests, 1 source, 429 macros
[0m13:28:36.242279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d5ead4f-0c68-457f-8b82-545a73758739', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002522FB7E110>]}
[0m13:28:36.247815 [info ] [MainThread]: 
[0m13:28:36.249824 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:28:36.251818 [info ] [MainThread]: 
[0m13:28:36.253820 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:28:36.273903 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_demo'
[0m13:28:36.692700 [debug] [ThreadPool]: Using duckdb connection "list_demo"
[0m13:28:36.694657 [debug] [ThreadPool]: On list_demo: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "connection_name": "list_demo"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"demo"'
    
  
  
[0m13:28:36.697182 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:28:36.764933 [debug] [ThreadPool]: SQL status: OK in 0.067 seconds
[0m13:28:36.769220 [debug] [ThreadPool]: On list_demo: Close
[0m13:28:36.772221 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_demo, now create_demo_main)
[0m13:28:36.774217 [debug] [ThreadPool]: Creating schema "database: "demo"
schema: "main"
"
[0m13:28:36.794488 [debug] [ThreadPool]: Using duckdb connection "create_demo_main"
[0m13:28:36.797011 [debug] [ThreadPool]: On create_demo_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "connection_name": "create_demo_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='demo'
        and type='sqlite'
    
  
[0m13:28:36.799011 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:28:36.803025 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m13:28:36.807757 [debug] [ThreadPool]: Using duckdb connection "create_demo_main"
[0m13:28:36.809449 [debug] [ThreadPool]: On create_demo_main: BEGIN
[0m13:28:36.812386 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:28:36.813385 [debug] [ThreadPool]: Using duckdb connection "create_demo_main"
[0m13:28:36.814389 [debug] [ThreadPool]: On create_demo_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "connection_name": "create_demo_main"} */

    
    
        create schema if not exists "demo"."main"
    
[0m13:28:36.818030 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:28:36.821914 [debug] [ThreadPool]: On create_demo_main: COMMIT
[0m13:28:36.823016 [debug] [ThreadPool]: Using duckdb connection "create_demo_main"
[0m13:28:36.825020 [debug] [ThreadPool]: On create_demo_main: COMMIT
[0m13:28:36.827544 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:28:36.829534 [debug] [ThreadPool]: On create_demo_main: Close
[0m13:28:36.833647 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_demo_main'
[0m13:28:36.857454 [debug] [ThreadPool]: Using duckdb connection "list_demo_main"
[0m13:28:36.859572 [debug] [ThreadPool]: On list_demo_main: BEGIN
[0m13:28:36.861559 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:28:36.863445 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m13:28:36.866056 [debug] [ThreadPool]: Using duckdb connection "list_demo_main"
[0m13:28:36.867079 [debug] [ThreadPool]: On list_demo_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "connection_name": "list_demo_main"} */
select
      'demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'demo'
  
[0m13:28:36.901962 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m13:28:36.906703 [debug] [ThreadPool]: On list_demo_main: ROLLBACK
[0m13:28:36.910387 [debug] [ThreadPool]: Failed to rollback 'list_demo_main'
[0m13:28:36.912386 [debug] [ThreadPool]: On list_demo_main: Close
[0m13:28:36.916920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d5ead4f-0c68-457f-8b82-545a73758739', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002522F5F7C10>]}
[0m13:28:36.918914 [debug] [MainThread]: Using duckdb connection "master"
[0m13:28:36.919921 [debug] [MainThread]: On master: BEGIN
[0m13:28:36.921914 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:28:36.924022 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m13:28:36.926576 [debug] [MainThread]: On master: COMMIT
[0m13:28:36.927579 [debug] [MainThread]: Using duckdb connection "master"
[0m13:28:36.930587 [debug] [MainThread]: On master: COMMIT
[0m13:28:36.933579 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:28:36.934578 [debug] [MainThread]: On master: Close
[0m13:28:36.950509 [debug] [Thread-1 (]: Began running node model.pipeline_guardian.stg_orders
[0m13:28:36.952511 [info ] [Thread-1 (]: 1 of 2 START sql table model main.stg_orders ................................... [RUN]
[0m13:28:36.954508 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.pipeline_guardian.stg_orders'
[0m13:28:36.957307 [debug] [Thread-1 (]: Began compiling node model.pipeline_guardian.stg_orders
[0m13:28:36.979323 [debug] [Thread-1 (]: Writing injected SQL for node "model.pipeline_guardian.stg_orders"
[0m13:28:36.982320 [debug] [Thread-1 (]: Began executing node model.pipeline_guardian.stg_orders
[0m13:28:37.078874 [debug] [Thread-1 (]: Writing runtime sql for node "model.pipeline_guardian.stg_orders"
[0m13:28:37.082946 [debug] [Thread-1 (]: Using duckdb connection "model.pipeline_guardian.stg_orders"
[0m13:28:37.084888 [debug] [Thread-1 (]: On model.pipeline_guardian.stg_orders: BEGIN
[0m13:28:37.087504 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:28:37.090459 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:28:37.092468 [debug] [Thread-1 (]: Using duckdb connection "model.pipeline_guardian.stg_orders"
[0m13:28:37.094470 [debug] [Thread-1 (]: On model.pipeline_guardian.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "model.pipeline_guardian.stg_orders"} */

  
    
    

    create  table
      "demo"."main"."stg_orders__dbt_tmp"
  
    as (
      with source as (
    select * from "demo"."main"."orders"
),

-- PATCH_AREA_START
patched as (
  with cleaned as (
    select *
    from source
    where amount is not null
      and cast(order_date as date) <= current_date
  ),
  ranked as (
    select
      order_id,
      customer_id,
      cast(amount as double) as amount,
      cast(order_date as date) as order_date,
      row_number() over (partition by order_id order by order_date desc) as rn
    from cleaned
  )
  select * from ranked where rn = 1
)
-- PATCH_AREA_END

select * from patched
    );
  
  
[0m13:28:37.114091 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m13:28:37.135760 [debug] [Thread-1 (]: Using duckdb connection "model.pipeline_guardian.stg_orders"
[0m13:28:37.137777 [debug] [Thread-1 (]: On model.pipeline_guardian.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "model.pipeline_guardian.stg_orders"} */
alter table "demo"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m13:28:37.140841 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:28:37.151468 [debug] [Thread-1 (]: Using duckdb connection "model.pipeline_guardian.stg_orders"
[0m13:28:37.153406 [debug] [Thread-1 (]: On model.pipeline_guardian.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "model.pipeline_guardian.stg_orders"} */
alter table "demo"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m13:28:37.156033 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:28:37.201420 [debug] [Thread-1 (]: On model.pipeline_guardian.stg_orders: COMMIT
[0m13:28:37.203456 [debug] [Thread-1 (]: Using duckdb connection "model.pipeline_guardian.stg_orders"
[0m13:28:37.205948 [debug] [Thread-1 (]: On model.pipeline_guardian.stg_orders: COMMIT
[0m13:28:37.253943 [debug] [Thread-1 (]: SQL status: OK in 0.046 seconds
[0m13:28:37.271448 [debug] [Thread-1 (]: Using duckdb connection "model.pipeline_guardian.stg_orders"
[0m13:28:37.273331 [debug] [Thread-1 (]: On model.pipeline_guardian.stg_orders: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "model.pipeline_guardian.stg_orders"} */

      drop table if exists "demo"."main"."stg_orders__dbt_backup" cascade
    
[0m13:28:37.278385 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:28:37.286928 [debug] [Thread-1 (]: On model.pipeline_guardian.stg_orders: Close
[0m13:28:37.293922 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d5ead4f-0c68-457f-8b82-545a73758739', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002522F5AB910>]}
[0m13:28:37.297531 [info ] [Thread-1 (]: 1 of 2 OK created sql table model main.stg_orders .............................. [[32mOK[0m in 0.33s]
[0m13:28:37.299514 [debug] [Thread-1 (]: Finished running node model.pipeline_guardian.stg_orders
[0m13:28:37.302469 [debug] [Thread-3 (]: Began running node model.pipeline_guardian.orders_summary
[0m13:28:37.304466 [info ] [Thread-3 (]: 2 of 2 START sql table model main.orders_summary ............................... [RUN]
[0m13:28:37.307001 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.pipeline_guardian.orders_summary'
[0m13:28:37.308520 [debug] [Thread-3 (]: Began compiling node model.pipeline_guardian.orders_summary
[0m13:28:37.318072 [debug] [Thread-3 (]: Writing injected SQL for node "model.pipeline_guardian.orders_summary"
[0m13:28:37.322176 [debug] [Thread-3 (]: Began executing node model.pipeline_guardian.orders_summary
[0m13:28:37.332919 [debug] [Thread-3 (]: Writing runtime sql for node "model.pipeline_guardian.orders_summary"
[0m13:28:37.336545 [debug] [Thread-3 (]: Using duckdb connection "model.pipeline_guardian.orders_summary"
[0m13:28:37.338646 [debug] [Thread-3 (]: On model.pipeline_guardian.orders_summary: BEGIN
[0m13:28:37.341654 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:28:37.343656 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m13:28:37.346166 [debug] [Thread-3 (]: Using duckdb connection "model.pipeline_guardian.orders_summary"
[0m13:28:37.348293 [debug] [Thread-3 (]: On model.pipeline_guardian.orders_summary: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "model.pipeline_guardian.orders_summary"} */

  
    
    

    create  table
      "demo"."main"."orders_summary__dbt_tmp"
  
    as (
      select count(*) total_orders, sum(amount) total_revenue
from "demo"."main"."stg_orders"
    );
  
  
[0m13:28:37.352282 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m13:28:37.363870 [debug] [Thread-3 (]: Using duckdb connection "model.pipeline_guardian.orders_summary"
[0m13:28:37.365873 [debug] [Thread-3 (]: On model.pipeline_guardian.orders_summary: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "model.pipeline_guardian.orders_summary"} */
alter table "demo"."main"."orders_summary" rename to "orders_summary__dbt_backup"
[0m13:28:37.369020 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:28:37.377879 [debug] [Thread-3 (]: Using duckdb connection "model.pipeline_guardian.orders_summary"
[0m13:28:37.381185 [debug] [Thread-3 (]: On model.pipeline_guardian.orders_summary: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "model.pipeline_guardian.orders_summary"} */
alter table "demo"."main"."orders_summary__dbt_tmp" rename to "orders_summary"
[0m13:28:37.382764 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:28:37.390198 [debug] [Thread-3 (]: On model.pipeline_guardian.orders_summary: COMMIT
[0m13:28:37.392087 [debug] [Thread-3 (]: Using duckdb connection "model.pipeline_guardian.orders_summary"
[0m13:28:37.394208 [debug] [Thread-3 (]: On model.pipeline_guardian.orders_summary: COMMIT
[0m13:28:37.399642 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m13:28:37.407386 [debug] [Thread-3 (]: Using duckdb connection "model.pipeline_guardian.orders_summary"
[0m13:28:37.409127 [debug] [Thread-3 (]: On model.pipeline_guardian.orders_summary: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "model.pipeline_guardian.orders_summary"} */

      drop table if exists "demo"."main"."orders_summary__dbt_backup" cascade
    
[0m13:28:37.415141 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m13:28:37.419989 [debug] [Thread-3 (]: On model.pipeline_guardian.orders_summary: Close
[0m13:28:37.422978 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d5ead4f-0c68-457f-8b82-545a73758739', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002523104F310>]}
[0m13:28:37.424982 [info ] [Thread-3 (]: 2 of 2 OK created sql table model main.orders_summary .......................... [[32mOK[0m in 0.12s]
[0m13:28:37.427104 [debug] [Thread-3 (]: Finished running node model.pipeline_guardian.orders_summary
[0m13:28:37.432097 [debug] [MainThread]: Using duckdb connection "master"
[0m13:28:37.433096 [debug] [MainThread]: On master: BEGIN
[0m13:28:37.435099 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:28:37.437627 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m13:28:37.438734 [debug] [MainThread]: On master: COMMIT
[0m13:28:37.440641 [debug] [MainThread]: Using duckdb connection "master"
[0m13:28:37.442645 [debug] [MainThread]: On master: COMMIT
[0m13:28:37.444748 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:28:37.446152 [debug] [MainThread]: On master: Close
[0m13:28:37.448175 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:28:37.449180 [debug] [MainThread]: Connection 'create_demo_main' was properly closed.
[0m13:28:37.451168 [debug] [MainThread]: Connection 'list_demo_main' was properly closed.
[0m13:28:37.452280 [debug] [MainThread]: Connection 'model.pipeline_guardian.stg_orders' was properly closed.
[0m13:28:37.453282 [debug] [MainThread]: Connection 'model.pipeline_guardian.orders_summary' was properly closed.
[0m13:28:37.455279 [info ] [MainThread]: 
[0m13:28:37.456940 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 1.20 seconds (1.20s).
[0m13:28:37.459929 [debug] [MainThread]: Command end result
[0m13:28:37.522302 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\manifest.json
[0m13:28:37.531155 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\semantic_manifest.json
[0m13:28:37.553322 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\run_results.json
[0m13:28:37.555881 [info ] [MainThread]: 
[0m13:28:37.557896 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:28:37.559897 [info ] [MainThread]: 
[0m13:28:37.560899 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m13:28:37.565897 [debug] [MainThread]: Command `dbt run` succeeded at 13:28:37.564896 after 4.97 seconds
[0m13:28:37.567429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002522D2860B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002522E524FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002522FB3CB50>]}
[0m13:28:37.569445 [debug] [MainThread]: Flushing usage events
[0m13:28:38.077711 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:28:46.762369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AA171A0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AA3A08E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AA3A08CA0>]}


============================== 13:28:46.771468 | 1b8d41e1-856d-45b0-98cc-1d0b3413e21c ==============================
[0m13:28:46.771468 [info ] [MainThread]: Running with dbt=1.10.9
[0m13:28:46.773124 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'use_colors': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'version_check': 'True', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'None', 'log_cache_events': 'False', 'quiet': 'False', 'log_path': 'C:\\Users\\likhi\\Downloads\\pipeline-guardian-v2-upload\\dbt\\logs', 'indirect_selection': 'eager', 'profiles_dir': 'C:\\Users\\likhi\\Downloads\\pipeline-guardian-v2-upload\\dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m13:28:47.446304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b8d41e1-856d-45b0-98cc-1d0b3413e21c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AA3B29B40>]}
[0m13:28:47.637036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b8d41e1-856d-45b0-98cc-1d0b3413e21c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AA31D7CA0>]}
[0m13:28:47.646041 [info ] [MainThread]: Registered adapter: duckdb=1.9.4
[0m13:28:48.766566 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m13:28:49.428733 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:28:49.430743 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:28:49.654252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b8d41e1-856d-45b0-98cc-1d0b3413e21c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AA408BE50>]}
[0m13:28:50.008861 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\manifest.json
[0m13:28:50.016479 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\semantic_manifest.json
[0m13:28:50.279894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b8d41e1-856d-45b0-98cc-1d0b3413e21c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AA3E5B4F0>]}
[0m13:28:50.282000 [info ] [MainThread]: Found 2 models, 2 seeds, 4 data tests, 1 source, 429 macros
[0m13:28:50.283893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b8d41e1-856d-45b0-98cc-1d0b3413e21c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AA3E59810>]}
[0m13:28:50.289438 [info ] [MainThread]: 
[0m13:28:50.291444 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:28:50.292444 [info ] [MainThread]: 
[0m13:28:50.294445 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:28:50.316036 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_demo_main'
[0m13:28:50.625177 [debug] [ThreadPool]: Using duckdb connection "list_demo_main"
[0m13:28:50.627744 [debug] [ThreadPool]: On list_demo_main: BEGIN
[0m13:28:50.629703 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:28:50.691653 [debug] [ThreadPool]: SQL status: OK in 0.062 seconds
[0m13:28:50.693663 [debug] [ThreadPool]: Using duckdb connection "list_demo_main"
[0m13:28:50.694670 [debug] [ThreadPool]: On list_demo_main: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "connection_name": "list_demo_main"} */
select
      'demo' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'demo'
  
[0m13:28:50.733536 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m13:28:50.737886 [debug] [ThreadPool]: On list_demo_main: ROLLBACK
[0m13:28:50.740884 [debug] [ThreadPool]: Failed to rollback 'list_demo_main'
[0m13:28:50.741888 [debug] [ThreadPool]: On list_demo_main: Close
[0m13:28:50.747402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b8d41e1-856d-45b0-98cc-1d0b3413e21c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AA3E730D0>]}
[0m13:28:50.749450 [debug] [MainThread]: Using duckdb connection "master"
[0m13:28:50.751727 [debug] [MainThread]: On master: BEGIN
[0m13:28:50.752777 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:28:50.754764 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m13:28:50.756318 [debug] [MainThread]: On master: COMMIT
[0m13:28:50.758366 [debug] [MainThread]: Using duckdb connection "master"
[0m13:28:50.760390 [debug] [MainThread]: On master: COMMIT
[0m13:28:50.763379 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:28:50.764370 [debug] [MainThread]: On master: Close
[0m13:28:50.782331 [debug] [Thread-1 (]: Began running node test.pipeline_guardian.accepted_range_stg_orders_order_date___date_trunc_day_current_date_.2cf9901bb0
[0m13:28:50.783346 [debug] [Thread-2 (]: Began running node test.pipeline_guardian.not_null_stg_orders_amount.2546645448
[0m13:28:50.784338 [debug] [Thread-3 (]: Began running node test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64
[0m13:28:50.786929 [debug] [Thread-4 (]: Began running node test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a
[0m13:28:50.787970 [info ] [Thread-1 (]: 1 of 4 START test accepted_range_stg_orders_order_date___date_trunc_day_current_date_  [RUN]
[0m13:28:50.790919 [info ] [Thread-2 (]: 2 of 4 START test not_null_stg_orders_amount ................................... [RUN]
[0m13:28:50.792921 [info ] [Thread-3 (]: 3 of 4 START test not_null_stg_orders_order_id ................................. [RUN]
[0m13:28:50.794922 [info ] [Thread-4 (]: 4 of 4 START test unique_stg_orders_order_id ................................... [RUN]
[0m13:28:50.798475 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.pipeline_guardian.accepted_range_stg_orders_order_date___date_trunc_day_current_date_.2cf9901bb0'
[0m13:28:50.801482 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.pipeline_guardian.not_null_stg_orders_amount.2546645448'
[0m13:28:50.804478 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64'
[0m13:28:50.808074 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a'
[0m13:28:50.810588 [debug] [Thread-1 (]: Began compiling node test.pipeline_guardian.accepted_range_stg_orders_order_date___date_trunc_day_current_date_.2cf9901bb0
[0m13:28:50.812614 [debug] [Thread-2 (]: Began compiling node test.pipeline_guardian.not_null_stg_orders_amount.2546645448
[0m13:28:50.816125 [debug] [Thread-3 (]: Began compiling node test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64
[0m13:28:50.817184 [debug] [Thread-4 (]: Began compiling node test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a
[0m13:28:50.876538 [debug] [Thread-2 (]: Writing injected SQL for node "test.pipeline_guardian.not_null_stg_orders_amount.2546645448"
[0m13:28:50.888194 [debug] [Thread-3 (]: Writing injected SQL for node "test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:28:50.909654 [debug] [Thread-4 (]: Writing injected SQL for node "test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a"
[0m13:28:50.916395 [debug] [Thread-2 (]: Began executing node test.pipeline_guardian.not_null_stg_orders_amount.2546645448
[0m13:28:50.936656 [debug] [Thread-3 (]: Began executing node test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64
[0m13:28:50.967354 [debug] [Thread-4 (]: Began executing node test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a
[0m13:28:50.971410 [debug] [Thread-2 (]: Writing runtime sql for node "test.pipeline_guardian.not_null_stg_orders_amount.2546645448"
[0m13:28:50.979631 [debug] [Thread-3 (]: Writing runtime sql for node "test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:28:50.990220 [debug] [Thread-4 (]: Writing runtime sql for node "test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a"
[0m13:28:50.996167 [debug] [Thread-3 (]: Using duckdb connection "test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:28:50.998252 [debug] [Thread-2 (]: Using duckdb connection "test.pipeline_guardian.not_null_stg_orders_amount.2546645448"
[0m13:28:51.001258 [debug] [Thread-4 (]: Using duckdb connection "test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a"
[0m13:28:51.002247 [debug] [Thread-3 (]: On test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m13:28:51.004310 [debug] [Thread-2 (]: On test.pipeline_guardian.not_null_stg_orders_amount.2546645448: BEGIN
[0m13:28:51.007894 [debug] [Thread-4 (]: On test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m13:28:51.009910 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:28:51.011909 [debug] [Thread-1 (]: Compilation Error in test accepted_range_stg_orders_order_date___date_trunc_day_current_date_ (models\schema.yml)
  'current_date' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:28:51.013924 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:28:51.016427 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:28:51.019532 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m13:28:51.021506 [error] [Thread-1 (]: 1 of 4 ERROR accepted_range_stg_orders_order_date___date_trunc_day_current_date_  [[31mERROR[0m in 0.22s]
[0m13:28:51.024467 [debug] [Thread-2 (]: SQL status: OK in 0.011 seconds
[0m13:28:51.027045 [debug] [Thread-4 (]: SQL status: OK in 0.011 seconds
[0m13:28:51.029085 [debug] [Thread-3 (]: Using duckdb connection "test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:28:51.033047 [debug] [Thread-1 (]: Finished running node test.pipeline_guardian.accepted_range_stg_orders_order_date___date_trunc_day_current_date_.2cf9901bb0
[0m13:28:51.036615 [debug] [Thread-2 (]: Using duckdb connection "test.pipeline_guardian.not_null_stg_orders_amount.2546645448"
[0m13:28:51.038619 [debug] [Thread-4 (]: Using duckdb connection "test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a"
[0m13:28:51.040617 [debug] [Thread-3 (]: On test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "demo"."main"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m13:28:51.043617 [debug] [Thread-7 (]: Marking all children of 'test.pipeline_guardian.accepted_range_stg_orders_order_date___date_trunc_day_current_date_.2cf9901bb0' to be skipped because of status 'error'.  Reason: Compilation Error in test accepted_range_stg_orders_order_date___date_trunc_day_current_date_ (models\schema.yml)
  'current_date' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:28:51.046170 [debug] [Thread-2 (]: On test.pipeline_guardian.not_null_stg_orders_amount.2546645448: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "test.pipeline_guardian.not_null_stg_orders_amount.2546645448"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select amount
from "demo"."main"."stg_orders"
where amount is null



  
  
      
    ) dbt_internal_test
[0m13:28:51.048201 [debug] [Thread-4 (]: On test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "pipeline_guardian", "target_name": "dev", "node_id": "test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "demo"."main"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:28:51.054192 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m13:28:51.057772 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m13:28:51.072008 [debug] [Thread-3 (]: On test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m13:28:51.073051 [debug] [Thread-4 (]: SQL status: OK in 0.016 seconds
[0m13:28:51.077452 [debug] [Thread-2 (]: On test.pipeline_guardian.not_null_stg_orders_amount.2546645448: ROLLBACK
[0m13:28:51.080391 [debug] [Thread-3 (]: Failed to rollback 'test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64'
[0m13:28:51.084390 [debug] [Thread-4 (]: On test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m13:28:51.086976 [debug] [Thread-2 (]: Failed to rollback 'test.pipeline_guardian.not_null_stg_orders_amount.2546645448'
[0m13:28:51.088028 [debug] [Thread-3 (]: On test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m13:28:51.090979 [debug] [Thread-4 (]: Failed to rollback 'test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a'
[0m13:28:51.093027 [debug] [Thread-2 (]: On test.pipeline_guardian.not_null_stg_orders_amount.2546645448: Close
[0m13:28:51.095980 [info ] [Thread-3 (]: 3 of 4 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 0.29s]
[0m13:28:51.097557 [debug] [Thread-4 (]: On test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a: Close
[0m13:28:51.100512 [info ] [Thread-2 (]: 2 of 4 PASS not_null_stg_orders_amount ......................................... [[32mPASS[0m in 0.30s]
[0m13:28:51.102553 [debug] [Thread-3 (]: Finished running node test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64
[0m13:28:51.104513 [info ] [Thread-4 (]: 4 of 4 PASS unique_stg_orders_order_id ......................................... [[32mPASS[0m in 0.30s]
[0m13:28:51.107045 [debug] [Thread-2 (]: Finished running node test.pipeline_guardian.not_null_stg_orders_amount.2546645448
[0m13:28:51.111062 [debug] [Thread-4 (]: Finished running node test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a
[0m13:28:51.116062 [debug] [MainThread]: Using duckdb connection "master"
[0m13:28:51.117598 [debug] [MainThread]: On master: BEGIN
[0m13:28:51.118614 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:28:51.121633 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m13:28:51.123611 [debug] [MainThread]: On master: COMMIT
[0m13:28:51.124649 [debug] [MainThread]: Using duckdb connection "master"
[0m13:28:51.126231 [debug] [MainThread]: On master: COMMIT
[0m13:28:51.128256 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:28:51.130271 [debug] [MainThread]: On master: Close
[0m13:28:51.132274 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:28:51.134333 [debug] [MainThread]: Connection 'list_demo_main' was properly closed.
[0m13:28:51.135913 [debug] [MainThread]: Connection 'test.pipeline_guardian.accepted_range_stg_orders_order_date___date_trunc_day_current_date_.2cf9901bb0' was properly closed.
[0m13:28:51.137937 [debug] [MainThread]: Connection 'test.pipeline_guardian.not_null_stg_orders_amount.2546645448' was properly closed.
[0m13:28:51.138995 [debug] [MainThread]: Connection 'test.pipeline_guardian.not_null_stg_orders_order_id.81cfe2fe64' was properly closed.
[0m13:28:51.140991 [debug] [MainThread]: Connection 'test.pipeline_guardian.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m13:28:51.142935 [info ] [MainThread]: 
[0m13:28:51.145981 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m13:28:51.150586 [debug] [MainThread]: Command end result
[0m13:28:51.213913 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\manifest.json
[0m13:28:51.223157 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\semantic_manifest.json
[0m13:28:51.250642 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\likhi\Downloads\pipeline-guardian-v2-upload\dbt\target\run_results.json
[0m13:28:51.251648 [info ] [MainThread]: 
[0m13:28:51.255054 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:28:51.256696 [info ] [MainThread]: 
[0m13:28:51.259703 [error] [MainThread]: [31mFailure in test accepted_range_stg_orders_order_date___date_trunc_day_current_date_ (models\schema.yml)[0m
[0m13:28:51.261699 [error] [MainThread]:   Compilation Error in test accepted_range_stg_orders_order_date___date_trunc_day_current_date_ (models\schema.yml)
  'current_date' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:28:51.263751 [info ] [MainThread]: 
[0m13:28:51.266212 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m13:28:51.269852 [debug] [MainThread]: Command `dbt test` failed at 13:28:51.268846 after 4.75 seconds
[0m13:28:51.271381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AA171A0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AA2A35D20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AA55577C0>]}
[0m13:28:51.272401 [debug] [MainThread]: Flushing usage events
[0m13:28:51.728601 [debug] [MainThread]: An error was encountered while trying to flush usage events
